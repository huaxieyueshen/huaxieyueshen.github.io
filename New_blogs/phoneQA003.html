<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>如何开头的QA-超简略的-QA手机友好版003</title>
 </head>
 <body>
  <style>
  body{font-size:12px;}
  #bodytop{background-image:url(../images/t1.png);width:790px;height:50px;margin:auto;}
  #bodymiddle{background-image:url(../images/t2.png);width:790px;margin:auto;}
  #bodybottom{background-image:url(../images/t3.png);width:790px;height:48px;margin:auto;}
  #text{width:700px;;margin:auto;}
  .next{width:700px;;margin:auto;font-size:14px;}
  span{color:blue;font-size:14px;font-weight:bold;}
  </style>
   <div id="body">
<div id="bodytop"></div>
<div id="bodymiddle"><!--middle开始-->
<div id="text">
<span>1、如何打印pdf文件</span><br>
官网下载中心，下载最新的pdf测试版<br>
http://www.c-lodop.com/download.html<br>
安装后在欢迎页面末尾找“PDF打印”链接，或输入地址: <br>
http://localhost:8000/c_pdfprint<br><br>

<span>1、如何打印换行</span><br>
参考http://www.lodop.net/faq/pp12.html<br><br>

<span>1、如何打印表格</span><br>
超文本输出表格：ADD_PRINT_HTML、ADD_PRINT_HTM、ADD_PRINT_TABLE、ADD_PRINT_TBURL<br>
打印表格带页头页尾 参考样例15 http://www.c-lodop.com/demolist/PrintSample15.html<br>
分页打印综合表格 参考样例43 http://www.c-lodop.com/demolist/PrintSample43.html<br>
超文本表格传入css样式，参考样例10 http://www.c-lodop.com/demolist/PrintSample10.html<br>
纯文本+线输出表格：ADD_PRINT_TEXT、ADD_PRINT_LINE<br>
画线输出表格，参考http://www.c-lodop.com/demolist/PrintSampleA1.html<br><br>

<span>1、https网站如何使用</span><br>
参考http://www.lodop.net/faq/pp12.html<br><br>

<span>1、如何设置纸张</span><br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
纸张的一些优先级 http://www.c-lodop.com/blogs/Blog002.html<br><br>

<span>1、如何设选择打印机</span><br>
选择打印机，参考样例5,7http://www.c-lodop.com/LodopDemo.html<br>
打印机优先级，参考http://www.c-lodop.com/blogs/Blog002.html<br><br>

<span>1、如何判断打印成功</span><br>
参考样例35 http://www.c-lodop.com/demolist/PrintSample35.html<br>
样例45的13 http://www.c-lodop.com/demolist/PrintSample45.html<br>
样例35返回的“打印成功”实际仅是成功加入后台队列。<br>
样例45的13 判断“JOB不在队列”就足可认定已经打印成功。<br>
一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br><br>

<span>1、如何分页</span><br>
超文本超过设置的打印项高度就会自动分页，可通过调整超文本打印项的高度，控制当前页面输出的多少内容。（打印项高度可在打印设计界面可视化调整到合适的分页高度）<br>
如果是复杂表格等 建议用 add_print_htm, 切行时调整分页粒度，参考 样例30
http://www.c-lodop.com/demolist/PrintSample30.html<br>
强制分页 参考样例30 http://www.c-lodop.com/demolist/PrintSample30.html<br>
如果是纯文本，参考样例6http://www.lodop.net/demolist/PrintSample6.html，设置为多页文项。<br><br>

<span>1、如何使用lodop</span><br>
官网样例，样例页面右键查看源码，参考样例的使用方法http://www.c-lodop.com/LodopDemo.html<br>
Lodop最新版和技术手册可从如下地址（官网下载中心）下载：<br>
http://www.c-lodop.com/download.html<br><br>

<span>1、如何打印页码</span><br>
页码，参考样例6 http://www.c-lodop.com/demolist/PrintSample6.html<br>
样例43http://www.c-lodop.com/demolist/PrintSample43.html<br><br>

<span>1、如何居中打印</span><br>
1. 打印项居中 参考样例23 http://www.c-lodop.com/demolist/PrintSample23.html<br>
LODOP.SET_PRINT_STYLEA(0,"Horient",2);//打印项在纸张中水平居中<br>
LODOP.SET_PRINT_STYLEA(0,"Vorient",2);//打印项在纸张中垂直居中<br>
2. add_pirnt_text纯文本打印项里面的内容居中 <br>
纯文本设置Alignment设置水平居中LODOP.SET_PRINT_STYLEA(0,"Alignment",2);//文本框里 内容对于文本框居中，<br>
不支持垂直居中， 具体参考技术手册; <br>
3.AlignJustify设置纯文本两端对齐和条码文字对齐<br>
LODOP.SET_PRINT_STYLEA(0,"AlignJustify",1);//纯文本两端对齐<br>
LODOP.SET_PRINT_STYLEA(0,"AlignJustify",2);//设置条码下方的文字相对于条码本身居中<br>
4.Html 通过css 控制 参考样例2 ，10;http://www.c-lodop.com/demolist/PrintSample10.html<br><br>

<span>1、如何隐藏条码下方的数值 </span><br>
参考样例11 http://www.c-lodop.com/demolist/PrintSample11.html<br>
LODOP.SET_PRINT_STYLEA(0,"ShowBarText",0);//条码设置下方不显示数值<br><br>

<span>1、如何隐藏预览的打印按钮</span><br>
设置预览窗口 参考样例16 http://www.c-lodop.com/demolist/PrintSample16.html<br>
只隐藏预览里这个打印按钮，其他不隐藏，LODOP.SET_SHOW_MODE("HIDE_PBUTTIN_PREVIEW",true);//隐藏预览的打印按钮<br><br>

<span>1、如何设置次页偏移</span><br>
设置次页偏移 参考样例39 http://www.c-lodop.com/demolist/PrintSample39.html<br>
LODOP.SET_PRINT_STYLEA(0,"Offset2Top",-140);//设置次页向上偏移140<br><br>

<span>1、如何设计套打模版</span><br>
打印设计和定位套打 参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
手把手教你WEB套打程序开发 参考http://www.c-lodop.com/blogs/Blog008.html<br>
返回设计的JS代码 参考样例35 http://www.lodop.net.cn/demolist/PrintSample35.html<br>
文档式模版生成和使用 参考样例50 http://www.lodop.net.cn/demolist/PrintSample50.html<br><br>

<span>1、如何赋值</span><br>
1.按变量形式赋值，参考样例35；<br>
2.按顺序赋值 ，参考样例36<br>
LODOP.SET_PRINT_STYLEA(x,"Content",”赋值内容”);//第一个参数x-给第几个输出打印项赋值，<br>
Content-关键字，第三个参数：输出内容<br>
例如：赋值第1、2、3项内容赋值<br>
LODOP.SET_PRINT_STYLEA(1,"Content","学生证");<br>
LODOP.SET_PRINT_STYLEA(2,"Content","张三");<br>
LODOP.SET_PRINT_STYLEA(3,"Content","王五");<br>
3.按项目类名赋值,项目类型是aa：<br>
LODOP.SET_PRINT_STYLEA(‘aa’,"Content","学生证");//项目类名是aa的所有打印项内容被替换<br><br>

<span>1、如何同一个任务发送不同打印机</span><br>
同一个任务同时发送到不同的打印机打印，<br>
参考样例44，第3步<br>
例如：<br>
LODOP. SET_PRINT_MODE("NOCLEAR_AFTER_PRINT",true);//设置打印完毕不清理打印信息<br>
LODOP. SET_PRINTER_INDEXA("SG");//设置打印机SG<br>
LODOP.PRINT();//打印<br>
LODOP. SET_PRINTER_INDEXA("HY");//设置打印机HY<br>
LODOP.PRINT();//打印<br><br>

<span>1、如何导出excel</span><br>
导出excel，<br>
参考http://www.c-lodop.com/demolist/PrintSample27.html<br>
参考http://www.c-lodop.com/demolist/PrintSample12.html<br>
样例27的方法，如果导出不要样式，LODOP.SET_SAVE_MODE("QUICK_SAVE",true);//快速生成（无表格样式,数据量较大时或许用到） <br>
或用样例12的方式试试，<br><br>

<span>1、如何打印图片</span><br>
打印图片，参考http://www.lodop.net.cn/demolist/PrintSample8.html<br>
打印透明效果，打印公章 参考　http://www.lodop.net.cn/demolist/PrintSample37.html<br><br>

<span>1、如何打印css背景图</span><br>
css是背景图，http协议会按异步方式下载背景图，所以很容易等不到下载完毕就开始打印了，故lodop不打印背景图。至于普通图片参考样例37 http://www.c-lodop.com/demolist/PrintSample37.html<br>
用普通图片的输出方式。<br>
参考http://www.c-lodop.com/faq/pp14.html<br><br>

<span>1、如何在非Windows系统使用</span><br>
目前lodop和c-lodop只能安装到windows操作系统上，其他操作系统无法安装，无法用客户端本地打印角色，其他操作系统可以用集中打印，或广域网打印角色。<br>
三种角色及使用方法 参考http://www.c-lodop.com/demolist/t1.html<br><br>

<span>1、如何批量打印</span><br>
批量打印，分页分任务，在页数和任务之间平衡一下，参考样例26http://www.c-lodop.com/demolist/PrintSample26.html<br><br>

<span>1、如何通过url打印</span><br>
参考http://www.lodop.net/demolist/PrintSample14.html<br>
由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(Cookies)，所以需要安全验证的页面不要用URL方式打印，要用页面已经下载好的内容的HTM方式打印，也就是ADD_PRINT_HTM或ADD_PRINT_TABLE等语句<br>
另外URL方式需要二次访问服务器，理论上存在下载失败的可能，所以专业的管理系统尽量不要用URL方式。<br><br>

<span>1、如何排查和传入css样式</span><br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
加载css样式，参考样例10 http://www.c-lodop.com/demolist/PrintSample10.html<br><br>

<span>1、如何模拟打印</span><br>
win7之后的系统自带xps虚拟打印机，没有也可从网上等下载pdf虚拟打印机，群文件里的Doro PDF Writer虚拟打印机安装文件。<br>
用虚拟打印机测试下，另存文件模拟打印。<br><br>

<span>1、如何重启c-lodop</span><br>
双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启c-lodop后刷新页面。<br><br>

<span>1、如何打印不定高小票</span><br>
小票打印 ，参考样例18http://www.c-lodop.com/demolist/PrintSample18.html<br>
（小票针式打印 建议用 ADD_PRINT_TEXT文本，不用htm超文本，纸张高度不定容易引起 htm 中排版变形）<br><br>

<span>1、如何修改打印机可打区域</span><br>
“可打区域”边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br>
http://www.c-lodop.com/faq/pp26.html<br><br>

<span>1、如何测试该打印机是否支持自定义纸张</span><br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。
选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br><br>

<span>1、如何横向打印</span><br>
横向纵向 参考http://www.c-lodop.com/blogs/Blog010.html
设置打印方向，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html
横向打印，纵向预览，参考样例16的E http://www.c-lodop.com/demolist/PrintSample16.html<br><br>

<span>1、如何设统一二维码条码大小</span><br>
参考http://www.c-lodop.com/faq/pp10.html
二维码可以通过设置具体的QRCode版本，让不同数值的二维码统一大小。
条码随着数值不同，宽度可能不同，无法做到完全统一大小，可估计最大宽度，最后的实际宽度一般是小于等于设定宽度。<br><br>
</div>
</div><!--middle结束-->
<div id="bodybottom"></div>
</div>
<div class="next">
<table width="700">
<tr>
	<td width="350px">上一篇：<a href="./phoneQA001.html" target="_blank">虚拟打印机等手机友好QA</a></td>
	<td width="350px" align="right">下一篇：<a href="./phoneQA002.html" target="_blank">图片问题</a></td>
</tr>
</table>
</div>
 </body>
</html>
