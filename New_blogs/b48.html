<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WEB打印控件LODOP</title>
<script language="javascript" src="LodopFuncs.js"></script>
 <link href="../css/blogback.css" type='text/css' rel="stylesheet">     
</head>
<body id="bodyA1">
<div id="header">
<div id="head1"></div>
</div>
<div class="blogpost-body">
<h3>Lodop简答问答大全</h3>
    <p><strong>其他相关简短问答：</strong><br /><a href="https://www.cnblogs.com/huaxie/p/9854851.html" target="_blank">Lodop某个电脑打印内容大小有问题</a>，<a href="https://www.cnblogs.com/huaxie/p/10082571.html" target="_blank">LODOP超文本简短问答和相关内容</a>，<a href="https://www.cnblogs.com/huaxie/p/10132472.html" target="_blank">LODOP、C-Lodop简短排查语句</a>、<a href="https://www.cnblogs.com/huaxie/p/10155208.html" target="_blank">Lodop、c-lodop注册与角色简短问答</a>、<a href="https://www.cnblogs.com/huaxie/p/10265673.html" target="_blank">LODOP提示、报错、现象，简短问答</a>、<a href="https://www.cnblogs.com/huaxie/p/10688455.html" target="_blank">LODOP不同电脑打印效果不同排查</a>、<a href="https://www.cnblogs.com/huaxie/p/10860746.html" target="_blank">LODOP和C-LODOP注册与角色等简短问答【增强版】</a>、<a href="https://www.cnblogs.com/huaxie/p/9933528.html" target="_blank">Lodop简短问答客户反馈篇 及排查步骤 及注册相关</a>，<a href="https://www.cnblogs.com/huaxie/p/11248349.html" target="_blank">LODOP中无规律无法还原偶尔出现问题排查</a>、<a href="https://www.cnblogs.com/huaxie/p/11301778.html" target="_blank">LODOP纸张/打印机/份数/打印方向/双面打印 简短问答</a>、</p>
<p><strong>问答关键词链接：</strong><a href="https://www.cnblogs.com/huaxie/p/11957894.html" target="_blank">LODOP问答部分链接</a>、<a href="https://www.cnblogs.com/huaxie/p/11990330.html" target="_blank">常见问答的点击到链接1</a>、<a href="https://www.cnblogs.com/huaxie/p/12009701.html" target="_blank">LODOP常见问题连接(含常见小问答博文）</a>、</p>
<p><span style="color: #333399;"><strong>关键词点击到链接：</strong></span><a href="https://www.cnblogs.com/huaxie/p/12120081.html" target="_blank">LODOP具体的分类的简短问答</a>、<a href="https://www.cnblogs.com/huaxie/p/12162056.html" target="_blank">LODOP单个简短问答（小页面无需拖动滚动条)</a>、</p>
<p>其他：<br /><a href="https://www.cnblogs.com/huaxie/p/11349889.html" target="_blank">【各种误解解释】C-LODOP的三种角色及注册号</a>、<a href="https://www.cnblogs.com/huaxie/p/11350133.html" target="_blank">【各种误解解释】纸张打印机操作系统等误解相关</a>、<a href="https://www.cnblogs.com/huaxie/p/12073539.html" target="_blank">LODOP注册号无效原因排查步骤简短问答</a>、</p>
<p>其他2：<a href="https://www.cnblogs.com/huaxie/p/11381365.html" target="_blank">[简短问答]lodop打印过慢或有进度条</a>、<a href="https://www.cnblogs.com/huaxie/p/11364736.html" target="_blank">[简短问答]如何用虚拟打印机测试，虚拟打印机相关</a>、<a href="https://www.cnblogs.com/huaxie/p/11289317.html" target="_blank">非LODOP的打印其他问题-简短问答</a>、<a href="https://www.cnblogs.com/huaxie/p/11532205.html" target="_blank">[简短问答]LODOP套打问题及相关</a>、<a href="https://www.cnblogs.com/huaxie/p/11550450.html" target="_blank">[简短问答]LODOP打印不清晰</a>、<a href="https://www.cnblogs.com/huaxie/p/11550645.html" target="_blank">[简短问答]C-Lodop中一些测试用的地址</a>、<a href="https://www.cnblogs.com/huaxie/p/11683913.html" target="_blank">[简短问答]SET_PRINT_STYLEA相关简短问答</a>、</p>
<p>其他3：<a href="https://www.cnblogs.com/huaxie/p/11737021.html" target="_blank">LODOP注册语句相关简短问答</a>、<a href="https://www.cnblogs.com/huaxie/p/11045192.html" target="_blank">LODOP表格table简短问答及相关博文</a>、<a href="https://www.cnblogs.com/huaxie/p/11038280.html" target="_blank">LODOP条码简短问答及相关博文</a>、<a href="https://www.cnblogs.com/huaxie/p/11736705.html" target="_blank">c-lodop回调函数简短问答及相关博文</a>、<a href="https://www.cnblogs.com/huaxie/p/11988181.html" target="_blank">LODOP中打印项水平居中简短问答</a>、<a href="https://www.cnblogs.com/huaxie/p/12058752.html" target="_blank">打印维护和整体偏移相关简短问答</a>、<a href="https://www.cnblogs.com/huaxie/p/12073802.html" target="_blank">lodop打印透明图简短问答</a>、<a href="https://www.cnblogs.com/huaxie/p/12157195.html" target="_blank">LODOP导出Excel简短问答和相关博文</a>、</p>
<p>其他4（图片形式）：<a href="https://www.cnblogs.com/huaxie/p/11840328.html" target="_blank">[图片问答]lodop注册相关</a>、<a href="https://www.cnblogs.com/huaxie/p/11840694.html" target="_blank">[图片问答]LODOP字体设置方法</a>、<a href="https://www.cnblogs.com/huaxie/p/11890022.html" target="_blank">[图片问答]LODOP打印的行间距字间距</a>、</p>
<p>其他5：<a href="https://www.cnblogs.com/huaxie/p/10788836.html" target="_blank">本博客博文介绍和索引【花谢悦神】</a>、<a href="https://www.cnblogs.com/huaxie/p/12200120.html" target="_blank">本博客博文索引的分类汇总【花谢悦神】N</a>、</p>
<p><strong>一些浏览器不支持np插件</strong><br />参考http://www.c-lodop.com/faq/pp21.html<br />高版本的火狐谷歌不再支持np插件，需要使用c-lodop，可参考官网样例混合部署http://www.c-lodop.com/LodopDemo.html<br />Lodop控件升级到C-Lodop云打印 参考http://www.c-lodop.com/faq/pp7.html</p>
<p>测试参考一下官网样例http://www.c-lodop.com/LodopDemo.html<br />官网样例是混合部署LodopFuncs.js里已经写好了判断。<br />客户端是浏览器支持np插件，是32位浏览器，就会提示下载32位的Lodop插件：install_lodop32.exe<br />客户端浏览器支持np插件，是64位浏览器，就会提示下载64位的Lodop插件：install_lodop64.exe<br />客户端浏览器不支持np插件（判断如高版本谷歌火狐等），会提示下载C-Lodop方式： CLodop_Setup_for_Win32NT.exe</p>
<p>参考http://www.c-lodop.com/faq/pp21.html<br />高版本的火狐谷歌不再支持np插件方式，只能用c-lodop，c-lodop不支持内嵌。<br />可以在ie等支持np插件的浏览器下查看官网的需要内嵌的样例效果。 </p>
<p><strong>谷歌支持np插件的具体版本</strong><br />谷歌41及之前 可以直接安装使用<br />谷歌42--44版，历史lodop版本需要手动启用npapi或安装6.119版后自动启用npapi<br />谷歌45及以后版 不在支持npapi插件方式<br />火狐64位、谷歌45版及后续版本、edge浏览器都不再支持np插件模式，可采用云打印C-Lodop。</p>
<p>Chrome42-44版本，支持NP插件默认处于关闭状态，要手工打开，方法如下：<br />在谷歌浏览器地址栏输入：<br />chrome://flags/#enable-npapi<br />然后找到&ldquo;启用NPAPI&rdquo;地方看到处于启用状态; <br />chrome45之后版本及64位的chrome需要使用C-Lodop<br />参考http://www.c-lodop.com/faq/pp21.html<br />和http://www.c-lodop.com/faq/pp23.html<br /> 由于Chrome45之后不再支持任何NP插件，所以要使用C-Lodop，IE等浏览器可以使用lodop控件。</p>
<p>
<strong>打印机</strong><br />
选择打印机，参考样例5,7http://www.c-lodop.com/LodopDemo.html<br />打印机的一些优先级，参考http://www.c-lodop.com/blogs/Blog002.html</p>
<p>选择打印机，参考样例5,7http://www.c-lodop.com/LodopDemo.html<br />打印机优先级，参考http://blog.sina.com.cn/s/blog_721e77e50100wto6.html</p>
<p>获取打印机个数、打印机名称、指定打印机打印 参考样例7<br />http://www.c-lodop.com/demolist/PrintSample7.html<br />设置windows默认打印机 参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br />打印机份数 参考样例7 http://www.c-lodop.com/demolist/PrintSample7.html<br />打印机的一些优先级&nbsp;http://www.c-lodop.com/blogs/Blog002.html</p>
<p>选择打印机，参考样例5、7<br />http://www.c-lodop.com/demolist/PrintSample5.html<br />http://www.c-lodop.com/demolist/PrintSample7.html<br />打印机的一些优先级&nbsp;http://www.c-lodop.com/blogs/Blog002.html</p>
<p>测试一样例5,7，是否能获取到该打印机，获取的是安装到windows操作系统打印机列表的打印机。如果获取不到，重新安装驱动或重新共享试试。</p>
<p><strong>打印横向纵向</strong></p>
<p>横向纵向 参考http://www.c-lodop.com/blogs/Blog010.html<br />设置打印方向，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br />横向打印，纵向预览，参考样例16的E http://www.c-lodop.com/demolist/PrintSample16.html</p>
<p>横向纵向，参考http://blog.sina.com.cn/s/blog_721e77e5010143gh.html（官博出问题，移至官网）</p>
<p><strong>纸张</strong><br />纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br />纸张的一些优先级 http://blog.sina.com.cn/s/blog_721e77e50100wto6.html<br />用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持自定义纸张。<br />SET_PRINT_PAGESIZE 设置纸张 跟在初始化后，只要在输出打印任务前设置纸张就可以。</p>
<p>纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br />用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。<br />选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。</p>
<p>如果虚拟打印机正常，查看真实打印机的预览下方状态栏纸张大小，有的打印机可能不支持该自定义纸张。</p>
<p>1.纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br />用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持自定义纸张。<br />2.纸张的一些优先级 http://blog.sina.com.cn/s/blog_721e77e50100wto6.html<br />3.&ldquo;可打区域&rdquo;边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br />http://www.c-lodop.com/faq/pp26.html<br />设置以纸张边缘为基点参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br />4.测试参考样例7http://www.c-lodop.com/demolist/PrintSample7.html，查看该打印机支持的最大纸张长宽<br />的值。<br />5.小票打印 ，参考样例18 http://www.c-lodop.com/demolist/PrintSample18.html<br />（小票针式打印 建议用 ADD_PRINT_TEXT文本，不用htm超文本，纸张高度不定容易引起 htm 中排版变形）<br />6.纸张设置和预览微小差异，换算误差引起的。在打印机内部都是按英寸的，mm换算成in，然后in再换算回来就不一定是原来的mm，要以换算后的为准。</p>
<p><strong>提示&ldquo;纸张大小已由程序控制，无法改变&rdquo;</strong><br />参考样例7 http://www.c-lodop.com/demolist/PrintSample7.html，步骤7，可重选的打印预览。</p>
<p>使用SET_PRINT_MODE("RESELECT_XXX",true);语句可允许操作者在预览界面重选这些设置。<br />用如下语句，让这些信息可以在预览界面重新指定：<br />LODOP.SET_PRINT_MODE("RESELECT_PRINTER",true);   允许重选打印机<br />LODOP.SET_PRINT_MODE("RESELECT_ORIENT",true);    允许重选纸张方向<br />LODOP.SET_PRINT_MODE("RESELECT_PAGESIZE",true);  允许重选纸张<br />LODOP.SET_PRINT_MODE("RESELECT_COPIES",true);    允许重选份数</p>
<p><strong>小票打印</strong><br />小票打印 ，参考样例18http://www.c-lodop.com/demolist/PrintSample18.html<br />（小票针式打印 建议用 ADD_PRINT_TEXT文本，不用htm超文本，纸张高度不定容易引起 htm 中排版变形）</p>
<p><strong>分页</strong><br />分页 参考样例30 http://www.c-lodop.com/demolist/PrintSample30.html<br />超文本超过设置的打印项高度就会自动分页，可通过调整超文本打印项的高度，控制当前页面输出的多少内容。（打印项高度可在打印设计界面可视化调整）<br />超出纸张高度 会自动分页,单个表格输出 可以用add_print_table。<br />如果有合并行、嵌套表格等复合表格 建议用 add_print_htm, 切行时调整分页粒度，参考 样例30<br />http://www.c-lodop.com/demolist/PrintSample30.html</p>
<p>综合表格分页打印参考样例43 http://www.lodop.net/demolist/PrintSample43.html<br />多页效率提高（可分多个任务）参考样26 http://www.c-lodop.com/demolist/PrintSample26.html</p>
<p>超文本超高自动分页，如果表格有嵌套，合并行列等，建议用 add_print_htm, 切行时调整分页粒度，参考样例30<br />分页，参考样例30、样例43<br />http://www.c-lodop.com/demolist/PrintSample30.html<br />http://www.lodop.net/demolist/PrintSample43.html</p>
<p>超文本超过设置的打印项高度就会自动分页，可通过调整超文本打印项的高度，控制当前页面输出的多少内容。（打印项高度可在打印设计界面可视化调整）<br />减小打印项高度，不要紧贴纸张输出。<br />手动分页 参考样例30 http://www.c-lodop.com/demolist/PrintSample30.html<br />如果有合并行、嵌套表格等复合表格 可以用 add_print_htm, 切行时调整分页粒度TableRowThickNess，参考 样例30<br />http://www.c-lodop.com/demolist/PrintSample30.html</p>
<p><strong>c-lodop没启动</strong><br />c-lodop预览模式，参考http://www.c-lodop.com/faq/pp28.html<br />双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启c-lodop后刷新页面。<br />建议使用最新版c-lodop，最新版有后备进程 http://www.c-lodop.com/download.html<br />当主进程被杀死时，会自动又起来，可以在资源管理器进程管理里测试一下。</p>
<p>参考http://www.c-lodop.com/faq/pp5.html<br />排查开机启动项，用管理员权限安装最新版http://www.c-lodop.com/download.html，右键以管理员权限运行，再对比试试。<br />排查c-lodop是否能开机自启动，默认情况c-lodop是开机自动启动的，没自动开启可能问题：<br />1. 在系统msconfig启动选项列查看c-lodop是否是开启自启动；<br />2. 当前操作用户权限不足，无系统管理员权限；<br />3. 注意安全软件禁用c-lodop. 目前常用的360及金山已进行了安全认证，其他的杀毒软件请加入白名单，或直接上报提交对应的杀毒软件服务器。</p>
<p>如果是客户端本地打印角色，出现这种远程预览界面，参考：<br />c-lodop预览模式，参考http://www.c-lodop.com/faq/pp28.html<br />双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启后刷新页面。<br />建议使用最新版c-lodop， http://www.c-lodop.com/download.html</p>
<p>启动成功后，刷新下页面，查看下是否变成了本地预览界面。<br />测试下样例的预览界面http://www.c-lodop.com/demolist/PrintSample3.html</p>
<p><strong>已安装，提示未安装</strong><br />参考http://www.c-lodop.com/faq/pp2.html<br />双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启后刷新页面。<br />建议使用最新版c-lodop，最新版有后备进程 http://www.c-lodop.com/download.html</p>
<p>参考http://www.c-lodop.com/faq/pp2.html<br />参考http://www.c-lodop.com/faq/pp21.html<br />官网样例是混合部署，提示这个说明走的是Lodop插件方式，需要安装Lodop插件。<br />官网下载中心综合版里共三个安装文件，有c-lodop的，还有两个是lodop插件方式的安装文件。</p>
<p><strong>注册</strong><br />Lodop c-lodop是一款专业共享软件，公开版本未限制功能，多数用户可免费长期使用。仅如下情况需要注册收费(费用很少)：您希望用到(不经过弹出预览窗口的)&ldquo;直接打印&rdquo;功能时。不注册时该功能直接打印的纸张左下角会有&ldquo;本页由XXX试用版输出&rdquo;小字样水印。另外导出Excel文件或图片也需要注册。<br />控件注册号 注意事项 最新价格表、购买方式和使用方法见(官博)：<br />http://blog.sina.com.cn/s/blog_721e77e50100nfzs.html</p>
<p>参考http://www.c-lodop.com/demolist/t1.html<br />参考链接里的三种场景，是哪种角色。</p>
<p>IP和域名注册，根据浏览器地址栏访问方式注册，P访问，注册IP；域名访问，注册域名；不限IP域名，可做企业名称注册。<br />（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。<br />（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名： www.c-lodop.com 登陆方式如下：http://www.c-lodop.com/index.html等，ip地址访问时，注册信息无效<br />购买IP，更换服务器ip 需要重新购买ip注册信息。</p>
<p><strong>技术手册</strong><br />最新版和技术手册下载地址<br />Lodop最新版和技术手册可从如下地址（官网下载中心）下载：<br />http://www.c-lodop.com/download.html<br />http://www.mtsoftware.cn/download.html</p>
<p><strong>虚拟打印机</strong><br />百度下Microsoft XPS Document Writer虚拟打印机 win7后系统自带的 或者 群文件里的Doro PDF Writer虚拟打印机；<br />用虚拟打印机测试下，另存文件模拟打印。<br />     开发测试 先用本机虚拟打印机测试下<br />理论上本机虚拟打印没问题的话，说明插件代码没问题，程序可做的努力就的确很少了，毕竟windows下的打印是微软倡导的设备无关系原则，要在打印机和打印驱动程序 系统上排查下，尝试重装驱动 或者 打印机不支持一些功能  打印机精度太低。</p>
<p>win7之后的系统自带xps虚拟打印机，没有也可从网上等下载pdf虚拟打印机。<br />用xps或pdf虚拟打印机测试，打印效果是保存成相应的xps或pdf文件，可以看出打印效果。<br />如果虚拟打印机没有问题，可排除插件代码问题，理论上虚拟打印没问题的话，程序可做的努力就的确很少了，毕竟windows下的打印是微软倡导的设备无关系原则，要在打印机和打印驱动程序上找原因，可尝试重装驱动，或咨询一下打印机服务商。</p>
<p>win7之后的系统自带xps虚拟打印机，没有也可从网上等下载pdf虚拟打印机，群文件里的Doro PDF Writer虚拟打印机安装文件。<br />用虚拟打印机测试下，另存文件模拟打印。<br />用xps或pdf虚拟打印机测试，打印效果是保存成相应的xps或pdf文件，可以看出打印效果。</p>
<p><strong>html样式</strong></p>
<p>查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />分析差异点，因浏览器版本不同遵循的html标准不同，造成某些标签属性显示有差异，尽量避免使用有差异的属性，可以在ie下不同版本仿真情况下验证差异<br />排查样式，尽量使用使用各浏览器无歧义的通用的 html css js，不支持的样式可尝试用其他样式代替。</p>
<p>是否没有加载完全，给该超文本打印项加延迟试试：<br />LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒</p>
<p>1.加载css样式，参考样例10 http://www.c-lodop.com/demolist/PrintSample10.html<br />2.css样式等尽量使用pt等绝对单位，不使用px等相对单位，避免分辨率的影响<br />3.系统和浏览器不要设置缩放，例如 控制板面-显示里设置缩放。<br />4.查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />因浏览器版本不同遵循的html标准不同，造成某些标签属性显示有差异，尽量避免使用有差异的属性。<br />5.使用各浏览器无歧义的通用的 html  css  js，<br />Lodop是基于本机ie引擎进行解析渲染的，不要用本机ie不支持的html  css  js ，重置ie浏览器试试。<br />6.可尝试把ADD_PRINT_HTM 换成 ADD_PRINT_HTML（图形模式）试试。<br />7.用xps或pdf虚拟打印机测试一下，和真实打印机对比。<br />8.尽量使用最新版Lodop和c-lodop。最新版下载地址 http://www.c-lodop.com/download.html<br />9.是否是浏览器缓存问题，重置ie浏览器试试，清楚缓存。<br />10.页面，图片，js等超文本是否没有加载完全，显示空白或者图片缺失等问题，加延迟试试：<br />LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒</p>
<p><strong>不同电脑显示大小不同</strong><br />可能原因分析：本地设置放大比例问题，是真实的放大或缩小，<br />1.查看比例应在100%，<br />2.控制面板设置显示应在100%（win7 win10中）<br /> 3.超文本样式问题，分析样式中不同浏览器版本下显示不一致的标签属性，避开，换其他方式实现<br />4.打印机纸张问题：纸张大小是否一致；可打印区域是否影响到了输出内容的大小；</p>
<p>只有一台机器是这样，其他机器正常，应该和这台机器有关。<br />建议先排查上面对话里的那几条。<br />1.ie浏览器缩放2.系统缩放3.超文本样式不同，不同浏览器版本下显示不一致的标签属性<br />3.打印机纸张是否一致，可打区域不同影响的输出大小。</p>
<p><strong>资源访问受限，需要验证后才能访问的资源</strong><br />由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(Cookies)，所以需要安全验证的页面不要用URL方式打印，要用页面已经下载好的内容的HTM方式打印，也就是ADD_PRINT_HTM或ADD_PRINT_TABLE等语句<br />另外URL方式需要二次访问服务器，理论上存在下载失败的可能，所以专业的管理系统尽量不要用URL方式。</p>
<p><strong>出现进度条，打印过慢</strong><br />远程共享打印机  打印机驱动有问题 内容过多需要下载有脚步执行或本身网络慢 <br />机器性能过低  系统ie有问题或缓存过多<br />可能会出现这种问题 。跟机器 网络 内容都相关。<br />尽量减少单个任务数据量 参考样例26 ，重置下ie， 用本机虚拟打印机测试对比<br />预览页数多可以多分一些任务，太多不建议预览，建议直接打印，在任务和页数之间平衡一下，参考样例26 http://www.c-lodop.com/demolist/PrintSample26.html</p>
<p>批量打印，分页分任务，在页数和任务之间平衡一下，参考样例26http://www.c-lodop.com/demolist/PrintSample26.html</p>
<p>1.重置浏览器，清理浏览器缓存。<br />2.清理操作系统缓存等，关闭一些不常用的软件，保证系统内存充足。<br />3.是否是打印内容或样式等过多引起的（表现为打印预览弹出很慢，或有进度条，进度条卡住等，如果是数据过多引起，建议拆分一下数据分多任务）：<br />批量打印，分多任务，在页数和任务数量之间平衡一下，页数太多建议多分一些任务，<br />参考http://www.c-lodop.com/demolist/PrintSample26.html<br />4.测试官网样例http://www.c-lodop.com/LodopDemo.html，是否有提示。<br />5.测试参考样例7http://www.c-lodop.com/demolist/PrintSample7.html，选择xps或pdf虚拟打印机试试，换个打印机试试。<br />6.删除网络共享打印机试试，可能是导致这个原因。<br />（网络共享打印机还可能导致c-lodop安装界面始终打不开，可尝试删除网络共享打印机）<br />7.c-lodop启动界面未响应问题，可等待响应，或关闭程序，然后双击桌面上的c-lodop快捷方式重启本地的c-lodop。</p>
<p>批量打印，分页分任务，在页数和任务之间平衡一下，参考样例26http://www.c-lodop.com/demolist/PrintSample26.html<br />用虚拟打印机测试为一下，查看队列的任务，是打印机停顿 还是任务发送到队列的停顿。<br />是否是大量打印超文本造成的，Lodop大量打印超文本，调用ie引擎解析，ie缓存过多不释放，可能造成一些影响，如果大量打印，可以试试用纯文本方式。</p>
<p>图片批量打印，src 方式输出，需要通过浏览器引擎解析，存在不释放缓存的现象，可尝试base64码输出，参考样例38http://www.c-lodop.com/demolist/PrintSample38.html<br />base64位码输出直接通过本地lodop程序解析，无需经过浏览器引擎解析</p>
<p>如果是批量打印相同内容，可设置份数参考样例7http://www.c-lodop.com/demolist/PrintSample7.html<br />如果是批量打不同的，批量打印，分页分任务，参考样例26 http://www.c-lodop.com/demolist/PrintSample26.html</p>
<p><strong>打印设计</strong><br />打印设计，参考http://www.c-lodop.com/demolist/PrintSample4.html<br />LODOP.PRINT_DESIGN();<br />WEB套打程序开发 参考http://blog.sina.com.cn/s/blog_721e77e50100ng1o.html</p>
<p><strong>（非windows)其他操作系统打印</strong><br />目前lodop和c-lodop只能安装到windows操作系统上，其他操作系统无法安装。<br />非windows操作系统不能打印到本机，其他操作系统，可以通过访问其他电脑的windows上的c-lodop，实现打印到其他电脑的打印机，获取的打印机是打印端电脑连接的打印机。<br />集中打印，参考http://blog.sina.com.cn/s/blog_721e77e50102w7ds.html<br />广域网AO端桥打印 ，参考http://blog.sina.com.cn/s/blog_721e77e50102xbci.htm<br />广域网AO打印机打印 ，参考 http://blog.sina.com.cn/s/blog_721e77e50102xh8m.html</p>
<p>目前lodop和c-lodop只能安装到windows操作系统上，其他操作系统无法安装。<br />非windows操作系统不能打印到本机，其他操作系统，可以通过访问其他电脑的windows上的c-lodop，实现打印到其他电脑的打印机，获取的打印机是打印端电脑连接的打印机。<br />集中打印:<br />Web打印控件Lodop最新(2016)版发布(带云打印C-Lodop)：<br />http://blog.sina.com.cn/s/blog_721e77e50102w7ds.html<br />C-Lodop应用介绍1：实现到店微信点餐:<br />http://blog.sina.com.cn/s/blog_721e77e50102x0b3.html<br />广域网AO打印:<br />图文详解AO打印（端桥模式）<br />http://blog.sina.com.cn/s/blog_721e77e50102xbci.htm<br />图文详解AO打印（标准模式）<br />http://blog.sina.com.cn/s/blog_721e77e50102xh8m.html</p>
<p>目前lodop和c-lodop只能安装到windows操作系统上，其他操作系统无法安装，无法用客户端本地打印角色，其他操作系统可以用集中打印，或广域网打印角色。<br />三种角色及使用方法 参考http://www.c-lodop.com/demolist/t1.html</p>
<p><strong>缩放</strong><br />如果是超文本样式缩放导致样式出问题，参考<br />查看lodop内部解析的html信息，见http://www.c-lodop.com/lodop/faq/p1.html</p>
<p>缩放单个超文本 参考样例44 http://www.c-lodop.com/demolist/PrintSample44.html<br />整页缩放，溢出缩放，参考样例42 http://www.c-lodop.com/demolist/PrintSample42.html<br />图片缩放，参考样例8 http://www.c-lodop.com/demolist/PrintSample8.html</p>
<p><strong>打印输出空白页</strong><br />（1）可能有不可视内容 导致打印内容高度超过打印项高度 打印设计里调整下打印项高度。<br />进入打印设计LODOP.PRINT_DESIGN();，分析一下 超文本是否输出了空白信息 或加入超文本背景色看一下。<br />空白页，正好超出设置高度一点也会自动分页，从这里入手分析。<br />（2）打印项上边距加高度超过纸张高度 如ADD_PRINT_HTML(10, 15, "100%", "100%");<br />  百分比是相对纸张的 上边距10 + 高度100% 超出纸张的高度<br />（3）没初始化，容易造成多页的现象。<br />（4）设置一下内容的高度，不要紧贴纸张大小输出，有时会接近纸张的无限边界时 有打印空白页 的现象或改用newpage<br />（5） 打印机可打印区域问题 http://www.c-lodop.com/faq/pp26.html 。参考样例5，可设置以纸张边缘为基点输出，排除打印机可打印区域的影响。<br />如果是漏单等，下载使用最新版试试，新版本相对于旧版本更新较多。<br /> <br />多打印一张空白页，打印HTML内容，带上!DOCTYPE htm标签 声明试试。<br />尽量使用最新版。<br />1.给传入的整个超文本添加背景色，看输出的空白页中是否有背景色，有说明不可见内容。<br />2.可在打印设计界面，选中超文本打印项，右键查看里面实际的内容，是否有不可见的内容。</p>
<p>建议先用xps或pdf虚拟打印机测试一下。<br />如果虚拟打印没有空白页，可能是纸张或可打区域的问题。<br />可用真实打印机预览:<br />1.查看预览下方状态栏纸张是否是设置的纸张，有的打印机不支持该自定义纸张。<br />2.查看预览里是否有虚线，虚线是打印机可打区域，超过可打区域到了下一页。<br />如果虚拟打印机有空白页，可能是有不可见内容等导致的。</p>
<p><strong>内容修改，还是旧的内容</strong><br />是否是有打印维护的本地缓存文件，恢复整体缺省，置空任务名，或者删除本地的ini文件。<br />参考http://www.c-lodop.com/faq/pp9.html<br />排查浏览器缓存，重置浏览器试试，清楚缓存。</p>
<p><strong>Lodop中字体设置</strong><br />字体设置方法：<br />一、整体设置（针对文本项），打印初始化后、增加打印项之前调用本函数<br />  LODOP.SET_PRINT_STYLE("FontSize",11);<br />二、单个打印项（针对文本项）进行字体设置，例如：<br />  LODOP.SET_PRINT_STYLEA(3,"FontName","隶书");<br />  设置第3个内容项的字体为隶书。<br />  LODOP.SET_PRINT_STYLEA(3,"FontSize",15);<br />  设置第3个内容项字体为15号字体<br />单独设置某个打印项的字体，可以参考样例3。<br />一、二、是对所有内容字体的设置，只对文本项起作用，超文本不起作用。css样式参见样例10.<br />另外：超文本方式输出字体时，此时最好用pt这个单位设置字体大小，不要用px，否则会受打印分辨率影响。px是相对计量单位，显示屏幕上12点和打印机上的12点可能不一样大。但都用9pt就差不多大了，9pt在打印机上或许是11px或12px。套打最好不要用htm语句，要用add_print_text语句。不设置就会被浏览器引擎设置为默认字体，默认字体大小是9号字体。</p>
<p><strong>Lodop不打印css背景图</strong><br />background:url()这是背景图，http协议会按异步方式下载背景图，所以很容易等不到下载完毕就开始打印了，故lodop不打印背景图。至于普通图片参考样例37 http://www.c-lodop.com/demolist/PrintSample37.html<br />用普通图片的输出方式。</p>
<p>css背景图，参考http://www.c-lodop.com/faq/pp14.html<br />通常情况下打印图片都支持，因超文本背景图片是异步资源，所以默认是不打印的。<br />实现超文本包含背景图片效果可以有3种解决方法：<br />1.把ADD_PRINT_HTM 改为 ADD_PRINT_HTML ,图形模式输出；<br />2.使用透明图片效果实现，参考样例37；<br />3.用lodop函数语句输出背景图，参考样例9。<br />Lodop背景图ADD_PRINT_SETUP_BKIMG，参考http://www.c-lodop.com/demolist/PrintSample9.html</p>
<p><strong>打印不清晰</strong><br />如果是超文本，把htm中的单位 修改为 pt，不要使用相对单位px，避免分辨率的影响<br />ADD_PRINT_HTML 换成 ADD_PRINT_HTM，<br />ADD_PRINT_HTML是图形模式，有些打印机对图形支持不好。<br />小票针式打印 建议用 ADD_PRINT_TEXT,不用用htm,<br />纸张高度不定容易引起 htm 中排版变形<br />用虚拟打印机验证一下，如果没有问题，就是打印机的问题了，是否打印机缺墨了。</p>
<p><strong>打印偏移</strong><br />打印内容偏移的可能情况：<br />1. 初始化函数init 或inita中 前两个参数不为零时初始位置有偏移，设置为0。<br />2.本地模板的影响，设置初始化函数init 或inita 中模板名称为空""，目的测试排除缓存本地模板影响。消除本地配置缓存的影响，参http://www.c-lodop.com/faq/pp9.html<br />3.打印机不在初始位置，或打印机初始位置有偏移，需要单独针对这台打印机在打印维护中调整打印任务的初始位置，然后点【应用】缓存为本地模板，只对这台机器起作用，不影响其他人，或直接调整打印机的初始位置。<br />4.连续打印输出多张，偏移累计越来越大，设置输出的纸张与实际纸张大小有差异，如果确实无法做到与纸张实物一样大，输出一定任务数量有偏差时后需要手动调整进纸位置。</p>
<p><strong>Lodop超文本不能横向分页</strong><br />超文本超过打印项高度会自动分页，横向不能自动分页，可以缩放适应宽度。<br />可以拆分表格，重组数据，手动分页，参考样例３０　http://www.lodop.net.cn/demolist/PrintSample30.html</p>
<p><strong>打印图片</strong><br />打印图片，参考http://www.lodop.net.cn/demolist/PrintSample8.html<br />打印透明效果，打印公章 参考　http://www.lodop.net.cn/demolist/PrintSample37.html<br />和虚拟打印机对比测试，有的打印机不支持透明图打印。</p>
<p>显示空白或者图片缺失等问题，加延迟试试：<br />LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒</p>
<p>参考样例37 http://www.c-lodop.com/demolist/PrintSample37.html<br />如果页面上可以显示，试试把add_print_htm换成add_print_html试试。<br />如果打印预览等显示是透明图是可以的，尝试上述方式后打印机打出来还是不透明，可能是打印机不支持透明图打印，咨询一下打印机客服。</p>
<p>如何输出清晰图片 参考http://www.c-lodop.com/faq/pp14.html<br />并用xps或pdf虚拟打印机测试</p>
<p><strong>图片显示叉号问题</strong><br />（1）查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />查看一下传入的图片路径是否正确，尽量用绝对路径地址，换个图片试试。<br />（2）显示空白或者图片缺失等问题，加延迟试试：<br />LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒<br />（3）权限问题，图片显示叉号 说明服务端拒绝了 可能证书 session等问题，导致没有直接访问该图片的权限，有些需要验证之后才能访问图片。由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(cookies)<br />（4）清空ie缓存 重置ie 后在ie中查看下。IE中的URL最大长度限制为2048字节。超过这个长度会不支持。<br />（5） 查看服务器端错误日志排查下 。<br />（6）做个简单的例子验证下，排除其他因素的干扰。Base64输出图片参考样例38。</p>
<p><strong>样例27导出excel提示要先安装</strong><br />确认系统 print spooler 打印服务是开启的<br />由于lodop采用&ldquo;Excel.Application&rdquo;来导出excel，所以要求系统必须安装excel相关软件且非绿色安装那种。<br />大量复杂的导出建议采用样例12的办法。样例12导出不需要excel支持。打开是转换需要excel支持.</p>
<p>导出excel，<br />参考http://www.c-lodop.com/demolist/PrintSample27.html<br />参考http://www.c-lodop.com/demolist/PrintSample12.html<br />样例27的方法，如果导出不要样式，LODOP.SET_SAVE_MODE("QUICK_SAVE",true);//快速生成（无表格样式,数据量较大时或许用到） <br />用样例12的方式试试，<br />表格数据太大，一次导出如果慢，拆分后多次导出试试。</p>
<p><strong>同一个任务发送到不同的打印机</strong><br />同一个任务同时发送到不同的打印机打印，<br />参考样例44，第3步<br />例如：<br />LODOP. SET_PRINT_MODE("NOCLEAR_AFTER_PRINT",true);//设置打印完毕不清理打印信息<br />LODOP. SET_PRINTER_INDEXA("SG");//设置打印机SG<br />LODOP.PRINT();//打印<br />LODOP. SET_PRINTER_INDEXA("HY");//设置打印机HY<br />LODOP.PRINT();//打印</p>
<p><strong>表格次页偏移</strong><br />参考样例39 http://www.c-lodop.com/demolist/PrintSample39.html<br />LODOP.SET_PRINT_STYLEA(0,"Offset2Top",-140);//设置次页向上偏移140<br />次页表格top值偏移，设置。<br />负值是向上偏移，正值是向下偏移。<br />参考技术手册：&ldquo;Offset2Top&rdquo;：次页开始的上边距偏移量，&ldquo;Offset2Left&rdquo;：次页开始的左边距偏移量</p>
<p><strong>提示&lsquo;请在操作系统安装打印机（并开启打印服务）&rsquo;</strong><br />查看一下打印服务是否开启：<br />（1）在 控制版面-管理工具-服务里面，找到Print Spooler并开启。<br />（2）用win+R快捷键打开运行窗口，输入service.msc打开服务列表，找到Print Spooler并开启。<br />如果是开启的，再排查是否安装了打印机。</p>
<p><strong>打印虚线</strong><br />可以，添加css参考样例10  http://www.c-lodop.com/demolist/PrintSample10.html<br />也可以使用ADD_PRINT_LINE输出虚线，参考技术手册或打印设计界面，注意虚线线宽是0。</p>
<p><strong>打印表格</strong><br />超文本输出表格：ADD_PRINT_HTML、ADD_PRINT_HTM、ADD_PRINT_TABLE、ADD_PRINT_TBURL<br />打印表格带页头页尾 参考样例15 http://www.c-lodop.com/demolist/PrintSample15.html<br />分页打印综合表格 参考样例43 http://www.c-lodop.com/demolist/PrintSample43.html<br />超文本表格传入css样式，参考样例10 http://www.c-lodop.com/demolist/PrintSample10.html<br />纯文本+线输出表格：ADD_PRINT_TEXT、ADD_PRINT_LINE<br />画线输出表格，参考http://www.c-lodop.com/demolist/PrintSampleA1.html</p>
<p><strong>打印表格每页带表头</strong><br />参考样例15 http://www.c-lodop.com/demolist/PrintSample15.html<br />样例43 http://www.c-lodop.com/demolist/PrintSample43.html</p>
<p><strong>打印成功</strong><br />参考样例35 http://www.c-lodop.com/demolist/PrintSample35.html<br />样例45的13 http://www.c-lodop.com/demolist/PrintSample45.html<br />样例35返回的&ldquo;打印成功&rdquo;实际仅是成功加入后台队列。<br />样例45的13 判断&ldquo;JOB不在队列&rdquo;就足可认定已经打印成功。<br />一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。</p>
<p>参考样例45http://www.c-lodop.com/demolist/PrintSample45.html<br />获取打印状态，需要实际测试下，不同打印机状态码可能不同。</p>
<p><strong>赋值方法</strong><br />1.按变量形式赋值，参考样例35；<br />2.按顺序赋值 ，参考样例36<br />LODOP.SET_PRINT_STYLEA(x,"Content",&rdquo;赋值内容&rdquo;);//第一个参数x-给第几个输出打印项赋值，<br />Content-关键字，第三个参数：输出内容<br />例如：赋值第1、2、3项内容赋值<br />LODOP.SET_PRINT_STYLEA(1,"Content","学生证");<br />LODOP.SET_PRINT_STYLEA(2,"Content","张三");<br />LODOP.SET_PRINT_STYLEA(3,"Content","王五");<br />3.按项目类名赋值,项目类型是aa：<br />LODOP.SET_PRINT_STYLEA(&lsquo;aa&rsquo;,"Content","学生证");//项目类名是aa的所有打印项内容被替换</p>
<p><strong>返回值不对</strong><br />c-lodop需要回调函数，参考c-lodop技术手册<br />和一些含有回调函数的官网样例的源码，例如样例35http://www.c-lodop.com/demolist/PrintSample35.html<br />样例4，样例28等等。</p>
<p>c-lodop需要回调函数On_Return，参考样例源码和c-lodop技术手册http://www.c-lodop.com/download.html</p>
<p><strong>条码输出，条码大小控制、类型</strong><br />条码输出 参考样例11 http://www.c-lodop.com/demolist/PrintSample11.html<br />超文本表格中的条码参考样例47 http://www.c-lodop.com/demolist/PrintSample47.html<br />LODOP对象嵌套在一段要输出的超文本中,表格中的条码参考样例47http://www.c-lodop.com/demolist/PrintSample47.html<br />二维码及条码大小控制  通过输出的整体宽度调整粗细<br />参考http://www.c-lodop.com/faq/pp10.html<br />一维条码能包含的字符内容及长度限制 参考http://www.c-lodop.com/faq/pp18.html<br />影响条码识别率的可能原因 http://www.c-lodop.com/faq/pp6.html</p>
<p>参考http://www.c-lodop.com/faq/pp10.html<br />随着条码或二维码的增大或缩小是受每个竖条或横条的宽度合计值影响，通过调整宽度达到想要的效果。<br />数值不同，想要完全符合统一的宽度，可用图片，但是图片缩放容易变形，建议用Lodop语句输出，估计条码最大宽度大小。</p>
<p>一维条码能包含的字符内容及长度限制<br />http://www.c-lodop.com/faq/pp18.html<br />条码类型描述<br />128A: 标准数字和字母, 控制符, 特殊字符<br />128B: 标准数字和字母, 小写字母, 特殊字符<br />128C: [00]-[99]的数字对集合, 共100个(只能包含数字，一个条码字符代表两位数字）<br />128AUTO:会自动在几个代码集中切换。<br />128C 只能打数字，可以打到超窄 ，有客户可以打到12毫米</p>
<p>LODOP.ADD_PRINT_BARCODE(88,32,206,78,"128B","123456789012");//设置条码位置、宽高、字体、值<br />LODOP.SET_PRINT_STYLEA(0,"FontSize",18);//设置上面这个条码下方的文字字体大小<br />LODOP.SET_PRINT_STYLEA(0,"Color","#FF0000");//设置当前条码以及条码下方字体的颜色<br />LODOP.SET_PRINT_STYLEA(0,"Angle",180);//设置旋转角度<br />LODOP.SET_PRINT_STYLEA(0,"ShowBarText",0);//设置是否显示下方的文字<br />LODOP.SET_PRINT_STYLEA(0,"AlignJustify",2);//设置条码下方的文字相对于条码本身居中<br />LODOP.SET_PRINT_STYLEA(0,"AlignJustify",1);//设置条码下方的文字相对于条码本身居左<br />LODOP.SET_PRINT_STYLEA(0,"AlignJustify",3);//设置条码下方的文字相对于条码本身居右<br />LODOP.SET_PRINT_STYLEA(0,"GroundColor","#0080FF");//设置条码的背景色</p>
<p><strong>条码二维码宽度</strong><br />二维码及条码大小控制 通过输出的整体宽度调整粗细<br />参考http://www.c-lodop.com/faq/pp10.html<br />随着条码或二维码的增大或缩小是受每个竖条或横条的宽度合计值影响，通过调整宽度达到想要的效果。条码设置多宽不一定是多宽，可以在打印设计里调整到合适大小，然后在打印设计里生成代码。<br />条码设置多宽不一定是多宽，可以在打印设计里调整到合适大小，然后在打印设计里生成代码。</p>
<p>参考http://www.c-lodop.com/faq/pp10.html<br />条码设置多宽不一定是多宽，可以在打印设计里调整到合适大小，然后在打印设计里生成代码。</p>
<p>二维码及条码大小控制<br />参考http://www.c-lodop.com/faq/pp10.html<br />宽度跳跃式放大或缩小，是非线性，受合计值的影响</p>
<p><strong>条码下方文字字体</strong><br />也可以 LODOP.SET_PRINT_STYLEA(0,"ShowBarText",0);<br />可以设置下方不显示数字，然后用add_print_text文本单独输出数字，放在条形码下方。</p>
<p><strong>套打，模版</strong><br />打印设计和定位套打 参考http://www.c-lodop.com/demolist/PrintSample4.html<br />手把手教你WEB套打程序开发 参考http://blog.sina.com.cn/s/blog_721e77e50100ng1o.html<br />返回设计的代码 参考样例35 http://www.lodop.net.cn/demolist/PrintSample35.html<br />文档式模版生成和使用 参考样例50 http://www.lodop.net.cn/demolist/PrintSample50.html</p>
<p>打印设计和定位套打 参考http://www.c-lodop.com/demolist/PrintSample4.html<br />手把手教你WEB套打程序开发 参考http://www.c-lodop.com/blogs/Blog008.html<br />返回设计的JS代码 参考样例35 http://www.lodop.net.cn/demolist/PrintSample35.html<br />文档式模版生成和使用 参考样例50 http://www.lodop.net.cn/demolist/PrintSample50.html</p>
<p><strong>常用官网常见问答链接</strong><br />1.Lodop与C-Lodop的区别 参考http://www.c-lodop.com/faq/pp21.html<br />高版本的火狐谷歌不再支持np插件，需要使用c-lodop。<br />2.Lodop控件升级到C-Lodop云打印 参考http://www.c-lodop.com/faq/pp7.html<br />3.Lodop页面总提示"未安装"或"请升级"的可能原因 参考http://www.c-lodop.com/faq/pp2.html<br />测试官网样例http://www.c-lodop.com/LodopDemo.html，查看是否有提示，提示是什么。<br />4.Lodop如何实现换行，参考http://www.c-lodop.com/faq/pp12.html<br />add_print_text文本项超过设置的宽度，高度足够，会自动换行。高度不够会隐藏后面的内容。<br />5.如何输出清晰图片 参考http://www.c-lodop.com/faq/pp14.html<br />6.打印位置不同，偏移量问题 参考http://www.c-lodop.com/faq/pp17.html<br />设置输出的纸张与实际纸张大小是否一致。<br />7.如何实现内容或整页旋转 参考http://www.c-lodop.com/faq/pp25.html<br />8.https扩展版C-Lodop如何使用http://www.c-lodop.com/faq/pp32.html</p>
<p><strong>针对某个打印项</strong><br />0.参考技术手册http://www.c-lodop.com/download.html SET_PRINT_STYLEA篇，第一个参数，0代表紧跟着的上一个打印项，直接加在该打印项语句后面。<br />1.设置次页偏移 参考样例39 http://www.c-lodop.com/demolist/PrintSample39.html<br />LODOP.SET_PRINT_STYLEA(0,"Offset2Top",-140);//设置次页向上偏移140<br />2.可在打印设计界面，选中打印项-右键-设置属性，中设置文本字间距，预览可看到效果。<br />也可直接在代码里设置，例如 LODOP.SET_PRINT_STYLEA(0,"LetterSpacing",4);//设置当前文本的字间距为4.<br />3.设置文本框里的内容相对于文本框居中 LODOP.SET_PRINT_STYLEA(0,"Alignment",2);//文本框里 内容对于文本框居中<br />4.设置打印项在纸张中居中 <br />LODOP.SET_PRINT_STYLEA(0,"Horient",2);//打印项在纸张中水平居中<br />LODOP.SET_PRINT_STYLEA(0,"Vorient",2);//打印项在纸张中垂直居中。<br />5.设置预览窗口 参考样例16 http://www.c-lodop.com/demolist/PrintSample16.html<br />只隐藏预览里这个打印按钮，其他不隐藏，LODOP.SET_SHOW_MODE("HIDE_PBUTTIN_PREVIEW",true);//隐藏预览的打印按钮<br />6.参考样例11 http://www.c-lodop.com/demolist/PrintSample11.html<br />LODOP.SET_PRINT_STYLEA(0,"ShowBarText",0);//条码设置下方不显示数字<br />7.显示空白或者图片缺失等问题，加延迟试试：<br />LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒</p>
<p><strong>针对某个任务</strong><br />1.设置缩放，整页缩放，溢出缩放，参考样例42 http://www.c-lodop.com/demolist/PrintSample42.html<br />SET_PRINT_MODE("FULL_WIDTH_FOR_OVERFLOW",true); //宽度溢出缩放<br />SET_PRINT_MODE("FULL_HEIGHT_FOR_OVERFLOW",true);//高度溢出缩放<br />3.设置预览或打印包含背景图 参考样例9 http://www.c-lodop.com/demolist/PrintSample9.html<br />LODOP.SET_SHOW_MODE("BKIMG_IN_PREVIEW",1);//预览包含背景图<br />LODOP.SET_SHOW_MODE("BKIMG_PRINT",1);//打印包含背景图</p>
<p>Lodop输出页码，参考样例6http://www.c-lodop.com/demolist/PrintSample6.html<br />样例43http://www.c-lodop.com/demolist/PrintSample43.html<br />样例31http://www.c-lodop.com/demolist/PrintSample31.html</p>
<p><strong>超文本显示不全</strong><br />1.是否没有加载完全，给该超文本打印项加延迟试试：<br />LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒<br />2.超文本内容超过纸张高度，会自动分页，查看预览下方状态栏是否是多页。<br />3.打印预览的虚线是可打区域，参考http://www.lodop.net/faq/pp26.html<br />这个是打印机的可打区域。该区域外打印不出来。<br />打印设计，参考http://www.lodop.net/demolist/PrintSample3.html<br />进入打印设计，可以可视化调整一下，减小打印项高度，超过高度部分会被分到下一页。</p>
<p><strong>居中打印</strong><br />1. 打印项居中 参考样例23 http://www.c-lodop.com/demolist/PrintSample23.html<br />LODOP.SET_PRINT_STYLEA(0,"Horient",2);//打印项在纸张中水平居中<br />LODOP.SET_PRINT_STYLEA(0,"Vorient",2);//打印项在纸张中垂直居中<br />2. add_pirnt_text纯文本打印项里面的内容居中 <br />纯文本设置Alignment设置水平居中LODOP.SET_PRINT_STYLEA(0,"Alignment",2);//文本框里 内容对于文本框居中，<br />不支持垂直居中， 具体参考技术手册; <br />3.AlignJustify设置纯文本两端对齐和条码文字对齐<br />LODOP.SET_PRINT_STYLEA(0,"AlignJustify",1);//纯文本两端对齐<br />LODOP.SET_PRINT_STYLEA(0,"AlignJustify",2);//设置条码下方的文字相对于条码本身居中<br />4.Html 通过css 控制 参考样例2 ，10;http://www.c-lodop.com/demolist/PrintSample10.html</p>
<p><strong>导出的图片包含背景图</strong><br />导出的图片是打印的内容，如果是Lodop语句输出的背景图<br />设置预览或打印包含背景图 参考样例9 http://www.c-lodop.com/demolist/PrintSample9.html<br />LODOP.SET_SHOW_MODE("BKIMG_IN_PREVIEW",1);//预览包含背景图<br />LODOP.SET_SHOW_MODE("BKIMG_PRINT",1);//打印包含背景图</p>
<p>打印包含超文本对象背景图片 参考http://www.c-lodop.com/faq/pp14.html</p>
<p><strong>背景图</strong><br />LODOP背景图 参考样例9 http://www.c-lodop.com/demolist/PrintSample9.html<br />普通图片作为超文本底图 参考样例37 http://www.c-lodop.com/demolist/PrintSample37.html<br />先输出的打印项先输出，输出的打印项在上层，调整打印项的顺序，图片先输出，再输出文本等内容。</p>
<p><strong>清除lodop缓存样式</strong><br />1.不同任务之间不会互相影响，每个任务都要加初始化语句PRINT_INIT或PRINT_INITA；<br />2.如果是输出超文本是旧的内容，可清理一下浏览器缓存，刷新页面。<br />3.加载css样式，参考样例10 http://www.c-lodop.com/demolist/PrintSample10.html<br />如果有些样式不需要，可以在传入的时候去掉<br />4.如果是指针打印维护对客户端调整，该客户端调整后的样式，参考http://www.c-lodop.com/faq/pp9.html</p>
<p><strong>Lodop打开钱箱</strong><br />打开钱箱问题 参考http://www.c-lodop.com/faq/pp11.html<br />可以发送打印机指令，或直接写入端口。<br />常见的钱箱是与票据打印机一起使用的，一般票据打印机是连接在COM口或LPT口上的，然后通过软件向COM或LPT口发送信号，这样就可以打开钱箱了。<br />一般钱箱是连接着打印机后面接口的，小票不打印，钱箱不弹出。</p>
<p><strong>提示升级</strong><br />参考http://www.c-lodop.com/faq/pp2.html<br />查看LodopFuncs.js里的判断，和实际安装的版本。<br />实际安装的小于LodopFuncs.js判断的版本号会提示升级。<br />查看安装的版本号 参考http://www.c-lodop.com/faq/pp15.html</p>
<p>下载最新版安装后刷新页面http://www.c-lodop.com/download.html<br />或修改LodopFuncs.js里提示升级的判断版本号，把版本号降低。</p>
<p>测试一下官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br />官网样例是否有什么提示。提示内容是什么。</p>
<p><strong>端口占用</strong><br />双击桌面上的c-lodop快捷方式，重启本机的c-lodop，重启后端口会自动加一。<br />使用最新版http://www.c-lodop.com/download.html<br />最新版是双端口，8000和18000只要一个能用就行。</p>
<p><strong>C-Lodop漏打</strong><br />没有日志可查，用最新版对比试试http://www.c-lodop.com/download.html<br />参考样例4，样例35，判断直接打印的返回值，判断该任务是否加入队列。</p>
<p>用最新版对比试试http://www.c-lodop.com/download.html<br />最新版解决一些旧版本的漏打原因。</p>
<p><strong>个别电脑不同</strong><br />1.如果是超文本，本机调用的ie引擎版本不同，超文本的一些样式可能有差异，排查样式。<br />查看lodop内部解析的html信息，见http://www.c-lodop.com/lodop/faq/p1.html<br />分析差异点，因浏览器版本不同遵循的html标准不同，造成某些标签属性显示有差异，尽量避免使用有差异的属性，可以在ie下不同版本仿真情况下验证差异<br />2.css样式等尽量使用pt等绝对单位，不使用px等相对单位，避免分辨率的影响<br />3.系统和浏览器不要设置缩放，例如 控制板面-显示里设置缩放。<br />4.排查是否有打印维护的本地配置的影响，该打印维护的缓存的配置文件只针对该客户端有效，参考http://www.c-lodop.com/faq/pp9.html<br />5.打印机纸张问题：纸张大小是否一致，在预览下方状态栏查看是否是设置的纸张，有的打印机不支持自定义纸张。<br />6.可打印区域是否影响到了输出内容的大小，参考http://www.c-lodop.com/faq/pp26.html<br />7.用xps或pdf虚拟打印机测试一下，如果虚拟打印机没有问题，可排除插件代码问题，理论上虚拟打印没问题的话，程序可做的努力就的确很少了，毕竟windows下的打印是微软倡导的设备无关系原则，要在打印机和打印驱动程序上找原因，可尝试重装驱动，或咨询一下打印机服务商。</p>
<p>如果虚拟打印机正常，可能和打印机有关，预览查看是否和打印机可打区域有关，参考&ldquo;可打区域&rdquo;边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br />http://www.c-lodop.com/faq/pp26.html<br />如果虚拟打印机也不正常，可能和超文本解析有关，查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />分析差异点，因浏览器版本不同遵循的html标准不同，造成某些标签属性显示有差异，尽量避免使用有差异的属性，可以在ie下不同版本仿真情况下验证差异</p>
<p><strong>LinkedItem关联</strong><br />参考样例41 http://www.c-lodop.com/demolist/PrintSample41.html<br />关联后，一个内容关联别人后，其Top值不再是上边距，而是与被关联者的间隙距离,Left值也变为左边距相对偏离量。<br />样例43，眉脚关联主体表格，眉脚会紧跟着表格。</p>
<div>
<p><strong>真实打印机打出上方有空白，虚拟打印机无空白</strong><br />用xps或pdf虚拟打印机测试一下。<br />如果虚拟打印机输出的文件上方没有空白，实际打印真实打印机打印出来有空白，实体打印机是否在初始位置输出，或打印机初始走纸位置不正确，联系打印机厂商确认一下</p>
<div>
<p><strong>字体偶尔乱码，字体识别</strong><br />用xps或pdf虚拟打印机测试下<br />如果虚拟打印机也有问题，修改为其他字体试试，查看下页面的编码是否正确。<br />如果虚拟打印机没问题，可能和打印机或打印机驱动有关，偶尔出现也可能和打印机有关。<br />打印机识别字体问题 参考http://www.c-lodop.com/faq/pp20.html</p>
<p><strong>页码&nbsp;&nbsp;</strong><a href="https://www.cnblogs.com/huaxie/p/9700435.html" target="_blank">Lodop打印控件输出页码（超文本和纯文本页码）</a><br />页码，参考样例6 http://www.c-lodop.com/demolist/PrintSample6.html<br />样例43http://www.c-lodop.com/demolist/PrintSample43.html</p>
<p>页码，纯文本页码 参考样例6 http://www.c-lodop.com/demolist/PrintSample6.html<br />超文本页码 参考样例43http://www.c-lodop.com/demolist/PrintSample43.html</p>
<p><strong>新的参考（官网）：原官博，有官方新浪博客出现问题，移至官网。</strong><br />Lodop中的一些优先级定义 参考http://www.c-lodop.com/blogs/Blog002.html</p>

<p>&nbsp;</p>
<p>cnblog链接（带图示）:<a href="https://www.cnblogs.com/huaxie/p/9790615.html" target="_blank">Lodop简答问答大全</a></p>
<p><a href="../blog_index.html">返回博文列表</a></p>
</div>
<div id="footer"><img src="../images/lodopfoot.png"></div>
</body>
</html>