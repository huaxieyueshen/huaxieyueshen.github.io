<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WEB打印控件LODOP</title>
<script language="javascript" src="LodopFuncs.js"></script>
 <link href="../css/blogback.css" type='text/css' rel="stylesheet">     
</head>
<body id="bodyA1">
<div id="header">
<div id="head1"></div>
</div>
<div class="blogpost-body">
<h3>Lodop简短问答客户反馈篇 及排查步骤 及注册相关</h3>
    <p><strong>A.http下打印图片正常，https下打印图片是&times;&times;。（有的客户端可以，有的不可以）</strong><br />重置ie浏览器试试。<br />客户反馈：（和ie浏览器的设置有关）<br />intenet选项--高级里，我调整为和能打印出图片的电脑一样的配置，就可以打印了，但是不知道具体是哪项影响的</p>
<p><strong>B.使用的是斑马打印机，中文汉字无法打印，excel可以打印出汉字。（客户反馈）</strong><br />针对斑马打印机如果需要用我们控件打印汉字，需要设置字体，不然没有办法打印汉字。<br /> <br />有客户反应，斑马打印机如果要用控件打印汉字，需要设置字体，不然没法打印汉字。<br />可尝试设置一下字体，试试能否打印出汉字。</p>
<p><strong>C.winxp系统，使用https版c-lodop，如果不在火狐里添加例外，其他浏览器也无法正常使用。（客户反馈）</strong><br />在火狐浏览器里添加例外试试，有客户反应在火狐里添加例外，其他浏览器才可以使用。<br /> <br />目前只有火狐浏览器有这个问题，火狐不认Localhost证书，其他浏览器应该没有问题。<br />但有客户反应，需要在火狐里添加例外，其他浏览器才能正常使用，因此在火狐里添加例外试试。</p>
<p><strong>&nbsp;D.连续打印多任务，打印机不连续，多页可以连续</strong></p>
<p>1.打印机需要打到连续打印模式，之前没有接触过针式打印机，下午调试时用的一直都是单页模式；<br />2.换了一种实现方式，采用了 LODOP.NEWPAGEA(); 没在继续在样例五的连续打印 方法上继续坚持。(客户反馈)</p>
<p><strong>E.有些用户图片显示叉号，地址正确</strong><br />解决问题了，重装一个新的IE（IE11），然后第一次启动IE11 会有一个安全性的确认框，确定一下就好了（客户反馈）</p>
<p><strong>F.用虚拟打印机测试，虚拟打印机怎么也不弹出保存框</strong><br />虚拟打印机不弹出的问题解决了，是360安全卫士把spool drivers里的核心dll文件阻止了(客户反馈）</p>
<p><strong>G.不管怎么样，总是提示窗口已打开</strong><br />查询默认打印机是否有效或出错，指定其他打印机试试。<br />找到原因了，默认打印机出错了。（客户反馈）</p>
<p><strong>H.打印机打出来的文字是反的</strong><br />用xps或pdf虚拟打印机测试下。<br />虚拟打印机正常，可能和打印机设置有关，排查相关打印机设置，是否勾选了打印机的镜像打印。(客户反馈）<br />客户反馈：无意勾选到了打印机镜像打印</p>
<p><span style="background-color: #ccffcc;">其他各种状况：</span><br /><strong>a.用云打印插件（插件安装在本机）会出现打印好几十兆的文件，这是要设置那个参数吗？</strong><br />如果你的打印没有包含大量图片，或较多文档，即打印内容没有包含大量图片或较多文档，即打印内容本身的数据不是很大。这时候，打印管理程序显示较大的文件，往往与打印机的驱动有关，更换一台打印机对比一下。</p>
<p><strong>b.预览有问题，但是打印出来的东西没事，怎么会回事？</strong><br />预览是打印的反显，所见即所得，打印机驱动有问题，重装一下打印驱动。</p>
<p><strong>c.提示&ldquo;cannot creat file&rsquo;c\program\files\mounttaisoftware\lodop&hellip;&hellip;.lodop.ocx&rsquo;拒绝访问&rdquo;。</strong><br />操作系统可能有事情ie死进程，注销一下当前windows用户，或重启计算机。</p>
<p><strong>d.直接打印的时候，用的那个LODOP.ADD_PRINT_URL这个，因为系统里面做了用户登录情况的验证，有的浏览器有时候直接打印的时候就会报用户没有登录，这里控件有什么方法控制吗，还是说要自己去做兼容？</strong><br />由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(Cookies)，所以需要安全验证的页面不要用URL方式打印，要用页面已经下载好的内容的HTM方式打印，也就是ADD_PRINT_HTM或ADD_PRINT_TABLE等语句<br />另外URL方式需要二次访问服务器，理论上存在下载失败的可能，所以专业的管理系统尽量不要用URL方式。</p>
<p><strong>e.在一台打印显示表格线，另外一台不显示，何解？</strong><br />打印精度不同，可能线比较细，虚拟打印机测试一下试试。</p>
<p><strong>f.客户端操作系统语言外文，注册号无效。</strong><br />客户端操作系统的语言选择了外文，表现为预览界面按钮变成英文，而注册号是简体中文的，所以注册号无效。<br />解决办法是加语句：LODOP.SET_SHOW_MODE(&ldquo;LANGUAC..,0);关于该语句参考样例19</p>
<p><strong>g.C-Lodop服务安装启动成功，无法加载CLodopfuncs.js，无法访问http://localhost:8000，怎么办？</strong><br />localhost无法访问导致<br />（1）先确认localhost是指向127.0.0.1的<br />（2）然后Ping 127.0.0.1，如果无法Ping通，则表名本地TCP/IP协议不能正常工作。此时重新安装一下网卡的驱动应该就OK了（只要你的网卡没坏）</p>
<p>localhost无法访问导致<br />localhost是个域名类似www.baidu.com，不是ip地址，它可以被配置为任意IP地址<br />　　通常情况host文件都指向127.0.0,1(ipv4)和[::1](ipv6)<br />    在windows中，这个域名是预定义的，从hosts文件中可以看出;<br />    #localhost name resolution is handled within DNS itself.<br />    #     127.0.0.1  localhost<br />    注意这个值是可修改的，比如我把它改成<br />   192.068.206.1  localhost<br />   然后再去ping localhost,提示就变成了<br />   PING locahost(193.068.206.1)56(84) bytes of data.</p>
<p>   所以先确认localhost是指向127.0.0.1的<br />   <br />然后Ping 127.0.0.1，如果无法Ping通，则表名本地TCP/IP协议不能正常工作。<br />  此时重新安装一下网卡的驱动应该就OK了（只要你的网卡没坏）</p>
<p><strong>h.lodop在预览或者打印的时候，系统内存会随之增加，该如何处理？</strong><br />内存增长属于正常的 打印缓存消耗，消耗的多少与打印机也有关系，有的打印机解析的任务小，有的打印</p>
<p>机解析的打印任务大。<br />减少消耗的方法： 减少单个任务的输出数据量，如果是打印页数量大，</p>
<p>可以参考样例 26 http://www.c-lodop.com/demolist/PrintSample26.html，多任务输出的处理。<br />正常情况下 ，打印结束后自动释放缓存。</p>
<p><strong>i.集中打印手机访问不到云主机的页面，或有时候访问不到。</strong><br />以前c-lodop还没有AO打印功能的时候，一个客户使用集中打印方式，使用都是对的，但是手机就是不能访问，即使是云主机的c-lodop欢迎页面也无法访问，另一个客户说关闭防火墙试试，然后发现可以，如果排查使用方式没有问题，可关闭防火墙试试。</p>
<p>有客户云主机用的是https的8443，c-lodop的https证书是本地的，只能适用于客户端本地打印角色，非客户端本地打印角色，需要需要添加https证书。在c-lodop启动界面的设置的扩展功能里设置，添加上自己https网站的证书。<br />（旧版本没有扩展功能的，就没有这个功能，非常旧的c-lodop https版，没有这个扩展功能，集中打印只能用http，具体可通过c-lodop启动界面的设置里查看）</p>
<p><strong>j.用Lodop的url打印卡在了&ldquo;正在打开页面下载数据（限时5分钟）...(1)&rdquo;</strong><br />URL方式需要二次访问服务器，理论上存在下载失败的可能，所以专业的管理系统尽量不要用URL方式。<br />最好是直接传入html信息，用传入的html打印试试。<br />测试下官网样例2http://www.c-lodop.com/demolist/PrintSample2.html<br />样例14http://www.c-lodop.com/demolist/PrintSample14.html<br />在ie里访问下这些url试试，lodop借助ie引擎进行下载解析超文本。</p>
<p>现象：测试样例2可以正常，测试样例14还是卡在进度条...限时5分钟那里。</p>
<p>客户反馈：IE提示脱机工作，IE脱机工作了，导致了这种现象。</p>
<p><strong>cs.客户反馈的cs架构使用</strong><br />CS程序如何使用Lodop<br />CS调用Lodop======以下是一些客户反馈的使用方法===========================<br />delphi:<br />myLodop:=TLodopX.Create(Self);<br />myLodop.Parent:=myPanel;<br />myLodop.Height:=myPanel.Height;<br />myLodop.Width:=myPanel.Width;<br />myLodop.PRINT_INIT('');<br />myLODOP.ADD_PRINT_TEXT(10,10,100,20,'新加文本1');<br />myLODOP.ADD_PRINT_RECT(66,116,100,60,0,1);<br />myLodop.SET_SHOW_MODE('DESIGN_IN_BROWSE','1');<br />myLodop.print_design;<br />=================================<br />VB:<br />Private Sub Command1_Click()<br />With LodopX1<br />.PRINT_INIT ""<br />.ADD_PRINT_TEXT 10, 10, 20, 20, "aaaa"<br />.PREVIEW<br />End With<br />End Sub<br />=================================<br />C#:<br />首先添加引用文件：CAOSOFT_WEB_PRINT_lodop.ocx</p>
<p>Lodop.LodopXClass MyLodop = new Lodop.LodopXClass();</p>
<p>MyLodop.ADD_PRINT_TEXT(10,10,100,20,"新加文本1"); <br />MyLodop.PREVIEW();<br />=================================<br />C++:<br />首先添加引用文件：CAOSOFT_WEB_PRINT_lodop.ocx <br />int a = 5;<br />_variant_t var;<br />var = (_variant_t)(int)a;<br />VARIANT v = var;<br />CString str = _T("xxx");<br />_variant_t varText = (LPCTSTR)str;<br />VARIANT dispText = varText;<br />lodop.ADD_PRINT_TEXT(v,v,v,v,dispText);<br />lodop.PREVIEW();<br />=======================<br />VC:<br />_variant_t bstrVar("abcdef");</p>
<p>C# ：引用CAOSOFT_WEB_PRINT_lodop.ocx<br />在C:\Program Files (x86)\MountTaiSoftware\Lodop<br />引用后会有ILodopX接口、ILodopXEvents接口，LodopX接口，LodopXClass类。<br />Lodop.LodopX PRLodop = new LodopX();<br />PRLodop.ADD_PRINT_TEXT(10, 10, 100, 20, "一个文本项");<br />PRLodop.SET_PRINT_STYLEA(0, "FontSize", 13.5);<br />PRLodop.SET_PRINT_STYLEA(0, "Bold", 1);<br />PRLodop.PREVIEW();<br />}</p>
<p>一些朋友反馈的java调用方法，您参考摸索一下<br />/**<br /> * Java调用lodop直接打印<br /> * 需要引入jacob-1.17.jar包。<br /> *<br /> * @author TonyTan<br /> * @version 1.0, 2017-3-9<br /> */<br />public class JavaLodop {</p>
<p>	public static void main(String[] args) {<br />		ActiveXComponent LODOP = new ActiveXComponent("Lodop.LodopX") ;<br />		Dispatch lodop = LODOP.getObject();<br />		Dispatch.call(lodop, "PRINT_INIT", "打印控件功能演示_Lodop功能_表单一");<br />		Dispatch.call(lodop, "ADD_PRINT_TEXT", 50,231,260,39,"打印页面部分内容");<br />		Dispatch.call(lodop, "PRINT");<br />		System.out.println("...................lodop="+lodop);<br />	}</p>
<p>}</p>
<p><span style="background-color: #ccffcc;">不断更新和补充中</span><br /><span style="color: #993300;">遇到问题，可先用xps或pdf虚拟打印机测试，排查是打印机原因还是代码原因。</span></p>
<p><strong> 1.区别是程序的问题，还是打印机的问题。</strong><br />&mdash;&mdash;虚拟打印机正确，说明代码没问题，应该是打印机问题。<br />用xps或pdf虚拟打印机测试一下，如果虚拟打印机输出正确，重装打印机驱动试试，驱动被破坏或不完整也<br />可能导致打印异常。<br />只要虚拟打印机没问题 就说明插件代码是正确的。用虚拟打印测试没问题 可排除插件代码问题 排查下打印机重置打印机驱动试下。理论上虚拟打印没问题的话，程序可做的努力就的确很少了，毕竟windows下的打印是微软倡导的设备无关系原则。<br />一般win7以上系统，应该会自带xps虚拟打印机，在打印机列表里可以看到Microsoft XPS Document Writer。如果没有可以在网上下载安装一个pdf虚拟打印机。<br />通过打开保存后的文件，可以查看打印效果。</p>
<p><strong>2.区别是否是自己使用方法错误，例如没有正确引用Lodop,没有写对相应实现功能的语句等。</strong><br />如果样例正常，自己的程序不正常，可能是自己使用错误，<br />在该功能的样例页面－右键　查看源码，查看一下样例是如何使用这些功能的。</p>
<p><strong>3.重新安装最新Lodop或c-lodop，用最新版对比，重启c-lodop。</strong><br />重装Lodop，去官网重新下载安装。（安装文件被损坏，程序被破坏等问题）<br />版本太低，Lodop在不断更新和完善中，会修复之前的一些问题，用最新版对比。</p>
<p><strong>4.换浏览器测试，换台机器测试。</strong><br />浏览器异常，或操作系统异常，电脑故障等。<br />Lodop解析超文本用的是Ie引擎，可重置ie，用安全软件修复ie试试，例如进度条闪烁等原因，可能是ie异常导致。<br />清理浏览器垃圾，电脑垃圾，用杀毒软件修复系统，杀毒。</p>
<p><strong><span style="background-color: #ccffcc;">打印机问题</span>：（打印机故障，打印机驱动损坏，打印机色带不正常，打印机不在初始位置等）</strong><br />特点是：用真实打印机预览正常，虚拟打印机正常。<br /><strong>（1）.真实打印机预览正常，虚拟打印机正常，就是真实打印机打印出来不正常。</strong><br />比较奇怪，一般预览是打印机的反显，如果虚拟打印机正常，真实打印机预览正常，打印不正常，可能打印机有关。<br />换个打印机试试，排查是否有什么打印机的设置或打印机故障。<br /><strong>（2）虚拟打印机无空白，预览无空白，真实打印机打出上方有空白。</strong><br />用xps或pdf虚拟打印机测试一下。<br />如果预览无空白，如果虚拟打印机输出的文件上方没有空白，实际打印真实打印机打印出来有空白，实体打印机是否在初始位置输出，或打印机初始走纸位置不正确，联系打印机厂商确认一下。<br /><strong>（3）虚拟打印正常，预览正常，真实打印不清晰</strong><br />用虚拟打印机验证一下，如果没有问题，就是打印机的问题了，是否打印机缺墨了<br />如何输出清晰图片 参考http://www.c-lodop.com/faq/pp14.html<br />并用xps或pdf虚拟打印机测试<br />如果虚拟打印机清晰正常，可能和打印机有关，打印机精度等，排查打印机设置或打印机故障。<br /><strong>（4）打印任务进入队列，打印机不打印</strong><br />任务进入队列后交个打印机打印了，排查打印机是否脱机，打印机是否连接正常，或打印机故障，咨询一下打印机售后相关人员。</p>
<p><strong>（5）真实打印机预览正常，打印不正常。</strong><br />通常预览是打印机的反显，如果真实打印机预览正常，打印也应该正常，如果实际打印有问题，应该是打印机驱动的问题。<br />某些标准的功能引起了打印机驱动的故障，而word没有用到这些功能。<br />删减下语句排查下是哪些LODOP功能引起的。</p>
<p><img src="https://img2018.cnblogs.com/blog/1481828/201811/1481828-20181109100646488-529496730.jpg" alt="" /></p>
<p><strong>注册</strong><br />Lodop c-lodop是一款专业共享软件，公开版本未限制功能，多数用户可免费长期使用。仅如下情况需要注册收费(费用很少)：您希望用到(不经过弹出预览窗口的)&ldquo;直接打印&rdquo;功能时。不注册时该功能直接打印的纸张左下角会有&ldquo;本页由XXX试用版输出&rdquo;小字样水印。另外导出Excel文件或图片也需要注册。<br />控件注册号 注意事项 最新价格表、购买方式和使用方法见(官博)：<br />http://www.c-lodop.com/Lodop_Lic.html</p>
<p>参考http://www.c-lodop.com/demolist/t1.html<br />参考链接里的三种场景，是哪种角色。</p>
<p>IP和域名注册，根据浏览器地址栏访问方式注册，更换需重新注册。<br />根据客户端访问时用的是IP还是域名，注册相应的注册号。<br />如果项目较多，多个网站等，可以注册公司名称注册，不限IP和域名，公司名称注册在打印预览下方状态栏会显示授权单位的名称。<br />（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下：http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。<br />（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名： www.c-lodop.com 登陆方式如下：http://www.c-lodop.com/index.html等，ip地址访问时，注册信息无效<br />购买IP，更换服务器ip 需要重新购买ip注册信息。</p>
<p>需要看客户端访问方式，根据的是客户端浏览器地址栏里访问的方式。<br />IP访问，注册IP；域名访问，注册域名；不限IP域名，可做企业名称注册。<br />服务器IP，客户端访问服务器的时候的方式，如果是IP访问，就可以买限IP。<br />如果是域名访问，则绑定服务器IP地址无效，就需要绑定域名。</p>
<p>域名和ip可以同时生效，最多同时支持3个，域名和ip地址加在一起不超过3个就可以，同时购买域名或ip的，可以下多个定单，也可以一个订单，联系在线的淘宝客服合并。</p>
<p>参考http://www.c-lodop.com/demolist/t1.html<br />参考链接里的三种场景，是哪种角色。<br />如果是客户端本地打印角色，客户端访问网站后在自己电脑连接的打印机上进行打印，不需要购买c-lodop注册号。lodop注册号对c-lodop客户端本地打印角色默认有效。</p>
<p><strong>注册号不需要连网验证：</strong><br />如果是IP或域名注册，Lodop注册号针对的是浏览器地址栏的是否和注册的匹配，不需要进行联网云端之类的验证。<br />即使是C-Lodop的第二种角色也不需要，虽然称为云打印，实际是用户自己组建的云打印，用户可用一台自己的windows服务器作为服务端，然后其他客户端都发送打印任务到这台电脑，通过这台电脑连接的打印机打印。<br />所以局域网等也是可以的。<br />C-Lodop注册号是针对单台机器的，也就是那台机器的硬盘序列号，也不需要联网。</p>
<p>注册号永久有效，时间不限，如果不是无限注册，功能保证当时注册的功能有效，后续版本都支持，该注册号对后续版本都有效。</p>
<p>Lodop注册号的最新价格表、购买方式和使用方法见(官博)：<br />http://www.c-lodop.com/Lodop_Lic.html<br />关于购买梦泰尔软件授权的注意事项<br />http://www.c-lodop.com/Lodop_note.html</p>
<p>购买可以加入vip群，发送注册码的邮箱里 或者官网 有vip群号。在免费或vip群里提供技术支持。<br />预览后打印是免费的，预览后打印无水印，可以先预览打印测试一下功能，确定测试好了，能实现自己需要的功能了，再购买。<br />功能等 参考官网样例或技术手册 http://www.c-lodop.com/LodopDemo.html<br />http://www.c-lodop.com/download.html</p>
<p><strong>公司名称注册必须显示公司名</strong><br />使用该注册号的打印预览窗口状态栏会显示注册者的公司名称，由于lodop用户一般都用于商务产品或WEB工程，所以显示别人公司名称比水印还难以容忍，再加上价格比较便宜，一般不会盗用别人的注册号。而对于不注重这些的用户，免费功能就足已。当然lodop官方也有对付盗版的其它办法。<br />不限IP或域名的，必须显示公司名称，显示公司名称是授权给该公司的标志，是防止其他公司盗用注册号的方法，由于lodop用户一般都用于商务产品或WEB工程，所以显示别人公司名称比水印还难以容忍。</p>
<p><strong>注册号使用</strong><br />控件注册号 注意事项 最新价格表、购买方式和使用方法见(官博)：<br />http://www.c-lodop.com/Lodop_Lic.html<br />可以用写在每个打印方法里，每次打印的时候都要执行，也可以放在链接里的LodopFuncs.js标注处，每次调用LODOP的时候统一调用。</p>
<p>参考排查一下http://www.c-lodop.com/faq/ph01.html<br />可以先做个简单的例子，直接复制邮箱里的注册号语句放到打印方法里，测试一下。<br />例如，直接把注册号放到打印方法里，测试一下。</p>
<p><strong>注册号无效</strong><br />参考排查一下http://www.c-lodop.com/faq/ph01.html<br />做个简单的例子试试，确认注册语句是执行了。</p>
<p>如果是注册的ip或域名，是否是访问的注册地址。<br />（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下：http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。<br />（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名： www.c-lodop.com 登陆方式如下：http://www.c-lodop.com/index.html等，ip地址访问时，注册信息无效<br />购买IP，更换服务器ip 需要重新购买ip注册信息。</p>
<p><strong>普通用户遇到带试用版水印怎么办：</strong><br />普通用户无法修改网站或软件的代码，需要咨询一下写这个网站的技术人员，向他们反馈一下。<br />普通用户可向软件或网站提供商进行反馈，有可能是开发软件的人没有购买注册号，直接用带试用版水印的，或者是开发人员已经购买，注册号使用不当，造成水印输出。</p>
<p>&nbsp;</p>
<p>cnblog链接（带图示）:<a href="https://www.cnblogs.com/huaxie/p/9933528.html" target="_blank">Lodop简短问答客户反馈篇 及排查步骤 及注册相关</a></p>
<p><a href="../blog_index.html">返回博文列表</a></p>
</div>
<div id="footer"><img src="../images/lodopfoot.png"></div>
</body>
</html>