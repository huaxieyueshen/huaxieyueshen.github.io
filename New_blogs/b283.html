<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WEB打印控件LODOP</title>
<script language="javascript" src="LodopFuncs.js"></script>
 <link href="../css/blogback.css" type='text/css' rel="stylesheet">     
</head>
<body id="bodyA1">
<div id="header">
<div id="head1"></div>
</div>
<div class="blogpost-body">
<h3>LODOP设置某打印项锁定下边距</h3>
    <p>LODOP中的打印项定位都是按照top值（顶边距），left(左边距）来决定的 ，不能直接设置某打印项的下边距。<br />此外，打印项的位置还受PRINT_INTA的前两个整体偏移值，打印机可打区域的影响。<br />该文测试下锁定下边距，以及锁定下边距后打印项位置是否和整体偏移，打印机可打区域等有关。</p>
<p><span style="color: #000080;">LODOP.SET_PRINT_STYLEA(0,"Vorient",1);</span><br />该语句用来设置锁定下边距，锁定后，切换不同纸张，该内容距离纸张下方的距离是相同的。(整体偏移和可打区域会影响，查看本博客下方）<br /><span style="background-color: #ccffcc;">锁定的下边距的值是：PRINT_INITA的height-打印项的top-打印项的height=下边距</span></p>
<p>该文锁定了一个纯文本，由于纯文本本身没有背景色，不容易看出纯文本设置的height高度，所以加了个矩形 ，矩形同样加了锁定下边距。<br />矩形和纯文本都锁定下边距20mm。</p>
<p>前面还有一个不锁定下边距的纯文本和矩形对照，两组纯文本和实心矩形的参数是一样的，打印项的顶边距都是20mm，高度都是40mm。</p>
<p><strong>测试1：（xps虚拟打印机，A4纸张，纸高297mm，无整体偏移）</strong><br />PRINT_INTA的top：0mm<br />PRINT_INTA的height:50mm<br />打印项top:20mm<br />打印项height:10mm</p>
<p>未锁定下边距的：距离纸张上方：20mm，距离纸张下方：297mm-20mm-10mm=267mm<br />锁定下边距的：距离纸张上方：267mm，距离纸张下方：297mm-267mm-10mm=20mm</p>
<p><strong>测试2：（同上，不换参数，换纸张，A6纸张，纸高148mm）</strong><br />未锁定下边距的：距离纸张上方：20mm，距离纸张下方：148mm-20mm-10mm=118mm<br />锁定下边距的：距离纸张上方：118mm，距离纸张下方：148mm-118mm-10mm=20mm</p>
<p>结果：不设置下边距锁定，换纸张大小，距离纸张上方不变。<br />      设置下边距锁定，换纸张大小，距离纸张下方不变</p>
<p><strong>测试3修改参数（设置整体向下偏移20mm，其余同测试1，纸张A4高297mm）</strong><br />未锁定下边距的：距离纸张上方：40mm（20的INITA的整体偏移值+打印项top值），距离纸张下方：297mm-40mm=257mm<br />锁定下边距的：距离纸张上方：287mm，距离纸张下方：297mm-287mm-10mm=0mm<br />结果：设置整体偏移值后，该页所有打印项均偏移，包括固定下边距也会偏移。</p>
<p><strong>测试4，（其余同测试3，换带可打区域的打印机）</strong><br />未锁定下边距的：距离纸张上方：40mm（20的INITA的整体偏移值+打印项top值），距离纸张下方：297mm-40mm=257mm（默认以可打区域为基点，在不加以纸张为基点的情况下）<br />锁定下边距的：距离纸张上方：278mm+4.2mm=282.2（4.2是可打区域的上边距），距离纸张下方：297mm-282.2mm-10mm=4.8mm（可打区域的下边距4.8mm）<br />结果：默认以可打区域为基点，锁定的下边距也是根据的可打区域。</p>
<p>最后结果（测试3是距离纸张下方0mm，测试4是距离可打区域下方0mm，距离纸张下方有可打区域边距值）：<br /><span style="color: #000080;">整体偏移会影响锁定的下边距 ，锁定的下边距默认是以可打区域为基点的。</span></p>
<p>测试代码：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">a </span><span style="color: #ff0000;">href</span><span style="color: #0000ff;">="javascript:p1();"</span><span style="color: #0000ff;">&gt;</span>锁定下边距<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">a</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">language</span><span style="color: #0000ff;">="javascript"</span><span style="color: #ff0000;"> src</span><span style="color: #0000ff;">="LodopFuncs.js"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> LODOP;
</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> p1(){
    LODOP</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">getLodop();
    LODOP.PRINT_INITA(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">0mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">0mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">200mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">50mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">任务名</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
    LODOP.ADD_PRINT_SHAPE(</span><span style="background-color: #f5f5f5; color: #000000;">4</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">20mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">0mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">40mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">10mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">0</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">1</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">#FF80FF</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
    LODOP.ADD_PRINT_TEXT(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">20mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">0mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">40mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">10mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">这是没锁定下边距的</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
    LODOP.ADD_PRINT_SHAPE(</span><span style="background-color: #f5f5f5; color: #000000;">4</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">20mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">0mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">40mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">10mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">0</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">1</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">#FFFF80</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
    LODOP.SET_PRINT_STYLEA(</span><span style="background-color: #f5f5f5; color: #000000;">0</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">Vorient</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">1</span><span style="background-color: #f5f5f5; color: #000000;">);
    LODOP.ADD_PRINT_TEXT(</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">20mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">0mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">40mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">10mm</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">这是一个文本</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">);
    LODOP.SET_PRINT_STYLEA(</span><span style="background-color: #f5f5f5; color: #000000;">0</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">Vorient</span><span style="background-color: #f5f5f5; color: #000000;">"</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #000000;">1</span><span style="background-color: #f5f5f5; color: #000000;">);
    LODOP.PRINT_DESIGN();
};
</span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">锁定到的下边距为50mm-20mm-10mmm</span><span style="background-color: #f5f5f5; color: #008000;">
//</span><span style="background-color: #f5f5f5; color: #008000;">PRINT_INITA的height-打印项的top-打印项的height=下边距</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;<br />测试1：如上代码，A4纸张<br />测试2：如上代码，A6纸张<br />测试3：LODOP.PRINT_INITA("20mm","0mm","200mm","50mm","任务名");，其他同测试1。<br />测试4：代码同测试3，换可打区域的打印机</span></pre>
</div>
<p>图示：</p>
<p><img src="https://img2018.cnblogs.com/common/1481828/201912/1481828-20191204113005377-711545553.png" alt="" /></p>
<p>&nbsp;</p>
<p>cnblog链接（带图示）:<a href="https://www.cnblogs.com/huaxie/p/11977685.html" target="_blank">LODOP设置某打印项锁定下边距</a></p>
<p><a href="../blog_index.html">返回博文列表</a></p>
</div>
<div id="footer"><img src="../images/lodopfoot.png"></div>
</body>
</html>