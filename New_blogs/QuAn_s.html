<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>Document</title>
  <link href="../css/styleQuAn1.css" type="text/css" rel="stylesheet">
 </head>
 <body>
<style> 
</style>
<body>
<div class="dd"><!--dd开始-->
<div class="content gray1"><h3>客户端本地打印角色，<a href="https://www.cnblogs.com/huaxie/p/9639085.html">查看详细链接</a></h3>
可混合部署，不论浏览器是否支持np插件都可使用。<br>
（1）在官网下载中心 下载综合安装包<br>
（2）安装 CLodop_Setup_for_Win32NT.exe（安装 兼容32位和64位操作系统）<br>
install_lodop32.exe（安装 浏览器位数是32位）64位操作系统中也可以有32位浏览器<br>
install_lodop64.exe（32位操作系统不用安装，64位操作系统中如果有64位浏览器，需要安装）<br>
（3）在页面引用安装包里的 LodopFuncs.js<br>
该LodopFuncs.js里有自动判断哪些浏览器使用Lodop，哪些浏览器使用C-Lodop的方法。<br>
（4）使用Lodop，具体使用方法参考官网样例（官网样例页面 右键-查看源码）<br>
方法外 var LODOP; //声明为全局变量<br>
在每个需要打印的地方：LODOP=getLodop(); //获得Lodop对象，getLodop()该方法在LodopFuncs.js里。<br>
最基本的打印过程至少有初始化语句、添内容语句和打印语句三部分组成，例如：<br>
LODOP.PRINT_INIT("打印任务名"); //首先一个初始化语句<br>
LODOP.ADD_PRINT_TEXT(0,0,100,20,"文本内容一");//然后多个ADD语句及SET语句<br>
LODOP.PRINT(); //最后一个打印(或预览、维护、设计)语句<br>
</div>
   <div class="content blue1"><h3>注册，<a href="https://www.cnblogs.com/huaxie/p/10860746.html">查看详细链接</a></h3>
控件注册号 注意事项 最新价格表、购买方式和使用方法见(官网)：<br>
http://www.c-lodop.com/Lodop_Lic.html<br>
<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
参考链接里的三种场景，是哪种角色。<br>
如果是客户端本地打印角色，客户端访问网站后在自己电脑连接的打印机上进行打印，不需要购买c-lodop注册号。lodop注册号对c-lodop客户端本地打印角色默认有效。<br>
<br>
IP和域名注册，根据浏览器地址栏访问方式注册，P访问，注册IP；域名访问，注册域名；不限IP域名，可做企业名称注册。<br>
（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。<br>
（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名： www.c-lodop.com 登陆方式如下：http://www.c-lodop.com/index.html等，ip地址访问时，注册信息无效<br>
<br>
域名和ip可以同时生效，最多同时支持3个，域名和ip地址加在一起不超过3个就可以，同时购买域名或ip的，可以下多个定单，也可以一个订单，联系在线的淘宝客服合并。<br>
   </div>
   <div class="content red1"><h3>纸张，打印机，份数，<a href="https://www.cnblogs.com/huaxie/p/11301778.html">查看详细链接</a></a></h3>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
纸张的一些优先级 http://www.c-lodop.com/blogs/Blog002.html<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。
选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
<br>
选择打印机，参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
打印机的一些优先级 http://www.c-lodop.com/blogs/Blog002.html<br>
测试一样例5,7，是否能获取到该打印机，获取的是安装到windows操作系统打印机列表的打印机。如果获取不到，重新安装驱动或重新共享试试。
如果样例正常，自己页面获取的不正常，清理下浏览器缓存，刷新页面试试。<br>
   </div>

   <div class="content green1"><h3>c-lodop没启动,<a href="https://www.cnblogs.com/huaxie/p/9596835.html">查看详细链接</a></a></h3>
   测试下官网样例http://www.c-lodop.com/demolist/PrintSample2.html 是否有什么提示。<br>
   双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启c-lodop后刷新页面。<br>
   启动成功后，刷新下页面，查看下是否变成了本地预览界面。<br>
  <br>
   c-lodop预览模式，参考http://www.c-lodop.com/faq/pp28.html<br>
   双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启c-lodop后刷新页面。<br>
   查看当前使用版本，建议使用最新版c-lodop， http://www.c-lodop.com/download.html<br>
  <br>
  参考http://www.c-lodop.com/faq/pp5.html<br>
  排查开机启动项，用管理员权限安装最新版http://www.c-lodop.com/download.html，右键以管理员权限运行，再对比试试。<br>
  排查c-lodop是否能开机自启动，默认情况c-lodop是开机自动启动的，没自动开启可能问题：<br>
  1. 在系统msconfig启动选项列查看c-lodop是否是开启自启动；<br>
  2. 当前操作用户权限不足，无系统管理员权限；<br>
  3. 注意安全软件禁用c-lodop. 目前常用的360及金山已进行了安全认证，其他的杀毒软件请加入白名单，或直接上报提交对应的杀毒软件服务器。<br>
   </div>

   <div class="content gray2"><h3>提示下载安装,<a href="https://www.cnblogs.com/huaxie/p/10265673.html">查看详细链接</a></a></h3>
Lodop页面总提示"未安装"或"请升级"的可能原因 参考http://www.c-lodop.com/faq/pp2.html<br>
<br>
测试参考一下官网样例http://www.c-lodop.com/LodopDemo.html<br>
官网样例是否有什么提示，提示内容是什么。<br>
官网样例是混合部署LodopFuncs.js里已经写好了判断。<br>
客户端是浏览器支持np插件，是32位浏览器，就会提示下载32位的Lodop插件：install_lodop32.exe<br>
客户端浏览器支持np插件，是64位浏览器，就会提示下载64位的Lodop插件：install_lodop64.exe<br>
客户端浏览器不支持np插件（判断如高版本谷歌火狐等），会提示下载C-Lodop方式： CLodop_Setup_for_Win32NT.exe<br>
<br>
测试一下官网样例http://www.c-lodop.com/demolist/PrintSample2.html。点样例的预览试试。<br>
如果样例正常，用ie浏览器试试，如果ie浏览器用也不行，联系一下你所使用网站的开发技术人员，让他们排查一下。<br>
   </div>
   <div class="content blue2"><h3>打印不清晰,<a href="https://www.cnblogs.com/huaxie/p/11550450.html">查看详细链接</a></a></h3>
   使用的的是什么语句输出的，是ADD_PRINT_TEXT纯文本，还是html的超文本。<br>
<br>
   如果用的是ADD_PRINT_HTML ，换成 ADD_PRINT_HTM试试，这种是解析后的超文本，放大也不会模糊。<br>
   ADD_PRINT_HTML是图形模式，适合高精度的图文打印机等，有的打印机会模糊，换用ADD_PRINT_HTM试试，这种是解析后的超文本。<br>
<br>
  如何输出清晰图片 参考http://www.c-lodop.com/faq/pp14.html<br>
  并用xps或pdf虚拟打印机测试<br>
<br>
  如何输出清晰图片 参考http://www.c-lodop.com/faq/pp14.html不要在img标签里缩放。<br>
  预览是缩略图，用xps或pdf虚拟打印机直接打印查看下效果，查看下虚拟打印机直接打印生成的文件。<br>
   </div>
 <div class="content color_fd0898"><h3>打印多出空白页,<a href="https://www.cnblogs.com/huaxie/p/10082571.html">查看详细链接</a></a></h3>
 给传入的整个超文本添加背景色，看输出的空白页中是否有背景色，并用用xps或pdf虚拟打印机测试一下。<br>
<br>
（1）可能有不可视内容 导致打印内容高度超过打印项高度 打印设计里调整下打印项高度。<br>
进入打印设计LODOP.PRINT_DESIGN();，分析一下 超文本是否输出了空白信息 或加入超文本背景色看一下。<br>
空白页，正好超出设置高度一点也会自动分页，从这里入手分析。<br>
（2）打印项上边距加高度超过纸张高度 如ADD_PRINT_HTML(10, 15, "100%", "100%");<br>
百分比是相对纸张的 上边距10 + 高度100% 超出纸张的高度<br>
（3）没初始化，容易造成多页的现象。<br>
（4）设置一下内容的高度，不要紧贴纸张大小输出，有时会接近纸张的无限边界时 有打印空白页 的现象或改用newpage<br>
（5） 打印机可打印区域问题 http://www.c-lodop.com/faq/pp26.html 。参考样例5，可设置以纸张边缘为基点输出，排除打印机可打印区域的影响。<br>
   </div>
 <div class="content color_144d03"><h3>条码数长度不同,<a href="https://www.cnblogs.com/huaxie/p/11038280.html">查看详细链接</a></a></h3>
参考http://www.c-lodop.com/faq/pp10.html<br>
条码设置多宽不一定是多宽，可以在打印设计里调整到合适大小，然后在打印设计里生成代码。<br>
<br>
参考http://www.c-lodop.com/faq/pp10.html<br>
参考链接的说明，宽度跳跃式放大或缩小，是非线性，宽度不能微小的调整，因为受所有条码竖的合计值影响。<br>
<br>
参考http://www.c-lodop.com/faq/pp10.html<br>
二维码可以通过设置具体的QRCode版本，让不同数值的二维码统一大小。<br>
条码随着数值不同，宽度可能不同，无法做到完全统一大小，可估计最大宽度，最后的实际宽度一般是小于等于设定宽度。<br>
   </div>
    <div class="content red2"><h3>常用测试地址和语句,<a href="https://www.cnblogs.com/huaxie/p/11550645.html">查看详细链接</a></a></h3>
  进入欢迎页面http://localhost:8000，点欢迎页面的预览试试<br>
<br>
 访问下http://[C-Lodop服务所在主机ip]:[C-Lodop端口]，点欢迎页面的预览试试<br>
 重启集中打印的云主机上的c-lodop，用最新版c-lodop，确保在启动状态。<br>
<br>
  访问下http://[C-Lodop服务所在主机ip或域名]:[C-Lodop端口]/c_aoprint 欢迎页面，查看下端桥是否在线，点预览试试<br>
<br>
  访问下http://[C-Lodop服务所在主机ip或域名]:[C-Lodop端口]/c_aobridge 测试某端桥下的其他打印机，点预览试试<br>
<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
参考链接里的三种角色及使用方法。<br>
如果是第二种角色：<br>
http://[C-Lodop服务所在主机ip或域名]:[C-Lodop端口]<br>
访问欢迎页面测试下。<br>
如果是第三种角色，访问下：<br>
http://[C-Lodop服务所在主机ip或域名]:[C-Lodop端口]/c_aobridge<br>
出问题的查看下端桥是否在线。<br>
<br>
访问下http://localhost:8000/c_sysmessage，查看本机c-lodop的出错信息<br>
访问下http://[C-Lodop服务所在主机ip或域名]:[C-Lodop端口]/c_sysmessage，查看AO服务器端c-lodop的出错信息<br>
<br>
访问https://localhost:8443欢迎页面试试。<br>
查看下c-lodop启动界面，在设置里查看下当前启动的端口，8443端口是否启动，启动端口号是否是8443<br>
https扩展版C-Lodop如何使用 参考http://www.c-lodop.com/faq/pp32.html<br>
目前只有32位c-lodop扩展版有https端口，安装的是否是32位c-lodop扩展版<br>
   </div>
       <div class="content color_0a034d"><h3>虚拟打印机,<a href="https://www.cnblogs.com/huaxie/p/11364736.html">查看详细链接</a></a></h3>
  用xps或pdf虚拟打印机测试下，先排查是代码问题还是打印机等问题。<br>
如果虚拟打印机正常，说明和打印机或打印机设置有关，如打印机不支持自定义纸张，不同打印机可打区域不同等影响。<br><br>
如果虚拟打印机也不正常，可能和内容样式等有关，参考http://www.c-lodop.com/faq/pp8.html<br>
<br>
用xps或pdf虚拟打印机测试，打印效果是保存成相应的xps或pdf文件，可以看出打印效果。<br>
如果虚拟打印机没有问题，可排除插件代码问题，理论上虚拟打印没问题的话，程序可做的努力就的确很少了，毕竟windows下的打印是微软倡导的设备无关系原则，要在打印机和打印驱动程序上找原因，可尝试重装驱动，或咨询一下打印机服务商。<br>
<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机 或者 下载安装群文件里的Doro PDF Writer虚拟打印机。<br>
然后指定安装的虚拟打印机进行打印，打印成文件。<br>
   </div>
       <div class="content gray3"><h3>图片显示叉号,<a href="https://www.cnblogs.com/huaxie/p/10082571.html">查看详细链接</a></a></h3>
直接把图片地址放到ie浏览器里是试验下。能否直接在浏览器里访问到。<br>
<br>
（1）查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
查看一下传入的图片路径是否正确，尽量用绝对路径地址，换个图片试试。<br>
（2）显示空白或者图片缺失等问题，加延迟试试：<br>
LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒<br>
（3）权限问题，图片显示叉号 说明服务端拒绝了 可能证书 session等问题，导致没有直接访问该图片的权限，有些需要验证之后才能访问图片。由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(cookies)<br>
（4）清空ie缓存 重置ie 后在ie中查看下。IE中的URL最大长度限制为2048字节。超过这个长度会不支持。<br>
（5） 查看服务器端错误日志排查下 。<br>
（6）做个简单的例子验证下，排除其他因素的干扰。Base64输出图片参考样例38。<br>
<br>
Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致，直接把图片地址放到ie浏览器里是试验下。能否直接在浏览器里访问到。<br>
   </div>
          <div class="content color2_fd0898"><h3>套打相关,<a href="https://www.cnblogs.com/huaxie/p/11532205.html">查看详细链接</a></a></h3>
打印设计和定位套打 参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
手把手教你WEB套打程序开发 参考http://www.c-lodop.com/blogs/Blog008.html<br>
返回设计的JS代码 参考样例35 http://www.lodop.net.cn/demolist/PrintSample35.html<br>
文档式模版生成和使用 参考样例50 http://www.lodop.net.cn/demolist/PrintSample50.html<br>
<br>
套打建议使用ADD_PRINT_TEXT等纯文本进行设计，这种不受浏览器引擎解析的影响。<br>
<br>
参考http://www.c-lodop.com/faq/pp17.html<br>
可用打印维护针对不同客户端进行调整，调整结果保存在本地。<br>
   </div>
</div><!--dd结束-->
 </body>
</html>
