<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WEB打印控件LODOP</title>
<script language="javascript" src="LodopFuncs.js"></script>
 <link href="../css/blogback.css" type='text/css' rel="stylesheet">     
</head>
<body id="bodyA1">
<div id="header">
<div id="head1"></div>
</div>
<div class="blogpost-body">
<h3>Lodop打印设计（PRINT_DESIGN）介绍</h3>
    <p>打印设计<span style="color: #000080;">（PRINT_DESIGN）</span>界面上方有两栏菜单栏，举例说明（文本框，条码，图形等）。<br /><strong>（1）</strong>第一排最左侧第一个功能，<strong>位置移动</strong>：控制里面元素微上下左右移动，每次移动一个px。<br />（用于微调，普通调整可拖动调整元素位置，移动选中的单个或多个打印项）<br /><strong>（2）</strong>第一排第二个功能，<strong>设置颜色</strong>。<br />点击颜色方格的图标，可选预设的颜色，或者自定义颜色。<br />例如：<br /><span style="color: #000080;">LODOP.ADD_PRINT_SHAPE(2,175,43,100,60,0,1,"#FF0000");//一个矩形设置颜色为#FF0000</span><br /><span style="color: #000080;">LODOP.ADD_PRINT_TEXT(85,391,75,20,"文本内容");</span><br /><span style="color: #000080;">LODOP.SET_PRINT_STYLEA(0,"FontColor","#0000FF");//给前面第一个文本（序号0为前面紧跟着的元素，这里是Text文本元素）加字体颜色FontColor是#0000FF。</span><br /><strong>（3）</strong>第一排第三个功能，<strong>选择字体</strong>。<br />例如：<br /><span style="color: #000080;">LODOP.ADD_PRINT_TEXT(83,78,75,20,"文本内容");</span><br /><span style="color: #000080;">LODOP.SET_PRINT_STYLEA(0,"FontName","隶书");//设置上一项的文本字体为隶书。</span><br /><span style="color: #000080;">LODOP.ADD_PRINT_BARCODE(181,92,100,60,"MSI","123456789012");//设置条码版本为MSI。（打印设计插入条码元素，在打印设计字体里可修改条码或二维码）</span><br /><strong>（4）</strong>第一排第四个功能，<strong>设置大小</strong>。点击上（或下）箭头增大（或减小）1，点击不放松持续增长或减小。<br />例如：<br /><span style="color: #000080;">LODOP.ADD_PRINT_BARCODE(181,92,426,57,"MSI","123456789012");</span><br /><span style="color: #000080;">LODOP.SET_PRINT_STYLEA(0,"FontSize",14);//设置条码下方字体的大小。如果加样式的对象是文本，就是文本字体。</span><br />（如果设置了下方不显示字符LODOP.SET_PRINT_STYLEA(0,"ShowBarText",0)，只显示条状的本身，则无效）<br />  如果是线，这里&ldquo;大小&rdquo;会变成&ldquo;线宽&rdquo;，<br /><strong>（5）</strong>第一排第五个功能，<strong>设置旋转角度</strong>。点击上（或下）箭头增大（或减小）1，点击不放松持续增长或减小。例如：<span style="color: #000080;">  LODOP.ADD_PRINT_TEXT(25,31,100,20,"新加文本1"); LODOP.SET_PRINT_STYLEA(0,"Angle",10);//前面这个文本逆时针旋转10度。</span>如果旋转角度是负数，则是顺时针。 (旋转效果在预览时能看到，打印设计页面看不到选择效果，打印预览可以预览效果）（旋转后的效果只能在打印预览界面看到） <br /><strong>（6）</strong>第一排第六个功能，<strong>设置打印项的宽度高度</strong>，点击上（或下）箭头增大（或减小）1，点击不放松持续增长或减小。<br />例如：<br /><span style="color: #000080;">LODOP.ADD_PRINT_TEXT(25,31,18,8,"新加文本1");//宽高较小，这里预览只能看到一个新字。</span><br />打印项宽度不够，多余的部分文本会换行显示。<br />打印项高度不够，可能会导致后面的内容无法显示。如果是html超文本，打印项高度小于本身的高度，会根据打印项的高度分页，造成多页现象。<br />html超文本打印项自动分页，多页项，可查看本博客相关博文 <a href="https://www.cnblogs.com/huaxie/p/9640491.html" target="_blank">Lodop打印控件 超文本自动分页</a>。<br />（如果打印项有部分不显示，在打印设计里调整一下打印项的高度，就是指这里的调整，这高度也是超文本自动分页的依据）<br /><strong>（7）</strong>第二排第一个功能，设置<strong>文本加粗</strong>。点击即可加粗或取消加粗。<br />例如：<br /><span style="color: #000080;">LODOP.ADD_PRINT_TEXT(25,31,76,23,"新加文本1");</span><br /><span style="color: #000080;">LODOP.SET_PRINT_STYLEA(0,"Bold",1);//给前面的那个文本加粗。</span><br />第二排第二个功能，设置<strong>文本斜体</strong>。点击即可斜体或取消斜体。<br />例如：<br /><span style="color: #000080;">LODOP.ADD_PRINT_TEXT(25,31,76,23,"新加文本1");</span><br /><span style="color: #000080;">LODOP.SET_PRINT_STYLEA(0,"Italic",1);//让前面的那个文本倾斜。</span><br />右边紧挨着的是第三个功能，<strong>加下划线</strong>，这三个常用的样式加粗，斜体，下划线。<br /><span style="color: #000080;">LODOP.SET_PRINT_STYLEA(0,"Underline",1);//文本加下划线</span><br /><strong>（8）</strong>第二排第四个功能，<strong>设置相对于文本框左对齐，居中，右对齐</strong>。<br />左对齐，默认，文字内容向右延展。<br />例如：<br /><span style="color: #000080;">LODOP.ADD_PRINT_TEXT(73,76,222,20,"1234w");</span><br /><span style="color: #000080;">LODOP.SET_PRINT_STYLEA(0,"Alignment",2);//设置文本居中，内容始终在文本框中间。</span><br /><span style="color: #000080;">LODOP.ADD_PRINT_TEXT(73,136,162,20,"$1233");</span><br /><span style="color: #000080;">LODOP.SET_PRINT_STYLEA(0,"Alignment",3);//设置文本右对齐，内容始终在最右边，最后一个文本在文本框最右边边距处。文字内容延展到左边。</span><br /><strong>（9）</strong>第二排第五个功能，<strong>设置线条的样式</strong>。<br />该组合，有5个线条样式，如下语句第五个参数为样式，对应这里的打印设计的线条。<br />0--实线 1--破折线 2--点线 3--点划线 4--双点划线<br />例如：<br /><span style="color: #000080;">LODOP.ADD_PRINT_LINE(49,106,46,206,0,3);//一条线宽厚度为3的直实线。当线宽=高时，为直线。</span><br />除实线之外，其他的样式线宽都为0，也就是如上语句的第六个参数。<br /><strong>（10）</strong>第二排第六个功能，<strong>打印项对齐</strong>。<br />例如：<br />打印项的位置，参数一般为top（顶边距）,left（左边距）,width（宽度）,height(高度）。<br />LODOP.ADD_PRINT_TEXT(44,45,100,20,"新加文本3");<br />LODOP.ADD_PRINT_TEXT(80,45,100,20,"新加文本4");<br />LODOP.ADD_PRINT_ELLIPSE(128,45,100,60,0,1);<br />//左侧对齐，可以看出代码第二个左边距，都是45。<br /> 打印设计界面，各种快速的对齐方式，可查看本博客另一篇博文：<a href="https://www.cnblogs.com/huaxie/p/9915137.html" target="_blank">Lodop打印设计里的 打印项对齐</a><br /><strong>（11）</strong>第二排第七个功能，<strong>设置背景图</strong>相关操作，下拉菜单，列表里有各种选项设置。<br />预览含背景图，打印含背景图，点击后打勾就是以选择，取消勾选就取消设置。<br />包括 装载背景图、清除背景图、调整背景图、设置预览含有背景图（不打印）、打印含背景图<br />例如：<br /><span style="color: #000080;">LODOP.ADD_PRINT_SETUP_BKIMG("D:\\q1.png");//选择本地路径的一个png图片作为背景图。</span><br /><span style="color: #000080;">LODOP.SET_SHOW_MODE("BKIMG_IN_PREVIEW",true);//设置预览包含背景图</span><br /><span style="color: #000080;">LODOP.SET_SHOW_MODE("BKIMG_PRINT",true);//设置打印背景图</span><br />上面三句话，就是选设置一个背景图，预览的时候显示，并且打印的时候也打印出来。<br /><strong>（12）</strong>第二排第八个功能，<strong>插入，删除，生成代码，全部选定，显示标尺，显示文本框等</strong>。<br />这个下拉列表里可以插入的东西很多，例如HTM（超文本普通模式）、HTML（超文本图形模式）、TABLE（表格）、URL（网页地址）、TEXT（文本）、IMAGE（图片）、RECT（线框矩形）、SHAPE（实心形状）、ELLPASE（线框椭圆）、LINE（线）、BARCODE（条码，二维码）、CHART（图表）等。<br />删除，可删除选中项，如果觉得每次点击列表下的这个比较麻烦，可以用快捷键。<br />全部选定，选中全部打印项。<br />显示标尺，显示文本框等。<br />这里面，生成程序代码&mdash;&mdash;就是在打印设计界面，设计完成后自动生成设计好的代码，复制粘贴到程序里就可以使用，如果需要，可以把生成代码里的值改成变量，变成模版，如果打印项内容过多，会显示省略号，可以用语句返回全部的设计好的代码，可查看本博客另一篇博文：<a href="https://www.cnblogs.com/huaxie/p/9777750.html" target="_blank">Lodop打印设计界面生成代码带&rdquo;...(省略)&rdquo;</a><br /><strong>（13）</strong>第二排第九个功能，<strong>设置页眉页脚，位置锁定，对象锁定等等</strong>。<br />例如：<br /><span style="color: #000080;">LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_空白练习");</span><br /><span style="color: #000080;">LODOP.ADD_PRINT_TEXT(42,69,100,20,"新加文本1");</span><br /><span style="color: #000080;">LODOP.SET_PRINT_STYLEA(0,"ItemType",1);//设置上面那个文本为页眉。</span><br /><span style="color: #000080;">LODOP.ADD_PRINT_TEXT(201,130,100,20,"新加文本2");</span><br /><span style="color: #000080;">LODOP.SET_PRINT_STYLEA(0,"Vorient",1);//设置下边距锁定</span><br />页眉页脚项则每页都在固定位置重复打印，ItemType值："ItemType0--普通项 1--页眉页脚 2--页号项 3--页数项4--多页项。<br /><strong>（14）</strong>未注册的，打印设第二行最右侧有个<strong>关于按钮</strong>，注册后隐藏。<br /><strong>（15）</strong>两排菜单栏最右侧，有<strong>暂存、复原、预览、打印</strong>。<br />暂存后，复原到上一次暂存的位置，只能一次，和ps，blender里面等多级历史记录上一次操作不同，这里只能一次，也类似ctrl+C，ctrl+V<br />该暂存，在打印设计关闭后不会生成任何文件，只是作为打印设计的辅助。<br />生成模版文件的是打印维护，会在电脑里生成实体ini文件，针对每个客户端电脑本地有效的调整后的模版。（该模版只会对调整的客户端电脑产生影响，访问网站的其他用户客户端电脑不受影响。如果想消灭本地影响，可恢复整体缺省到网站里原始代码的设置，也可手动删除该ini文件，每个ini文件前缀是初始化打印任务名）<br /><strong>（16）</strong>左侧打印项栏，<strong>打印项列表</strong>。<br />这里可以选中打印项，也可以调整顺序，打印项输出的顺序的，打印的时候会按照该顺序输出。<br />如果初识没有显示左侧栏，可以点击打印设计左侧边缘的一个小三角形，展开左侧的打印项列表。<br />如果生成代码后需要调整，也可以手动调整一下各个语句的顺序。<br /><strong>（17）</strong>选中打印项或设计界面，<strong>右键，属性</strong>。<br />设计界面右键，会选择设置纸张，或者打印设计自定义纸张在该打印设计预览。<br />打印项右键，根据打印项的不同，右键弹出来的窗口和选项也不同。<br />例如：<br />在右键属性里设置文本项的行间距、字间距。在右键属性里设置文本项的行间距、字间距。在右键属性里设置文本项的行间距、字间距。</p>
<p><img src="https://img2018.cnblogs.com/blog/1481828/201811/1481828-20181106160634083-867398338.png" alt="" /></p>
<p>&nbsp;</p>
<p>cnblog链接（带图示）:<a href="https://www.cnblogs.com/huaxie/p/9915872.html" target="_blank">Lodop打印设计（PRINT_DESIGN）介绍</a></p>
<p><a href="../blog_index.html">返回博文列表</a></p>
</div>
<div id="footer"><img src="../images/lodopfoot.png"></div>
</body>
</html>