<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WEB打印控件LODOP</title>
<script language="javascript" src="LodopFuncs.js"></script>
 <link href="../css/blogback.css" type='text/css' rel="stylesheet">     
</head>
<body id="bodyA1">
<div id="header">
<div id="head1"></div>
</div>
<div class="blogpost-body">
<h3>Lodop获取客户端主网卡ip地址是0.0.0.0</h3>
    <p>LODOP技术手册的GET_SYSTEM_INFO篇，LODOP可以用语句获取到客户端很多信息，NetworkAdapter.1.IPAddress是主网卡IP地址，通常情况下是没问题的，不过如果当前使用的网卡不是主网卡，网卡顺序并不是和实际使用的这样，<span style="background-color: #ffcc99;">网卡顺序会影响该值的获取，如果不是当前使用的网卡，获取到的值会是0.0.0.0</span>，这种情况下，要么调整网卡的顺序，要么就逐个获取，可以先获取网卡的个数，然后根据个数逐个获取网卡的地址，直到出现不为0的状况。<br />NetworkAdapter.1.IPAddress这个值中的1可以修改为其他值，第二个网卡就是2，第三个网卡就是3，以此类推。<br />如图，如果获取主网卡ip是0.0.0.0，试试其他网卡的，总有一个能获取到值，有的电脑主网卡还会变，以前我的电脑没问题，换了这个新的电脑后发现网卡也常变，不知道和什么有关，可能和操作系统网卡的顺序，或win10系统，或硬件有关。</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="button"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="主网卡MAC地址:"</span><span style="color: #ff0000;"> 
onclick</span><span style="color: #0000ff;">="document.getElementById('T5').value=getSystemInfo('NetworkAdapter.1.PhysicalAddress',document.getElementById('T5'))"</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="T5"</span><span style="color: #ff0000;"> size</span><span style="color: #0000ff;">="48"</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="button"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="网卡个数:"</span><span style="color: #ff0000;"> 
onclick</span><span style="color: #0000ff;">="document.getElementById('T6').value=getSystemInfo('NetworkAdapter.Count',document.getElementById('T6'))"</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="T6"</span><span style="color: #ff0000;"> size</span><span style="color: #0000ff;">="54"</span><span style="color: #0000ff;">&gt;</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="button"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="主网卡IP地址:"</span><span style="color: #ff0000;"> 
onclick</span><span style="color: #0000ff;">="document.getElementById('T7').value=getSystemInfo('NetworkAdapter.1.IPAddress',document.getElementById('T7'))"</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="T7"</span><span style="color: #ff0000;"> size</span><span style="color: #0000ff;">="49"</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="button"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="第二个网卡IP地址:"</span><span style="color: #ff0000;"> 
onclick</span><span style="color: #0000ff;">="document.getElementById('T8').value=getSystemInfo('NetworkAdapter.2.IPAddress',document.getElementById('T8'))"</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="T8"</span><span style="color: #ff0000;"> size</span><span style="color: #0000ff;">="49"</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="button"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="第三个网卡IP地址:"</span><span style="color: #ff0000;"> 
onclick</span><span style="color: #0000ff;">="document.getElementById('T9').value=getSystemInfo('NetworkAdapter.3.IPAddress',document.getElementById('T9'))"</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="T9"</span><span style="color: #ff0000;"> size</span><span style="color: #0000ff;">="49"</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="button"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="第四个网卡IP地址:"</span><span style="color: #ff0000;"> 
onclick</span><span style="color: #0000ff;">="document.getElementById('T10').value=getSystemInfo('NetworkAdapter.4.IPAddress',document.getElementById('T10'))"</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> id</span><span style="color: #0000ff;">="T10"</span><span style="color: #ff0000;"> size</span><span style="color: #0000ff;">="49"</span><span style="color: #0000ff;">&gt;</span>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">language</span><span style="color: #0000ff;">="javascript"</span><span style="color: #ff0000;"> type</span><span style="color: #0000ff;">="text/javascript"</span><span style="color: #0000ff;">&gt;</span>   
   <span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> LODOP; </span><span style="background-color: #f5f5f5; color: #008000;">//</span><span style="background-color: #f5f5f5; color: #008000;">声明为全局变量   </span>
   <span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;"> getSystemInfo(strINFOType,oResultOB){
       LODOP</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">getLodop(); 
       </span><span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (LODOP.CVERSION) CLODOP.On_Return</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(TaskID,Value){</span><span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (oResultOB) oResultOB.value</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">Value;}; 
       </span><span style="background-color: #f5f5f5; color: #0000ff;">var</span><span style="background-color: #f5f5f5; color: #000000;"> strResult</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">LODOP.GET_SYSTEM_INFO(strINFOType);
       </span><span style="background-color: #f5f5f5; color: #0000ff;">if</span><span style="background-color: #f5f5f5; color: #000000;"> (</span><span style="background-color: #f5f5f5; color: #000000;">!</span><span style="background-color: #f5f5f5; color: #000000;">LODOP.CVERSION) </span><span style="background-color: #f5f5f5; color: #0000ff;">return</span><span style="background-color: #f5f5f5; color: #000000;"> strResult; </span><span style="background-color: #f5f5f5; color: #0000ff;">else</span> <span style="background-color: #f5f5f5; color: #0000ff;">return</span> <span style="background-color: #f5f5f5; color: #000000;">""</span><span style="background-color: #f5f5f5; color: #000000;">;
   }
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span> 
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;<img src="https://img2018.cnblogs.com/blog/1481828/201811/1481828-20181101111922254-164215972.png" alt="" /></p>

<p>&nbsp;</p>
<p>cnblog链接（带图示）:<a href="https://www.cnblogs.com/huaxie/p/9888151.html" target="_blank">Lodop获取客户端主网卡ip地址是0.0.0.0</a></p>
<p><a href="../blog_index.html">返回博文列表</a></p>
</div>
<div id="footer"><img src="../images/lodopfoot.png"></div>
</body>
</html>