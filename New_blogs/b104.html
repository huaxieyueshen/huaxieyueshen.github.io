<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WEB打印控件LODOP</title>
<script language="javascript" src="LodopFuncs.js"></script>
 <link href="../css/blogback.css" type='text/css' rel="stylesheet">     
</head>
<body id="bodyA1">
<div id="header">
<div id="head1"></div>
</div>
<div class="blogpost-body">
<h3>LODOP、C-Lodop简短排查语句</h3>
    <p><strong>https使用，故障：</strong><br />1.是https网站吗，https扩展版C-Lodop如何使用 参考http://www.c-lodop.com/faq/pp32.html<br />2.双击桌面上的c-lodop快捷方式，查看一下端口是否是8443<br />3.https://localhost:8443/c_sysmessage<br />桌面上的c-lodop快捷方式，右键以管理员权限运行，<br />然后刷新这个查看故障的页面，查看访问限制的故障是否消失了<br />在桌面上的c-lodop快捷方式，右键，选择以管理员权限运行。<br />4.参考http://www.c-lodop.com/faq/pp32.html<br />需要安装32位c-lodop扩展版，64位没有https端口。32位的c-lodop支持32位和64位操作系统，用32位的c-lodop就行。<br />5.双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启后刷新页面试试。<br />6.进入欢迎页面，点欢迎页面的预览测试下https://localhost:8443<br />7.lodop支持https，c-lodop需要 参考http://www.c-lodop.com/faq/pp32.html</p>
<p>https 肯定是域名的， 证书都是颁发给域名， 不可能颁发给ip地址</p>
<p><strong>提示 Operation not supported on selected printer、Printer selected is not valid、There is no default printer currently selected：</strong><br />1.用最新版对比试试http://www.c-lodop.com/download.html<br />最新版对这个问题有优化<br />2.参考http://www.c-lodop.com/faq/pp1.html<br />如果确认是最新版，排查下链接的内容。<br />3.是否没有指定默认打印机，查看一下windows打印机列表，指定一下打印机。<br />4.用最新版测试下http://www.c-lodop.com/download.html<br />如果最新版也是这样，选择其他打印机试试，重装该打印机驱动试试。</p>
<p><strong>注册号无效</strong><br />参考排查一下http://www.c-lodop.com/faq/ph01.html</p>
<p><strong>通用：</strong><br />1.测试下官网样例http://www.c-lodop.com/demolist/PrintSample2.html 是否有什么提示。</p>
<p>win7以上系统自带xps虚拟打印机，或安装pdf虚拟打印机，打印成文件。<br />如果文件正常，可能和打印机的可打区域或纸张不识别等有关。<br />如果虚拟打印机文件有问题，说明代码有问题。<br />用虚拟打印机打印测试，可排查是代码问题还是和打印机有关。</p>
<p>把预览语句临时改成LODOP.PRINT_DESIGN();查看下。<br />查看下左侧的打印项列表。</p>
<p>用管理员权限安装最新版http://www.c-lodop.com/download.html，右键以管理员权限运行，再对比试试。</p>
<p>用管理员权限安装最新版对比试试http://www.c-lodop.com/download.html，以管理员权限运行。</p>
<div>可以用下载中心综合版里的样例测试，下载综合版，放到该机器上本机测试。</div>
<p><strong>超文本样式</strong><br />1.加载css样式，参考样例10 http://www.c-lodop.com/demolist/PrintSample10.html<br />2.xps或pdf虚拟打印机测试下，预览是图形模式，以实际输出的为准。<br />3.是否是没加载完，加延迟试试：<br />LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒<br />4.指定一下具体中文字体试试，用字体的中文名，例如style="font-family:'楷体';"<br />&lt;font face="隶书"&gt;"学员"&lt;/font&gt;试一试加上中文名的字体。<br />5.lodop是基于本机ie引擎进行解析渲染的，不要用本机ie不支持的html css js ，重置ie浏览器试试。<br />6.可尝试把ADD_PRINT_HTM 换成 ADD_PRINT_HTML（图形模式）试试。</p>
<p>&nbsp;</p>
<p>---------------以下备用-----------------------</p>
<p><strong>超文本：</strong><br />1.查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />是否样式文件的访问有限制，参考链接，进入打印设计，排查一下实际传入的样式。</p>
<p>查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />查看一下实际传入的超文本内容。</p>
<p>加载css样式，参考样例10 http://www.c-lodop.com/demolist/PrintSample10.html<br />查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />查看一下样式是否都传入了。</p>
<p>是否是没加载完，加延迟试试：<br />LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒</p>
<p>动态加载的值 参考样例23 刷新赋值, <br />如果内容很多需要加延迟等待动态内容加载完毕<br />延迟lodop加载速度，等待网页图片或动态生成内容加载完成，参考样例47 <br />LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",100);//延迟100毫秒<br />该语句加到需要等待的输出项后 </p>
<p>如果是html超文本，参考：<br />查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />是否样式文件的访问有限制，参考链接，进入打印设计，排查一下实际传入的样式。<br />打印设计是辅助设计的，以预览效果为准</p>
<p>查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />分析差异点，因浏览器版本不同遵循的html标准不同，造成某些标签属性显示有差异，尽量避免使用有差异的属性，可以在ie下不同版本仿真情况下验证差异<br />排查样式，尽量使用使用各浏览器无歧义的通用的 html css js，不支持的样式可尝试用其他样式代替。</p>
<p>查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />查看一下传入的样式，排查一下样式问题。<br />把从打印设计，选中超文本打印项，右键属性里拷出来的超文本代码发过来测试一下。</p>
<p>用xps或pdf虚拟打印机测试一下，如果虚拟打印机实际输出的文件也有问题，<br />查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />查看一下传入的样式，排查一下样式问题。<br />把从打印设计，选中超文本打印项，右键属性里拷出来的超文本代码发过来这边排查测试一下试试。</p>
<p><strong>位数是针对浏览器的还是系统的</strong><br />参考http://www.c-lodop.com/faq/pp21.html<br />1.Lodop与浏览器位数有关,与操作系统位数无关：<br />    32位Lodop安装程序适应32位浏览器；<br />    64位Lodop安装程序适应64位浏览器；<br />    适用浏览器：ie系列、火狐51版及历史版本、谷歌44版及历史版本。（新版火狐及谷歌不再支持np插件，也不能使用lodop）<br />2.C-Lodop与操作系统位数有关，与浏览器位数无关：<br />    32位C-Lodop安装程序适应32位及64位操作系统；<br />    64位C-Lodop安装程序仅适应64位操作系统；<br />    适用于所有浏览器。</p>
<p>如果是https网站，需要用32位扩展版。</p>
<p><strong>add_print_text纯文本自动缩放</strong><br />如果用add_print_text没有很好的办法，或者尝试多页项，放不下的会分到下一页http://www.c-lodop.com/demolist/PrintSample6.html<br />或者用超文本，超文本拼接字符串组合成最后的超文本打印项。</p>
<p><strong>新代码不生效</strong><br />参考http://www.c-lodop.com/demolist/t1.html<br />参考链接里的三种场景，是否是第一种客户端本地打印角色。<br />清理客户端浏览器缓存试试，让最新的代码生效，用xps或pdf虚拟打印机测试下。</p>
<p><strong>无论打什么都有上边距</strong><br />查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br />是否是超文本内部的上边距。<br />测试样例2 http://www.c-lodop.com/demolist/PrintSample2.html<br />如果不管打什么都有顶部有空白，是否是可打区域或打印机不在初始位置造成的，排查打印机设置试试。</p>
<p><strong>条码不清晰不识别</strong><br />条码用LODOP语句输出，参考样例11http://www.c-lodop.com/demolist/PrintSample11.html<br />用xps或pdf虚拟打印机测试一下。<br />增大条码宽度试试，影响条码识别率的可能原因 参考http://www.c-lodop.com/faq/pp6.html</p>
<p>先用xps或pdf虚拟打印机测试一下。<br />试试打印出来的文件是否清晰。</p>
<p><strong>超文本分页被切行</strong><br />超文本超过设置的打印项高度就会自动分页，可通过调整超文本打印项的高度，控制当前页面输出的多少内容。（打印项高度可在打印设计界面可视化调整）<br />减小高度，不要紧贴纸张下方输出。<br />用 add_pirnt_htm, 切行时调整分页粒度TableRowThickNess，参考 样例30<br />http://www.c-lodop.com/demolist/PrintSample30.html</p>
<p><strong>纸张：</strong><br />纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br />用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。<br />选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br />如果是固定高度的，不是小票打印那种，不要用高度自适用。</p>
<p><strong>提示下载安装</strong><br />参考一下官网样例http://www.c-lodop.com/LodopDemo.html<br />直接引用LodopFuncs.js，修改里面提示下载安装的路径为自己放置的安装文件的路径<br />官网样例是混合部署LodopFuncs.js里已经写好了判断。<br />客户端是浏览器支持np插件，是32位浏览器，就会提示下载32位的Lodop插件：install_lodop32.exe<br />客户端浏览器支持np插件，是64位浏览器，就会提示下载64位的Lodop插件：install_lodop64.exe<br />客户端浏览器不支持np插件（判断如高版本谷歌火狐等），会提示下载C-Lodop方式： CLodop_Setup_for_Win32NT.exe</p>
<p><strong>CLodopfuncs.js</strong><br />参考http://www.c-lodop.com/faq/pp23.html<br />启动C-Lodop时才自动生成该文件。</p>
<p>用最新版试试http://www.c-lodop.com/download.html<br />访问下https://localhost:8443，如果能访问点里面的预览能预览，说明启动正常。</p>
<p><strong>提示&lsquo;没准备好&rsquo;</strong><br />参考http://www.c-lodop.com/faq/pp3.html 处理一下</p>
<p><strong>对象类名 关联对象是什么</strong><br />按项目类名赋值,项目类型是aa：<br />LODOP.SET_PRINT_STYLEA(&lsquo;aa&rsquo;,"Content","学生证");//项目类名是aa的所有打印项内容被替换<br />对象类名 具体的解释 可以参考 lodop技术手册<br />关联输出 参考样例41</p>
<p><strong>可打区域</strong><br />默认是以可打区域边缘为基点的，.&ldquo;可打区域&rdquo;边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br />http://www.c-lodop.com/faq/pp26.html<br />设置以纸张边缘为基点参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html或用打印维护微调，结果保存在客户端本地，其他客户端不受影响。</p>
<p><strong>新手样例和技术手册</strong><br />官网在线样例：<br />http://www.c-lodop.com/LodopDemo.html<br />下载中心综合版里也自带样例：http://www.c-lodop.com/download.html<br />下载中心也有技术手册可供参考。</p>
<p><strong>分页</strong><br />超文本超过设置的打印项高度就会自动分页，可通过调整超文本打印项的高度，控制当前页面输出的多少内容。（打印项高度可在打印设计界面可视化调整）<br />减小打印项高度，不要紧贴纸张输出。</p>
<p>手动分页 参考样例30 http://www.c-lodop.com/demolist/PrintSample30.html</p>
<p>单个表格输出 可以用add_print_table。</p>
<p>如果有合并行、嵌套表格等复合表格 可以用 add_pirnt_htm, 切行时调整分页粒度TableRowThickNess，参考 样例30<br />http://www.c-lodop.com/demolist/PrintSample30.html</p>
<p>超文本超过设置的打印项高度就会自动分页，可通过调整超文本打印项的高度，控制当前页面输出的多少内容。（打印项高度可在打印设计界面可视化调整）<br />如果内容不固定，或调整不好，可以通过强制分页方式。<br />强制分页有很多方式 参考样例30 http://www.c-lodop.com/demolist/PrintSample30.html</p>
<p>进入打印设计，选中打印项，调整打印项高度，预览查看效果，调整到合适的打印项高度。<br />超文本会按照这个打印项高度自动分页。</p>
<p><img src="https://img2018.cnblogs.com/blog/1481828/201904/1481828-20190423151109163-375629878.png" alt="" /></p>
<p><strong>漏打</strong><br />用最新版对比试试http://www.c-lodop.com/download.html<br />参考样例4http://www.c-lodop.com/demolist/PrintSample4.html判断打印的返回值，设置如果漏打，重新打印该任务试试。</p>
<p>参考样例4 http://www.c-lodop.com/demolist/PrintSample4.html,判断下print的返回值。<br />调试JS，排查是否执行了足够次数的pirnt。<br />并查看版本，用最新版http://www.c-lodop.com/download.html</p>
<p>如果队列里任务也不正常，应该是漏任务了，调试JS，排查是否执行了八次pirnt，查看下pirnt的返回值是否正常。</p>
<p>如果队列里任务正常，用虚拟打印机测试下，队列和虚拟打印机个都正常，说明代码正常，进入队列后就开始排队了，打印机打印不出来，应该和打印机有关，重装打印机驱动试试。</p>
<p><strong>漏打任务（偶尔无规律，无法复现）：</strong><br />1.用最新版http://www.c-lodop.com/download.html<br />2.参考样例4http://www.c-lodop.com/demolist/PrintSample4.html<br />直接判断print的返回值，判断是否加入了队列。<br />批量打印，参考样例26，尽量多分一些任务试试。</p>
<p>1.用最新版http://www.c-lodop.com/download.html<br />2,判断print的返回值，参考样例4.http://www.c-lodop.com/demolist/PrintSample4.html<br />返回值判断的是是否加入队列，如果已经加入了队列，就不是程序漏打了。<br />3.脱机测试打印，偶尔出现不好排查，最好能找到规律，查看队列是否正常。</p>
<p>漏打内容（偶尔无规律，虚拟打印机也有时候可以复现）：<br />如果是批量打印超文本，中间漏打的是空白，可以加延迟等方式试试，尽量多分一些任务试试。<br />批量打印大量较大的图片，可以试试直接输出base64码方式，参考样例38，不要加img标签。<br />批量点大量的超文本和图片，可能会有影响。尽量用add_print_text纯文本等进行设计，这种是lodop直接输出的，不需要经过浏览器解析。</p>
<p>偶尔出现且无法还原不好排查，最好能找到规律。<br />如果是单个用户，是否是该用户电脑或系统等问题，最好在出问题的时候去用户电脑上排查下，找到和什么原因有关。</p>
<p><strong>偶然发生打印同样内容多次</strong><br />偶然发生不好排查，调试下JS，脱机查看下打印机队列，<br />用虚拟打印机多测试几次。</p>
<p>如果虚拟打印机多次测试都是正常的，真实打印机多次测试脱机后队列也正常，应该和打印机或打印机驱动有关，重装打印机驱动试试。</p>
<p><strong>输出个超文本有进度条很慢</strong><br />远程共享打印机 打印机驱动有问题 内容过多需要下载有脚步执行或本身网络慢 <br />机器性能过低 系统ie有问题或缓存过多<br />可能会出现这种问题 。跟机器 网络 内容都相关。<br />尽量减少单个任务数据量 参考样例26 ，重置下ie， 用本机虚拟打印机测试对比<br />批量打印，分页分任务，在页数和任务之间平衡一下，参考样例26http://www.c-lodop.com/demolist/PrintSample26.html<br />删减内容排查下，也可能和内容有关，如果内容过多，可以多分一些任务试试。</p>
<p>输出个简单的超文本内容对比试试。<br />如果简单的超文本内容很快，可能和内部的什么样式或其他内容加载有关。</p>
<p><strong>同一台电脑有时候能打印有时候不能，无反应（无法还原问题，开发人员测不出来，偶尔出现无规律）</strong><br />打印不出来的时候，查看下打印机队列。是否进入了队列，打印机脱机等问题。<br />同一台电脑有时候可以打印，有时候不可以打印吗，打印出来的时候有什么现象。<br />打印不出来的时候，进入打印机队列查看下任务状况 。<br />参考样例4http://www.c-lodop.com/demolist/PrintSample4.html<br />判断下PRINT的返回值试试。<br />参考样例4，判断print的返回值试试，这个返回值是发送打印任务加入队列算成功。</p>
<p>调试下JS，排查是否执行了打印语句，打印的时候单据信息是否都已经获取到了。<br />用虚拟打印机测试下，做个简单的例子对比试试，如果能还原问题，发个例子来这边测试下。<br />用最新版对比试试http://www.c-lodop.com/download.html</p>
<p>偶尔出现且无法还原不好排查，最好能找到规律。<br />如果是单个用户，是否是该用户电脑或系统等问题，最好在出问题的时候去用户电脑上排查下，找到和什么原因有关。</p>
<p>偶尔出现且无法还原不好排查，最好能找到规律。<br />如果是单个用户，是否是该用户电脑或系统等问题，最好在出问题的时候去用户电脑上排查下，找到和什么原因有关。<br />因为你们的电脑测试是没有问题的，只有这个用户有问题，感觉应该和这个用户的什么设置有关，建议出问题的时候去用户那里排查下。</p>
<p>都是一台电脑一台打印机，用虚拟打印机测试下，也可能和打印机有关。<br />不好排查，因为只有那个用户有问题，这边应该也没法还原问题。<br />只能出问题的时候你们去排查下。<br />都是同一台电脑，有时候能打印，有时候不能打印，不好排查。<br />出问题的时候去那台电脑上测试下。<br />出问题的时候，去那台电脑上排查下，是否是电脑卡了之类的，浏览器不响应之类的，导致怎么点都不打印。<br />无法还原问题，这边也没法排查，而且是偶尔出现，只能出问题的时候去查看下是什么情况。</p>
<p>&nbsp;</p>
<p>cnblog链接（带图示）:<a href="https://www.cnblogs.com/huaxie/p/10132472.html" target="_blank">LODOP、C-Lodop简短排查语句</a></p>
<p><a href="../blog_index.html">返回博文列表</a></p>
</div>
<div id="footer"><img src="../images/lodopfoot.png"></div>
</body>
</html>