<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>批量打印漏打</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}
.blue{color:#95bfc7;}
.blue2{color:blue;}
.gray{color:gray;background-color:#66ffcc;}

.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-批量打印漏打</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../mini_QAs.html"><div class="menuitem"><span style="color:#ff0099;">迷你一个问答</span></div></a> 
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>批量打印漏打</h1>
<span style="color:blue;font-weight:bold">判断print返回值</span><br>
<br>
1.用最新版http://www.c-lodop.com/download.html<br>
2.参考样例4http://www.c-lodop.com/demolist/PrintSample4.html<br>
直接判断print的返回值，判断是否加入了队列。<br>
<br>
如果是c-lodop批量打印，则需要LODOP.On_Return_Remain=true;将回调结果保留，c-lodop任务可通过TaskID区分。<br>
一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br>
<br>
通过TaskID可以知道哪个任务返回false，漏打哪个任务，可以再重打该任务。<br>
<br>
用最新版对比试试http://www.c-lodop.com/download.html<br>
参考样例4http://www.c-lodop.com/demolist/PrintSample4.html判断打印的返回值，设置如果漏打，重新打印该任务试试。<br>
<br>
<span style="color:blue;font-weight:bold">通过打印机队列排查</span><br>
<br>
用最新版试试http://www.c-lodop.com/download.html<br>
打印机脱机查看下打印机队列的任务数量是否正常<br>
<br>
如果队列里任务正常，用虚拟打印机测试下，队列和虚拟打印机个都正常，说明代码正常，进入队列后就开始排队了，打印机打印不出来，应该和打印机有关，重装打印机驱动试试。<br>
<br>
<span style="color:blue;font-weight:bold">通过c-lodop的日志功能排查</span><br>
<br>
安装最新版c-lodop试试http://www.c-lodop.com/download.html<br>
开启日志功能，查看下日志是否正常。<br>
日志功能，在端口设置界面的右键菜单里勾选 Run Logs<br>
日志存放目录：MountTaiSoftware/CLodop32/Logs，保留最新7天日志，每天不超过200k（约2千条）<br>
日志有对话REQUEST类和打印PRINTED类两类成功日志(暂无失败日志)，<br>
前者保存了请求目的、对方IP、对话协议、对话端口和对话时间;<br>
后者保存了打印机名、打印标题、打印任务页数、打印份数、打印时间；<br>
<br>
<span style="color:blue;font-weight:bold">漏打排查</span><br>
<br>
1.调试下JS，排查下代码，是否执行了足够数量的PRINT语句。<br>
2.用最新版试试http://www.c-lodop.com/download.html<br>
3.打印机脱机查看下打印机队列的任务数量是否正常<br>
4.判断print的返回值，参考样例4.http://www.c-lodop.com/demolist/PrintSample4.html，返回值判断的是是否加入队列<br>
5.安装最新版c-lodop试试http://www.c-lodop.com/download.html<br>
开启日志功能，查看下日志是否正常。<br>
日志功能，在端口设置界面的右键菜单里勾选 Run Logs<br>
日志存放目录：MountTaiSoftware/CLodop32/Logs，保留最新7天日志，每天不超过200k（约2千条）<br>
日志有对话REQUEST类和打印PRINTED类两类成功日志(暂无失败日志)，<br>
前者保存了请求目的、对方IP、对话协议、对话端口和对话时间;<br>
后者保存了打印机名、打印标题、打印任务页数、打印份数、打印时间；<br>
<br>
<span style="color:blue;font-weight:bold">批量打印超文本，中间空白</span><br>
<br>
如果是批量打印超文本，中间漏打的是空白，可以加延迟等方式试试，尽量多分一些任务试试。<br>
<br>
批量打印大量较大的图片，可以试试直接输出base64码方式，参考样例38，不要加img标签。<br>
批量点大量的超文本和图片，可能会有影响。尽量用add_print_text纯文本等进行设计，这种是lodop直接输出的，不需要经过浏览器解析。<br>
<br>
</div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->
</div><!--body结束-->
 </body>
</html>
