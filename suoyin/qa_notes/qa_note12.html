<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>【非常见问题杂笔记】写入excel系统找不到指定文件，打印乱码等</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-【非常见问题杂笔记】写入excel系统找不到指定文件，打印乱码等</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../qa_notes.html"><div class="menuitem"><span style="color:blue;">问答等记录笔记，具体问题</span></div></a>
</div>



        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【非常见问题杂笔记】写入excel系统找不到指定文件，打印乱码等</h1>
1.<span style="color:blue;font-weight:bold"> 写入excel系统找不到指定文件，不是所有的电脑都这样</span><br>
直接测试下样例12 http://www.c-lodop.com/demolist/PrintSample12.html<br>
<br>
在有问题的电脑上测试下样例12<br>
<br>
写入到其他盘试试，比如D盘。<br>
<br>
百度下 系统找不到指定文件<br>
试试网上的处理方法。<br>
<br>
只有这一个客户端这样，<br>
百度下 “系统找不到指定文件”，这个提示试试。<br>
<br>
可能和该操作系统有问题有关，<br>
百度下 “系统找不到指定文件”，这个提示试试。试试网上的解决方法。<br>
<br>
2.<span style="color:blue;font-weight:bold"> 原先设计好的能整体复制吗，想在右边再放一个</span><br>
选中所有打印项，按住ctrl拖动复制。<br>
<br>
按住shift可连选，也可以从左侧打印项列表按住shift连选。<br>
<br>
3.<span style="color:blue;font-weight:bold"> 程序里面如果说手动输入对应的打印机的网络名称，却会报打印机连接不上</span><br>
选择打印机，测试参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
<br>
用样例5,7获取到的值。<br>
获取的是本机windows打印机列表的打印机，如果是网络共享打印机等，获取的名称可能前面有前缀，用获取的名称。<br>
<br>
4.<span style="color:blue;font-weight:bold"> 广域网打印有时无响应，需要刷新下页面才能重新打印是什么问题</span><br>
可能有打印机更新，页面是否有提示，有打印机变动，需要刷新页面。<br>
<br>
访问下http://[C-Lodop服务所在主机ip或域名]:[C-Lodop端口]/c_aobridge<br>
访问下欢迎页面，是否打印的时候端桥有上线或下线，没有及时更新，选择的是否是该端桥和该端桥下正确的打印机。<br>
<br>
判断下返回值试试。<br>
可以直接在欢迎页面测试下试试。<br>
<br>
5.<span style="color:blue;font-weight:bold"> 安装云服务器工作模式，是不是意味着客户端不需要安装了？</span><br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
如果是第一种角色，客户端都要安装，不要勾选服务器端工作墨水。<br>
<br>
<span style="color:blue;font-weight:bold"> 使用了广域网AO打印的话，是不是就不支持打印设计了？</span><br>
只有第一种角色可以打印设计。需要是本地 c-lodop，不支持远程打印设计。<br>
<br>
6.<span style="color:blue;font-weight:bold"> LODOP能在线更新吗？</span><br>
参考lodopFunc.js里，里面有判断，安装版本小于判断版本会提示更新。<br>
<br>
需要自己替换放置的提示下载安装的文件成新的，并修改判断版本号，或用新的lodopFuncs.js<br>
<br>
7.<span style="color:blue;font-weight:bold">打印机已经设置取消彩色的，但是打印出来还是有彩色</span><br>
打印机的彩色属于打印机的功能，咨询下打印机客服试试 。<br>
<br>
lodop控制不了，咨询下打印机客服试试。<br>
或在打印机的首选项里修改。<br>
<br>
8.<span style="color:blue;font-weight:bold">表格不自动分页，打印项高度修改也无效</span><br>
 ADD_PRINT_TABLE不切行，是否有超大行。<br>
用ADD_PRINT_HTM试试<br>
<br>
或修改样式，不要在超大行处分页。<br>
拆分表头部分，设置为页眉页脚项，每页输出。<br>
<br>
调小打印项高度，<br>
调小打印项高度试试，会按照打印项高度自动分页。纸张下方留出些距离。<br>
高度设置具体值，缩小打印项高度，会按照打印项高度自动分页。<br>
<br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
进入打印设计，选中超文本打印项，右键属性里拷出来的超文本代码发过来这边测试下。<br>
<br>
有嵌套表格，只输出一个表格。<br>
去掉外层的table就能自动分页了。<br>
<br>
嵌套了table，整个table在大table的td里 ，去掉 外面的大table就可以自动分页了 。<br>
<br>
9.<span style="color:blue;font-weight:bold">一种标签打印机上可以分别打印两种不同的样式吗</span><br>
可以，分成两个任务，每个任务不互相影响。<br>
<br>
LODOP.PRINT_INIT("打印任务名");               //首先一个初始化语句 <br>
LODOP.ADD_PRINT_TEXT(0,0,100,20,"文本内容一");//然后多个ADD语句及SET语句 <br>
LODOP.PRINT();                               //最后一个打印(或预览、维护、设计)语句<br>
从初始化到打印是一个任务，两种样式模版分成两个任务。<br>
<br>
可以多个任务，就是多次输出。<br>
每个任务都可以设置自己的纸张和打印项等。  <br>         
<br>
批量打印，分页分任务，在页数和任务之间平衡一下，参考样例26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
<br>
10.<span style="color:blue;font-weight:bold">分页打印设置页尾的时候top该怎么设置，不知道纸张高度</span><br>
是想内容在页面最下方输出吗<br>
参考样例6，的这个页码，固定了下边距和右边距<br>
http://www.c-lodop.com/demolist/PrintSample6.html<br>
<br>
INITA三四参数，这个是打印设计的可视化编辑区域大小，和纸张无关。<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
PRINT_INITA前两个参数是整体是整体偏移，后两个参数和输出无关。是打印设计的可视化编辑区域大小。<br>
<br>
11.<span style="color:blue;font-weight:bold">纯文本不预览直接打印不切纸，可以设置这个来切纸吗？(设置一个不定高纸张）</span><br>
切纸是打印机的功能，lodop无法控制，需要实际测试下，是按照任务切纸还是页数切纸。<br>
<br>
这个是纸张高度不定，预览查看下效果，预览纸张是否正常。<br>
<br>
设置该语句后预览打印是正常的吗，还是不正常<br>
<br>
设置后是正常的，可以用设置后的。<br>
<br>
需要实际测试，只要打印机支持这个纸张就行。<br>
设置后该打印机预览和直接打印都是正常的，说明支持这个纸张。<br>
<br>
需要实际测试下，有的打印机不支持自定义纸张<br>
<br>
一些优先级，参考http://www.c-lodop.com/blogs/Blog002.html<br>
不设置纸张，会根据优先级走。<br>
<br>
12.<span style="color:blue;font-weight:bold">内容过长，超出部分不换行直接不显示怎么办？</span><br>
打印项是什么语句输出的，是add_print_text纯文本，还是add_print_htm超文本<br>
<br>
如果是纯文本，参考http://www.c-lodop.com/faq/pp12.html<br>
设置高度较小，超过宽度会隐藏。<br>
<br>
如果是超文本，参考样例2http://www.c-lodop.com/demolist/PrintSample2.html<br>
表单一的最后一行的第一个单元格，设置css样式超出隐藏。<br>
<br>
如果想换行显示，用css样式控制，加载css样式，参考样例10 http://www.c-lodop.com/demolist/PrintSample10.html<br>
<br>
13.<span style="color:blue;font-weight:bold">预览打印是正常的，但是打印出来自动带了一串乱码出来</span><br>
用虚拟打印机 直接打印测试下。<br>
<br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
用直接打印预览输出，选择这个虚拟点击，prirntA或print测试下。<br>
<br>
选择这个虚拟打印机，直接打印输出。查看虚拟打印机直接打印的效果。<br>
预览打印正常，直接打印有问题，一般和注册语句无效有关，并排查：<br>
参考排查一下http://www.c-lodop.com/faq/ph01.html<br>
<br>
之前的状况是预览打印出来是正常的吗，还是预览正常，打印出来有乱码<br>
<br>
那么可以在预览选这个虚拟打印机，点打印输出测试下。<br>
<br>
真实打印机预览也正常，虚拟打印机直接打印也正常，实际打印不正常。<br>
真实打印机预览是打印机的反显，预览和实际打印存在差异，打印机驱动有关，重装打印机驱动试试，咨询下打印机客服。<br>
<br>
<span style="color:blue;font-weight:bold">偶尔出现，无法还原</span><br>
因为预览打印，也是不正常的，所以和水印无关。<br>
这个乱码可能是打印机输出的，用虚拟打印机多测试几次，如果虚拟打印机无法还原这个问题，可能和打印机或打印机驱动有关，重装打印机驱动试试。<br>
<br>
这个打印不正常，是指预览里点打印，还是用的直接打印PRINT或PRINTA<br>
<br>
预览里点打印，那么和水印无关，<br>
用虚拟打印机多测试几次，如果虚拟打印机无法还原这个问题，可能和打印机或打印机驱动有关，重装打印机驱动试试。<br>
<br>
14.<span style="color:blue;font-weight:bold">SET_PRINT_STYLEA('PRINT_INIT'整体偏移不起效果</span><br>
参考lodop技术手册PRINT_INITA，<br>
PRINT_INITA前两个个参数是整体偏移值。<br>
<br>
参考http://www.c-lodop.com/faq/pp17.html<br>
不建议直接在代码里设置具体的偏移值，可以用打印维护针对某台客户端进行偏移，结果在客户端本地。<br>
<br>
15.<span style="color:blue;font-weight:bold">为了解决客户没有安装打印控件问题，在程序中提供下载路径，是不是要压缩才行</span><br>
建议压缩，.exe文件可能会被浏览器拦截，下载.exe也可以。压缩成压缩包也可以。<br>
<br>
参考lodopFuncs.js里的写法，是个普通的a标签，也可以自己修改。<br>
查看这个路径是否正常<br>
<br>
16.<span style="color:blue;font-weight:bold">add_print_htm可以实现分页的表头和表尾吗？</span><br>
参考http://www.c-lodop.com/demolist/PrintSample43.html<br>
把表头表尾拆分出来，设置为页眉页脚项，每页固定位置输出。<br>
<br>
或参考样例30，手动分页，每页传入需要的表格数据，多个打印项，每个打印项都带着头尾。<br>
<br>
17.<span style="color:blue;font-weight:bold">并排标签，如果出现数量是奇数的时候，最后一张需要空白不打印</span><br>
lodop没有判断方法，或者判断奇数，先循环前面的偶数，最后一个任务单独输出。<br>
最后一个任务右侧是空白的，前面的任务都是一张纸两个标签。<br>
<br>
18.<span style="color:blue;font-weight:bold">lodopfuncs.js里的点这里再次启动没文件</span><br>
这个是启动的本机c-lodop，安装后点击可启动。<br>
这个不是文件，可以直接用JS自带的这个语句。点击这句可启动本地的c-lodop。<br>
<br>
19.<span style="color:blue;font-weight:bold">热敏打印很慢，5分钟才出票</span><br>
批量打印，分页分任务，在页数和任务之间平衡一下，参考样例26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
<br>
或改用纯文本输出，add_print_text等进行设计，这种不经过浏览器解析。<br>
<br>
20.<span style="color:blue;font-weight:bold">lodop能打印Bitmap吗？</span><br>
可以实际测试下。<br>
用该图片格式，参考样例测试8,http://www.c-lodop.com/demolist/PrintSample8.html<br>
Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。<br>
<br>
		   </div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
