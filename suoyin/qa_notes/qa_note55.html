<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>【非常见问题杂笔记】超宽不自动分页，表格次页空白覆盖等</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-【非常见问题杂笔记】超宽不自动分页，表格次页空白覆盖等</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../qa_notes2.html"><div class="menuitem"><span style="color:blue;">问答等记录笔记，具体问题</span></div></a>
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【非常见问题杂笔记】超宽不自动分页，表格次页空白覆盖等</h1>
1.<span style="color:blue;font-weight:bold">有没有可以自动分页的？就是打印的列格数据是不确定的</span><br>
是指表格的宽度吗，宽度超过纸张会显示不出来。<br>
设置内容宽度不要超出纸张，或宽度溢出缩放，参考样例42 http://www.c-lodop.com/demolist/PrintSample42.html<br>
<br>
如果是指超文本打印项的高度，会按照设置的打印项高度自动分页。<br>
<br>
可以按照打印项高度分页，如果行高是固定的，打印项在每页的高度是固定的，按照这个打印项高度分页。<br>
<br>
超文本超过设置的打印项高度就会自动分页，可通过调整超文本打印项的高度，控制当前页面输出的多少内容。<br>
<br>
或手动分页 参考样例30 http://www.c-lodop.com/demolist/PrintSample30.html<br>
拆分表格多个打印项，每页输出10行表格的打印项，每页内容可自己控制。<br>
<br>
2.<span style="color:blue;font-weight:bold">在代码里面访问https://localhost.lodop.net:8443/CLodopfuncs.js失败，把https://localhost.lodop.net:8443/地址贴到导航栏访问下，就能打印了</span><br>
访问https://localhost.lodop.net:8443/查看下证书报错的信息。<br>
<br>
用的是哪个浏览器，截图下提示，是360提示的吗,并用最新版测试下4104<br>
<br>
截图下提示，查看下证书信息。<br>
<br>
以管理员权限安装试试，右键以管理员权限安装。<br>
<br>
并查看下（图）<br>
证书路径是否正常：<br>
<br>
http的地址只能是用于http的网站。<br>
<br>
http://www.c-lodop.com/download.html<br>
发行包里clodop支持http或https。<br>
<br>
http和https引用地址不同。http直接用lodopFuncs.js默认地址就行。<br>
<br>
3.<span style="color:blue;font-weight:bold">判断当前是否安装了打印工具 是样例几？</span><br>
可参考lodopFuncs.js里已经写好的判断和提示。<br>
该js在下载中心发行包里。<br>
<br>
4.<span style="color:blue;font-weight:bold">批量打印 第二页重叠怎么处理</span><br>
是设置了强制分页吗<br>
NewPageA和NewPage使用特性区分，参考http://www.lodop.net/faq/pp19.html<br>
<br>
用NewPageA，上一页自动分页的不会和下一页重叠。<br>
<br>
是的，第二页是第一页内容自动分页的。<br>
或参考样例41，第二页打印项关联第一页的那个打印项，紧跟着它后面输出。<br>
<br>
超文本超过的打印项高度，或纸张高度，会自动分页。<br>
如果第一页还有剩余高度，调整打印项高度。<br>
<br>
add_print_table不切行，换成add_print_htm等测试下。<br>
<br>
可以设置次页偏移，超文本自动分页后，次页开始的位置不再是初始位置，而是偏移后的位置。<br>
例如：LODOP.SET_PRINT_STYLEA(0,"Offset2Top",-140);//设置次页向上偏移140<br>
<br>
次页偏移只影响该自动分页的打印项第二页开始偏移，第一页不会偏移。<br>
做个简单例子，发一下代码。<br>
<br>
空白页是全空白，没有任何内容吗。<br>
用xps或pdf虚拟打印机测试下，<br>
如果虚拟打印没有空白页，真实打印机和虚拟打印机预览对比下，可能是真实打印机纸张或可打区域等的问题。<br>
如果虚拟打印机也有空白页，给传入的整个超文本添加背景色，查看空白页中是否有背景色。<br>
<br>
是分页后下方剩余空白吗。<br>
参考样例41 http://www.c-lodop.com/demolist/PrintSample41.html<br>
第二个表关联第一个表。<br>
<br>
是第二页上方空白吗，设置次页偏移，负值试试。调整到合适的偏移值。<br>
<br>
用xps或pdf虚拟打印机测试下，<br>
如果虚拟打印机也有问题，做个简单例子发过来这边测试下。<br>
<br>
用xps或pdf虚拟打印机测试下，<br>
如果虚拟打印机也有问题，做个简单例子发过来这边测试下。<br>
<br>
这边测试下。是一个打印项自动分页，第二页需要次页偏移吗，如果是不同打印项，需要设置各自的top值。<br>
<br>
做个简单例子发过来，这边测试下，单独输出该表格打印项试试，是否是有其他打印项覆盖了<br>
<br>
5.<span style="color:blue;font-weight:bold">用了三个打印机打印，他自己老是从一个默认打印机全部打印出来，只有偶尔是这样的</span><br>
三个打印机是否是三个任务的。<br>
从init或inita初始化到打印是一个任务。<br>
每个任务都要指定打印机语句。<br>
<br>
6.<span style="color:blue;font-weight:bold">打印完后，电脑蓝屏或浏览器闪退，可能是什么原因</span><br>
电脑蓝屏等和电脑或操作系统有关，用其他电脑测试下。<br>
<br>
修复下电脑或操作系统等。<br>
<br>
7.<span style="color:blue;font-weight:bold">设置用默认打印机打印，但还是会打印到别的打印机上</span><br>
发一下打印机设置语句。<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample7.html<br>
是指定的-1打印机吗。测试下样例7。<br>
<br>
直接指定-1试试，<br>
没有问题，如果获取的默认打印机都死同一个，会在一个打印机上打印。<br>
<br>
测试下样例7试试，如果获取到的是不同打印机，或直接指定-1，或指定同一个名称。<br>
<br>
8.<span style="color:blue;font-weight:bold">打印出来的二维码不同内容的时候大小会变化，二维码大小怎么固定呢？</span><br>
参考http://www.c-lodop.com/faq/pp10.html<br>
二维码可以通过设置具体的QRCode版本，让不同数值的二维码统一大小。<br>
<br>
参考http://www.c-lodop.com/faq/pp10.html<br>
宽度跳跃式放大或缩小，是非线性，宽度不能微小的调整，因为受所有二维码竖横的合计值影响。<br>
<br>
进入打印设计，调整到合适的大小，<br>
宽度跳跃式放大或缩小，是非线性，宽度不能微小的调整，<br>
<br>
9.<span style="color:blue;font-weight:bold">打印出来的二维码不同内容的时候大小会变化，二维码大小怎么固定呢？</span><br>
参考样例45http://www.c-lodop.com/demolist/PrintSample45.html<br>
获取打印状态，需要实际测试下，不同打印机状态码可能不同。<br>
如果实际测试该打印机获取不到脱机状态，就是获取不到。<br>
<br>
参考样例45，右键查源码，c-lodop需要回调函数。<br>
<br>
c-lodop需要回调函数，参考c-lodop技术手册<br>
和一些含有回调函数的官网样例的源码，样例右键，查看源码，例如样例<br>35http://www.c-lodop.com/demolist/PrintSample35.html 样例4，样例35等<br>
<br>
10.<span style="color:blue;font-weight:bold">有些客户的打印机一直lodop打印有白色的断层的情况</span><br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
排查是否是打印机问题，虚拟打印机正常，和打印机有关。<br>
理论上本机虚拟打印没问题的话，说明插件代码没问题，程序可做的努力就的确很少了，毕竟windows下的打印是微软倡导的设备无关系原则，要在打印机和打印驱动程序 系统上排查下，尝试重装驱动 或者 打印机不支持一些功能 打印机精度太低。<br>
<br>
11.<span style="color:blue;font-weight:bold">批量打印  就是重复打印了</span><br>
1.用最新版测试下http://www.c-lodop.com/download.html<br>
2.调试JS，排查每个任务中数据是否正常。<br>
并排查份数是否正常，参考样例7，强制设置为一份试试。<br>
<br>
12.<span style="color:blue;font-weight:bold">拉两位公司技术入群</span><br>
好的，vip群可邀请加入，或输入验证问题申请加入。<br>
<br>
13.<span style="color:blue;font-weight:bold">8000端口被占用，能在引用的时候获取到打印机服务新的端口号吗？</span><br>
用最新版测试下http://www.c-lodop.com/download.html<br>
最新版是双端口，8000和18000一个能用就行。<br>
<br>
都占用，可以加备用端口<br>
参考http://www.c-lodop.com/faq/pp23.html<br>
参数Priority是服务优先级，数值越大优先级越高。设置低优先级的备用端口。<br>
<br>
14.<span style="color:blue;font-weight:bold">打印预览这个打印得属性可以隐藏吗，或者设置可以隐藏吗</span><br>
不支持单独隐藏这个属性按钮，可以隐藏打印按钮弹出的这个框。<br>
参考http://www.c-lodop.com/demolist/PrintSample16.html<br>
blDirectPrint： 打印按钮是否“直接打印” 1-是  0-否（弹出界面“选机打印”）<br>
<br>
15.<span style="color:blue;font-weight:bold">点打印提示选择需要登录的账户</span><br>
选择打印机，参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
打印机优先级，参考http://www.c-lodop.com/blogs/Blog002.html<br>
<br>
指定一个正常的打印机进行预览<br>
<br>
（此问题一般是选择了one note这个，）<br>
<br>
16.<span style="color:blue;font-weight:bold">AO打印，提示没有打印机</span><br>
访问下http://[C-Lodop服务所在主机ip或域名]:[C-Lodop端口]/c_aobridge 欢迎页面，查看下端桥是否在线，该端桥下打印机是列表是能正常获取到<br>
<br>
欢迎页面正常吗，选择该端桥下的一个打印机预览试试。<br>
云主机上是否有打印机存在，如果一个打印机也没有，安装一个虚拟打印机试试。<br>
没有打印机可能会影响本机windows打印服务。<br>
<br>
AO端桥模式，云主机上不需要打印，如果一个打印机也没有，安装个虚拟打印机。并查看云主机上系统打印服务(Print Spooler)是否开启了。<br>
<br>
欢迎页面正常，说明云主机和端桥都正常，对照欢迎页面排查下。<br>
<br>
实际业务中，选择端桥下的打印机。<br>
云主机安装时选择云服务器端工作模式，这个模式会禁用虚拟打印机。<br>
<br>
参考http://[C-Lodop服务所在主机ip或域名]:[C-Lodop端口]/c_aobridge<br>
指定下端桥。<br>
<br>
可以试试直接打印，在代码里指定端桥和打印机。<br>
实际应用中一般都是对SET_BRIDGE_INDEX参数赋具体<br>
<br>
http://[C-Lodop服务所在主机ip或域名]:[C-Lodop端口]/c_aobridge<br>
欢迎页面文本框里代码了里是直接打印的代码，这里改成打印预览测试下。<br>
<br>
是否有其他端桥，选择其他端桥测试下。<br>
<br>
或不预览，直接打印方式，欢迎页面的方式选择端桥，选择打印机，选择纸张。<br>
<br>
在这个端桥上安装其他打印机驱动试试，试试选择其他打印机。<br>
是否是该打印机或打印机驱动问题。<br>
<br>
这个是我的端桥，我的端桥连上了，下面的改成预览，预览下我的端桥下的打印机试试。<br>
<br>
这个是我这边的打印机。<br>
如果没有报错，应该是你另一个端桥或另一个端桥下打印机的问题。<br>
<br>
重装下有问题的该打印机的打印机驱动试试。<br>
<br>
如果只有那个打印机选择后有问题，就是和那个打印机有关。<br>
只能重装打印机驱动试试，或改成直接打印方式，不预览。<br>
<br>
17.<span style="color:blue;font-weight:bold"> 第一张图 是正常打出来的样张， 偶尔打出来出现下如第二张图那样 </span><br>
看上去字体字间距等有变化，是否是同一台电脑同一个打印机打印的<br>
<br>
如果打印的是超文本，Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。在样式有问题所在电脑上，尝试重置ie，升级ie，<br>
<br>
或改用纯文本设计，纯文本不受浏览器解析的影响。<br>
快递单，小票，标签，票据等，建议用ADD_PRINT_TEXT等纯文本和画线等进行设计，不受浏览器解析的影响。<br>
参考http://www.lodop.net/demolist/PrintSample4.html<br>
<br>
重置ie升级ie等试试。<br>
<br>
18.<span style="color:blue;font-weight:bold">多个标签，一张标签多个二维码</span><br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
一张纸上设置多个二维码打印项。<br>
二维码输出，样例11 http://www.c-lodop.com/demolist/PrintSample11.html<br>
<br>
并排多个标签，可以一排看做一张纸的尺寸。<br>
<br>
19.<span style="color:blue;font-weight:bold">有人用过react调用LODOP打印的经验？</span><br>
vue中使用Lodop，参考http://www.c-lodop.com/faq/pp35.html<br>
其他框架需要自己整合下，lodop用JS控制。<br>
<br>
20.<span style="color:blue;font-weight:bold">有没有办法将打印任务加入打印队列后先不打印，等待所有任务全部加入后才开始打印呢</span><br>
lodop没有控制方法，可以试试打印机脱机，或把打印机的usb连线拔掉。<br>
脱机会加入队列，但是不打印，一直在排队，等连上线取消脱机状态会再开始打印。<br>
<br>
或试试样例45的暂停打印，暂停打印，都加入队列后取消暂停。<br>
<br>
21.<span style="color:blue;font-weight:bold">调用完这个控件后，有清缓存的机制么？</span><br>
是指控件的缓存吗，打印完后自动释放缓存。<br>
如果打印的是超文本，Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。浏览器缓存可能存在不释放情况<br>
<br>
22.<span style="color:blue;font-weight:bold">请问打印这种需要怎么排版，条状（看起来是腕带）</span><br>
根据自己的需要设置纸张和打印项位置。<br>
进纸的时候是怎样进纸的，<br>
横向纵向 参考http://www.c-lodop.com/blogs/Blog010.html<br>
设置打印方向，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
<br>
二维码，参考样例11 http://www.c-lodop.com/demolist/PrintSample11.html<br>
<br>
旋转 参考http://www.c-lodop.com/faq/pp25.html<br>
<br>
旋转 参考http://www.c-lodop.com/faq/pp25.html<br>
可以单个打印项旋转，每个打印项设置不同的旋转方向和数值。<br>
<br>
参考lodop技术手册set_print_stylea篇第一个参数的解释。<br>
<br>
lodop技术手册下载地址：http://www.c-lodop.com/download.html<br>
<br>
23.<span style="color:blue;font-weight:bold">这个软件可以支持串口打印机打印吗</span><br>
是发送打印机原始指令吗，参考http://www.c-lodop.com/demolist/PrintSample17.html<br>
<br>
是已经安装打印机驱动到windows打印机列表了吗<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample17.html<br>
可以试试发送打印机指令<br>
<br>
指令也需要选择打印机，没有驱动可以试试发送端口数据。<br>
<br>
目前大部分都是usb接口的了，串口打印机咨询下打印机客服试试，是否该打印机也有驱动。<br>
<br>
24.<span style="color:blue;font-weight:bold">这个控件支持远程打印吗？</span><br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
后两种角色是打印到其他windows电脑上。<br>
<br>
25.<span style="color:blue;font-weight:bold">怎么定制lodop安装包？</span><br>
参考http://www.c-lodop.com/blogs/Blog006.html<br>
是定制安装程序的logo和名称吗，可在淘宝官方店下单，一次一千元。<br>
<br>
查了下加群的信息，加群用的邮箱是最近购买的公司名顶级注册。<br>
<br>
发一下logo图，这边定做后会发送到收注册号的邮箱里。<br>
如果有英文名，也发一下英文名，定做的在英文操作系统下显示的名称。<br>
没有英文名，可以用注册号里的翻译的英文名称，这个注册里的这名称<br>
<br>
参考http://www.c-lodop.com/blogs/Blog006.html<br>
大点也可以，这边会进行缩放。<br>
左上角显示公司名，中间显示logo图。<br>
<br>
发一下logo图，这边会定做后发到邮箱里。<br>
<br>
群里也有其他人注册公司名顶级，一般是在淘宝旺旺上联系。<br>
<br>
26.<span style="color:blue;font-weight:bold">提示储存空间不足，无法处理此命令</span><br>
双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启c-lodop后刷新页面再测试下。<br>
储存空间不足，清理下内存，浏览器缓存等再测试下。<br>
<br>
是指重启c-lodop正常吗，建议使用ADD_PRINT_TEXT等纯文本和画线进行设计，这种不受浏览器引擎解析的影响。<br>
参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
打印大量超文本浏览器可能存在缓存不释放等情况，可换用纯文本等进行设计。<br>
<br>
里面是否有图片等超文本内容。<br>
<br>
批量打印，分页分任务，在页数和任务之间平衡一下，参考样例<br>26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
是否单个任务打印量过大，分成多任务试试。<br>
<br>
用最新版c-lodop测试下。<br>
是否只有这一台电脑有问题，清理下电脑内存和浏览器缓存试试。<br>
<br>
27.<span style="color:blue;font-weight:bold">样例5如何控制纸张大小和连续打印 怎么实现控制纸张大小并且分页打印，按照样例5的方法，页面显示不整的内容丢失了</span><br>
打印项是什么语句输出的，是add_print_text纯文本，还是add_print_htm超文本<br>
<br>
分页 参考样例30 http://www.c-lodop.com/demolist/PrintSample30.html<br>
超文本超过设置的打印项高度或纸张会自动分页。<br>
减小打印项高度测试下。<br>
<br>
截图下预览效果。<br>
<br>
并用虚拟打印机测试下，win7以后系统自带Microsoft XPS Document Writer虚拟打印机 或者 下载安装群文件里的Doro PDF Writer虚拟打印机 用虚拟打印机测试下<br>
<br>
如果虚拟打印机也有问题，对照虚拟打印机和真实打印机预览，是否该打印机不支持自定义纸张或有可打区域影响了样式。
可打区域在预览里表现为虚线，超过可打区域的内容打印不出来。<br>
“可打区域”边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br>
http://www.c-lodop.com/faq/pp26.html<br>
<br>
28.<span style="color:blue;font-weight:bold">偶尔出现LOGO 打印不出来</span><br>
（1）查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
查看一下传入的图片路径是否正确，尽量用绝对路径地址，换个图片试试。<br>
（2）显示空白或者图片缺失等问题，加延迟试试：<br>
LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒<br>
（3）权限问题，图片显示叉号 说明服务端拒绝了 可能证书 session等问题，导致没有直接访问该图片的权限，有些需要验证之后才能访问图片。由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(cookies)<br>
（4）清空ie缓存 重置ie 后在ie中查看下。IE中的URL最大长度限制为2048字节。超过这个长度会不支持。<br>
（5） 查看服务器端错误日志排查下 。<br>
（6）做个简单的例子验证下，排除其他因素的干扰。Base64输出图片参考样例38。<br>
<br>
是否是样例38方式，不要加img标签，直接输出base64码，不经过浏览器解析。<br>
<br>
如果加了img标签，重置有问题的那台电脑的ie试试。<br>
如果是不加img标签方式，让该客户在样例38里测试下。用最新版c-lodop试试。<br>
<br>
如果只有该电脑有问题，在该有问题的电脑的样例38里测试下。<br>
<br>
在样例38里测试下该图片，不加img标签那种不经过浏览器解析。<br>
用最新版c-lodop测试下。<br>
测试下其他base64图片试试，或直接测试样例38里的图片试试。<br>
<br>
注意紧跟"/"之后的图片格式"jpg"很重要， 一定要与生成编码时的图片格式保持一致，<br>
格式是否正确。<br>
<br>
是否是透明图，加上白色背景试试。<br>
<br>
发一下原始图片，这边测试下。<br>
<br>
试试这个加了白色背景的。<br>
<br>
29.<span style="color:blue;font-weight:bold">有多页背景图，怎么加载呢</span><br>
分成多任务，每个任务输出一个背景。<br>
或一个任务用普通图片的输出方法，参考样例8，先输出图片，图片在下层。<br>
<br>
一个任务用普通图片的输出方法，参考样例8，先输出图片，图片在下层。<br>
一个任务可以输出多个普通图片。<br>
<br>
可以设置普通图片只预览不打印<br>
<br>
第二页加载第二个图片打印项。<br>
<br>
每页加载不同的图片打印项，用普通图片的输出方式，参考样例8.<br>
<br>
一个任务可以设置多个图片，用自己的图片路径。<br>
<br>
就是一个任务加多个图片打印项，先输出图片，图片会在下层，当做背景图，图片打印项设置为只预览不打印。<br>
<br>
（因为早上开着两个电子发票，所以打算先普通打字回复下，等会再仔细带代码的回复，结果发了这些后，这人说自己去试试。就没继续发，查找了下自己的单个问答里，之前其他人问题的时候总结了小问答，早知道就多点击找到复制下详细回答了，这样回复感觉不够详细，不过这人是私聊的，而且开完电子发票后没继续追问，说自己去试试，估计自己去根据样例研究去了）<br>
<br>
设置图片只预览不打印：<br>
LODOP.ADD_PRINT_IMAGE(10,10,300,160,"(图像1的超文本路径)");<br>
LODOP.SET_PRINT_STYLEA(0,"PreviewOnly",1);<br>
<br>
是手动分页吗，<br>
LODOP.ADD_PRINT_IMAGE(10,10,300,250,"&img src=\"http://www.c-lodop.com/demolist/PrintSample8.jpg\"/>");<br>
LODOP.NewPage();<br>
LODOP.ADD_PRINT_IMAGE(10,10,300,250,"&img src=\"http://www.c-lodop.com/demolist/PrintSample37.png\"/>");<br>
<br>
图片在每页纸张中的位置也是前两个参数控制，LODOP.ADD_PRINT_IMAGE(10,10,顶边距，左边距。<br>
<br>
30.<span style="color:blue;font-weight:bold">打印机指令输出有问题，打印不了</span><br>
这个是发送打印机指令吗，需要自己编写打印机指令。<br>
这种usb接口的一般都有打印机驱动，如果安装了打印机驱动，可以参考样例7选择该打印机，直接输出纯文本或超文本内容到打印机驱动，不用打印机的指令试试。<br>
<br>
那么就和打印机指令有关，咨询下打印机客服，发送原始指令试试。<br>
或用lodop语句输出试试，面单标签等，套打建议使用ADD_PRINT_TEXT等纯文本和画线进行设计，这种不受浏览器引擎解析的影响。<br>
参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
<br>
下面的，参考lodop技术手册set_print_stylea篇第一个参数的介绍。<br>
0代表紧跟着的前面的那个打印项。<br>
<br>
（这人htm效果不好，想用指令，这次这人打算试试纯文本画线输出。）<br>
<br>
31.<span style="color:blue;font-weight:bold">SET_PREVIEW_WINDOW这个函数，好像没起作用</span><br>
测试下样例16 http://www.c-lodop.com/demolist/PrintSample16.html<br>
<br>
c-lodop预览模式，参考http://www.c-lodop.com/faq/pp28.html<br>
双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启c-lodop后刷新页面。<br>
<br>
32.<span style="color:blue;font-weight:bold">打印突然出现乱码</span><br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
排查是代码问题还是打印机问题<br>
<br>
如果虚拟打印机正常，说明和打印机或打印机设置有关。<br>
如果虚拟打印机输出也有问题，和内容或代码有关。<br>
<br>
先确定是否和打印机或打印机驱动有关。<br>
如果虚拟打印机输出正常，重装打印驱动试试。<br>
<br>
先确定是否和打印机或打印机驱动有关。<br>
如果虚拟打印机输出正常，重装打印驱动试试。<br>
如果虚拟打印机输出也有问题，可排除打印机问题，可再排查内容代码等。<br>
<br>
33.<span style="color:blue;font-weight:bold">需求项目切换了服务器，购买的服务器绑定的会员能切换吗</span><br>
购买的是什么类型的注册号。<br>
如果是带请求号的那种后两种角色的c-lodop注册号，是绑定机器硬件的，更换机器需要重新注册。<br>
<br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
购买的是哪种类型的。<br>
<br>
（图示）<br>
如果是后两种角色的那种，更加云主机请求号生成的，是绑定机器硬件的。<br>
如果是第一种ip或域名注册，只要访问的还是该ip或该域名就行。<br>
<br>
（图示）<br>
购买到的是哪个类型的。如果是下面那种，是和机器硬件绑定的。<br>
<br>
您购买的是哪种，是下面的那种吗，是根据请求号生成的那种。<br>
根据云主机生成的请求号。<br>
<br>
发一下注册日期，和收注册号的邮箱，这边查一下试试。<br>
<br>
域名注册，验证的是浏览器地址栏的地址，只要还是访问那个地址就行。<br>
和服务器硬件无关。<br>
<br>
这边根据这个邮箱没有查到，注册日期大概是什么时候<br>
<br>
是访问地址更换了吗，只要还是原来的访问地址就行。<br>
浏览器地址栏输入的地址是注册的那个地址就行。<br>
如果换了访问方式，需要重新购买。<br>
<br>
（最后根据日期查了下，原来是邮箱字母大小写问题，注册的是ip注册，只要访问方式还是原来的就行。）<br>
<br>
34.<span style="color:blue;font-weight:bold">IE11 automation 服务器不能创建对像这个怎么处理</span><br>
具体是什么问题，获取不到lodop对象吗<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
如果样例正常，样例页面右键查看源码 ，参考样例的使用方法。<br>
<br>
如果是非lodop问题，百度下这个提示试试，automation 服务器不能创建对像<br>
<br>
35.<span style="color:blue;font-weight:bold">java打印 lodop 报错</span><br>
一些客户反馈的java调用方法，您参考摸索一下<br>
/**<br>
* Java调用lodop直接打印<br>
* 需要引入jacob-1.17.jar包。<br>
*<br>
* @author TonyTan<br>
* @version 1.0, 2017-3-9<br>
*/<br>
public class JavaLodop {<br>
<br>
public static void main(String[] args) {<br>
ActiveXComponent LODOP = new ActiveXComponent("Lodop.LodopX") ;<br>
Dispatch lodop = LODOP.getObject();<br>
Dispatch.call(lodop, "PRINT_INIT", "打印控件功能演示_Lodop功能_表单一");<br>
Dispatch.call(lodop, "ADD_PRINT_TEXT", 50,231,260,39,"打印页面部分内容");<br>
Dispatch.call(lodop, "PRINT");<br>
System.out.println("...................lodop="+lodop);<br>
}<br>
<br>
}<br>
CS架构的需要自己摸索一下，可参考下上面其他人反馈的方法。<br>
<br>
36.<span style="color:blue;font-weight:bold">如何打印在最右边呢</span><br>
发一下预览截图，是想打印项在最右边输出吗<br>
<br>
打印项的第二个参数是left左边距值，根据纸张大小设置合适的左边距值。<br>
<br>
（图）<br>
设置打印项右边距固定试试。<br>
<br>
LODOP.SET_PRINT_STYLEA(0,"Horient",1);<br>
参考http://www.c-lodop.com/demolist/PrintSample6.html<br>
和lodop技术手册SET_PRINT_STYLEA篇<br>
<br>
下边距和右边距的计算http://www.c-lodop.com/faq/pp13.html<br>
<br>
参考http://www.c-lodop.com/faq/pp10.html<br>
宽度跳跃式放大或缩小，是非线性，宽度不能微小的调整，因为受所有二维码竖横的合计值影响。<br>
<br>
在打印设计里拖动，或逐个调整数值，到合适的大小 。<br>
<br>
37.<span style="color:blue;font-weight:bold">同一个单子，内容有变更； 打印出来的页面还是老数据</span><br>
是超文本内容吗，清理下浏览器缓存试试。<br>
调试JS，排查传入打印项的参数值是否正常。<br>
<br>
传入什么打印什么，再调试JS排查下。传入的数值是否是新的数值，排查数据传输和赋值环节。<br>
<br>
38.<span style="color:blue;font-weight:bold">执行完  LODOP.NewPageA();   这个页码 能不能重新从 第一页开始计算
</span><br>
LODOP.SET_PRINT_STYLEA(0,"NumberStartPage",2);//设置从哪一页开始显示<br>
LODOP.SET_PRINT_STYLEA(0,"StartNumberValue",3);//设置页码从几开始显示<br>
<br>
如果前面的打印项自动分页，不确定前面的页数，不能知道从哪一页开始显示。<br>
<br>
或分成多任务输出，每个任务输出自己的页数。<br>
<br>
如果NewPageA();前面的打印项自动分页的页数是固定的知道的，可以用哪一页开始显示从几显示。<br>
如果NewPageA();前面的打印项自动分页的页数不固定，不能用这个设置。<br>
分成多任务输出，每个任务输出自己的页数。<br>
<br>
批量打印，参考样例26，<br>
不用NewPageA();，原来的该语句前后的打印项 前后分成两个任务，每个任务设置自己的页数。<br>
<br>
1，2，3    LODOP.NewPageA();   1，2，3  <br>
如果 LODOP.NewPageA(); 前面的页数固定，可以实现，如果自动分页不固定，不行。<br>
<br>
LODOP.NewPageA(); 前面的页数是否是固定的<br>
LODOP.SET_PRINT_STYLEA(0,"NumberStartPage",2);//设置从哪一页开始显示<br>
LODOP.SET_PRINT_STYLEA(0,"StartNumberValue",3);//设置页码从几开始显示<br>
这个需要知道第二套页码在哪一页显示，<br>
例如如果前面内容是3页，在第4页显示，如果前面内容4页，在第5页显示，如果前面打印项页数固定可以。<br>
<br>
39.<span style="color:blue;font-weight:bold">当是共享打印机的时候 LODOP.SET_PRINTER_INDEX()这个语句用不了，就没发把任务发给打印机</span><br>
测试下样例7,5，是否能获取到该共享打印机。<br>
直接测试样例试试，指定该共享打印机预览或打印，能获取到说明正常，或重装下共享打印机试试。<br>
<br>
用这个获取的共享打印机的序号或名称，打印预览或打印试试。<br>
<br>
说明可以正常打印。<br>
没发把任务发给打印机具体有什么现象。<br>
<br>
样例获取和指定正常，说明正常，对照样例代码排查下。<br>
<br>
可以用获取的，参考样例5,7，http://www.c-lodop.com/demolist/PrintSample5.html<br>
不建议写死，因为不同客户打印机不同。<br>
<br>
可以用获取的，参考样例5,7，http://www.c-lodop.com/demolist/PrintSample5.html<br>
（图）<br>
不建议写死，因为不同客户打印机不同。<br>
<br>
建议让客户自己选择打印机，<br>
共享打印机和本地打印机名称不同，共享打印机前面会有前缀。<br>
或都用本地打印机，会改成让客户获取打印机选择的方法等。<br>
<br>
需要和windows打印机列表的打印机名称一致，共享打印机带前缀的也要带。<br>
或用获取的名称，不写死，让客户选择。<br>
<br>
建议让客户选择这个获取的打印机，然后代码里指定每个任务选择这个打印机。<br>
<br>
选择后，每个任务都传入这个选择的变量值就行。<br>
用户只选择一次就行。<br>
<br>
或者试试指定-1打印机，把该打印机设置成默认打印机。<br>
无论共享还是本地的，不用在意名称前面的前缀了。<br>
<br>
1.用获取的打印机名称，让客户在页面选一次，所有任务指定这个打印机名称。<br>
获取的名称共享打印机带前缀，本地打印机是名称本身。<br>
2.试试指定-1打印机，把需要的该打印机设置成默认打印机，不用在意名称前面的前缀了。<br>
<br>
40.<span style="color:blue;font-weight:bold">内容 宽度怎么调节呀，右边还有内容被隐藏了 显示不出来</span><br>
“可打区域”边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br>
http://www.c-lodop.com/faq/pp26.html<br>
<br>
调整内容在可打区域范围内，或咨询打印机客服是否可调整可打区域，或换打印机。<br>
<br>
可打区域和打印机有关，http://www.c-lodop.com/faq/pp26.html<br>
lodop无法控制。<br>
<br>
41.<span style="color:blue;font-weight:bold">打印出现进度条</span><br>
出现进度条，打印过慢，可能和很多原因有关：打印内容或样式或图片等过多，有需要下载有脚步执行或本身网络慢；<br>
机器性能过低 系统ie有问题或缓存过多；或使用的是共享打印机。<br>
如果预览页数多，可以多分一些任务，太多不建议预览，建议直接打印，在任务和页数之间平衡一下，参考样例26 <br>
http://www.c-lodop.com/demolist/PrintSample26.html<br>
<br>
预览页数多，可以多分一些任务，太多不建议预览，建议直接打印<br>
<br>
平衡下分任务的数量。<br>
减少每个任务输出的页数，直到进度条不再显示。<br>
<br>
10页内容不多 ，是否不再出现进度条了。纯文本输出对比试试。<br>
快递单，小票，标签，票据等，建议用ADD_PRINT_TEXT等纯文本和画线等进行设计，不受浏览器解析的影响。<br>
参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
<br>
这种建议用ADD_PRINT_TEXT等纯文本和画线等进行设计，不受浏览器解析的影响。<br>
<br>
这种标签内容简单，所以可以用纯文本输出。<br>
<br>
是纯文本输出方式，10页应该是很快的。<br>
用其他打印机测试下，可以先打印机脱机，查看下任务进入队列的时间。<br>
<br>
如果预览页数多，可以多分一些任务，太多不建议预览，建议直接打印，在任务和页数之间平衡一下，参考样例26 <br>
http://www.c-lodop.com/demolist/PrintSample26.html<br>
<br>
分任务输出。<br>
用实际打印机驱动，打印机脱机查看下队列的速度。<br>
<br>
可以分成10页为一组试试。<br>
<br>
是分任务，从init或inita初始化到print打印是一个任务。<br>
<br>
一次只能预览一个任务，多任务直接打印输出。<br>
<br>
42.<span style="color:blue;font-weight:bold">这边的客户PC端是 乌托邦的操作系统，服务器是有linux，可以打印吗</span><br>
客户端是windows的吗，是linux的吗<br>
<br>
参考http://www.c-lodop.com/download.html<br>
下载linux版安装测试下。<br>
<br>
目前测试过这四个的一些版本，可以使用，用root权限安装测试下。<br>
<br>
43.<span style="color:blue;font-weight:bold">ocx的CLSID是多少吗</span><br>
是CS架构的吗<br>
<br>
注册表注册ocx文件试试。<br>
参考http://www.c-lodop.com/demolist/PrintSample1.html<br>
classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA"<br>
<br>
43.<span style="color:blue;font-weight:bold">newpage放到了初始化外面</span><br>
newpage是在任务内分页，参考样例30,26。<br>
从init或inita到print是一个任务。<br>
<br>
根据自己的需要设置，可以一个一个任务，也可以一个任务多页，或分组分任务。<br>
可实际测试下效果，打印机脱机，查看下任务进入队列的时间平衡下。<br>
<br>
44.<span style="color:blue;font-weight:bold">我安装了 还是提示这个web服务未安装或未启动</span><br>
Lodop页面总提示"未安装"或"请升级"的可能原因 参考http://www.c-lodop.com/faq/pp2.html<br>
<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
如果样例正常，样例页面右键查看源码 ，参考样例的使用方法。<br>
<br>
如果已经安装c-lodop,双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启后刷新页面。<br>
<br>
最新版可在下载中心下载http://www.c-lodop.com/download.html<br>
<br>
最新版发行包里的c-lodop支持https<br>
<br>
参考http://blog.sina.com.cn/s/blog_721e77e50102z33a.html<br>
安装最新版c-lodop的4101或之后的版本，并参考链接修改JS地址。<br>
4.101之后的https地址变了，参考链接。<br>
<br>
参考http://blog.sina.com.cn/s/blog_721e77e50102z33a.html<br>
4.101之后的https地址变了，参考链接。<br>
<br>
原来的：https://localhost:8443/CLodopfuncs.js<br>
改为：https://localhost.lodop.net:8443/CLodopfuncs.js<br>
<br>
安装后访问https://localhost.lodop.net:8443测试下。<br>
<br>
45.<span style="color:blue;font-weight:bold">直接使用ocx文件  会没有注册的情况</span><br>
是CS架构的吗，这种只能是公司名称注册。<br>
<br>
参考排查一下http://www.c-lodop.com/faq/ph01.html<br>
先确保该注册语句执行了，每个打印方法里都要执行。<br>
可以先做个简单例子测试下，<br>
例如：<br>
LODOP.PRINT_INIT("打印任务名"); <br>
LODOP.ADD_PRINT_TEXT(0,0,100,20,"文本内容一");<br>
LODOP.SET_LICENSES........<br>
LODOP.PRINT(); <br>
直接放到PRINT()语句前面测试下。<br>
<br>
公司名称注册是这个语句。<br>
注册的是否是公司名称的。<br>
<br>
CS的不用JS了之后，可以在打印方法里调用。<br>
例如：<br>
LODOP.PRINT_INIT("打印任务名"); <br>
LODOP.ADD_PRINT_TEXT(0,0,100,20,"文本内容一");<br>
LODOP.SET_LICENSES........<br>
LODOP.PRINT(); <br>
直接放到PRINT()语句前面测试下。<br>
<br>
只要每次打印方法里调用到就行。<br>
<br>
46.<span style="color:blue;font-weight:bold">能不能升级套餐</span><br>
购买的是什么类型的，如果是公司名高级，可补差价升级到公司名顶级。<br>
域名等是一次性注册，不支持补差价注册号升级。<br>
<br>
是c-lodop注册号吗，三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
后两种角色的那种吗，那种是绑定机器硬件的，换机器需要重新注册。<br>
<br>
换机器硬件，需要重新注册。<br>
这个是绑定机器硬件的。<br>
<br>
换云主机硬件只能重新注册，这个价格比较便宜，就是考虑到可能换机器的情况。<br>
<br>
没有优惠，按公司定价执行。<br>
<br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
<br>
后两种角色只能用c-lodop云注册号扩充访问端。<br>
<br>
域名是针对第一种角色的，客户端本地打印角色。参考http://www.c-lodop.com/demolist/t1.html<br>
<br>
47.<span style="color:blue;font-weight:bold">打印预览不出现文字的标签：&gt;button>&gt;span>XX&gt;/span>&gt;/button></span><br>
去掉span测试下。<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample10.html
用样例里的方法输出按钮上文字试试。&gt;input type="button" value="打印预览4(隐藏本按钮和表格第2列)"<br>
<br>
按钮上的文字，放到button的value里试试，<br>
<br>
去掉span标签测试下。<br>
<br>
排查下样式http://www.c-lodop.com/faq/pp8.html，通过删减或做简单例子排查，找到出问题的样式，修改样式。<br>
<br>
48.<span style="color:blue;font-weight:bold">https的服务，但是在浏览器经常会被拦截，证书不安全</span><br>
参考http://blog.sina.com.cn/s/blog_721e77e50102z33a.html<br>
安装最新版c-lodop的4101或之后的版本，并参考链接修改JS地址。<br>
<br>
用最新版4014就行，可在下载中心下载，下载中心发行包里的c-lodop是4104支持https的。<br>
<br>
预览显示的纸张问题 ，这个和纸张有关，<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。 选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
<br>
49.<span style="color:blue;font-weight:bold">当打印机不支持自定义纸张的时候 怎么设置</span><br>
如果实际测试该打印机不支持该设置的纸张，只能换用支持的纸张大小，或用打印机自带的纸张。<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
纸张的一些优先级 http://www.c-lodop.com/blogs/Blog002.html<br>
<br>
如果不支持，会用下面的优先级，如默认纸张。<br>
<br>
或参考样例5，设置纸张列表，让客户选择，如果设置的纸张预览显示不支持，可以选纸张名称。<br>
或参考样例7，允许在打印预览里重选纸张。<br>
<br>
如果代码里设置了纸张，还是会优先根据代码里的走。<br>
或代码里不设置纸张，打印初始化里设置任务名，在预览里选择纸张，根据任务名记忆。<br>
<br>
纸张参数是3，这个是纸张不定高，是否是小票打印机那种打印机。<br>
普通打印机一般不支持不定高纸张。<br>
<br>
如果不是小票那种，需要设置具体的纸张高度，打印机对最大纸张高度是有限制的。<br>
不定高的纸张只能用于那种小票打印机等特殊的打印机。<br>
<br>
或参考样例5,7，让客户选择下打印机。<br>
如果是A4打印机，纸张参数赋值A4纸张。<br>
如果小票打印机，再设置纸张不定高。<br>
<br>
纸张的支持和打印机有关。<br>
不支持设置的纸张，只能根据该打印机调整纸张。<br>
<br>
无法判断，在预览之前不能知道该打印机是否支持该纸张，只能实际测试。<br>
<br>
50.<span style="color:blue;font-weight:bold">如何同时复制多个元素</span><br>
ctrl 多个选中<br>
Shift 左侧打印项列表，连续一段选择<br>
ctrl+鼠标滑动拖拉选中区域内打印项<br>
按住alt+打印对象，左边打印项列表中鼠标拖动改变打印项的输出顺序<br>
ctrl + delete 删除<br>
ctrl + 方向键移动<br>
按住ctrl+打印对象，同时拖拉一个对象就复制了<br>
<br>
按住ctrl+选中多个打印对象，同时拖拉选中的对象就复制了<br>
<br>
51.<span style="color:blue;font-weight:bold">提示c-lodop未安装启动，1,2等一些文字</span><br>
http网站还是https的<br>
<br>
这个提示是自己的，提示显示的是未安装启动，是否和lodopFuncs.js里的判断一致，修改了提示内容。<br>
http网站还是https的。<br>
<br>
参考http://blog.sina.com.cn/s/blog_721e77e50102z33a.html<br>
安装最新版c-lodop的4101或之后的版本，并参考链接修改JS地址。<br>
<br>
4101之前和之后的https地址不同，参考链接。<br>
如果代码里写的是新地址，都升级到4101之后。<br>
<br>
52.<span style="color:blue;font-weight:bold">多页文档是什么意思，页眉是什么意思</span><br>
参考lodop技术手册里的解释<br>
lodop技术手册http://www.c-lodop.com/download.html<br>
多页文，参考样例6<br>
<br>
LODOP.SET_PRINT_STYLEA(0,"ItemType",1);//设置上面的为页眉页脚，每页固定位置输出<br>
http://www.c-lodop.com/demolist/PrintSample6.html<br>
里的自动居中的标题，被设置了页眉页脚，每页输出。<br>
<br>
</div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
