<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>【非常见问题杂笔记】本地远程纸张不同等</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-【非常见问题杂笔记】本地远程纸张不同等</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../qa_notes.html"><div class="menuitem"><span style="color:blue;">问答等记录笔记，具体问题</span></div></a>
</div>



        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【非常见问题杂笔记】本地远程纸张不同等</h1>
1.<span style="color:blue;font-weight:bold">本地打印没问题，项目打包后放到服务器，本地访问远程项目调打印时打印长度以驱动为主</span>
<br>
打印长度是指纸张设置吗<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。<br>
选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
<br>
<span style="color:blue;font-weight:bold">打印机不支持该自定义纸张为什么本地测试没问题</span>
<br>
和打印机有关。预览查看下效果。两个预览都截图下，打印机会按照纸张走纸。<br>
<br>
<span style="color:blue;font-weight:bold">两个预览是一样的，打印出来不同</span><br>
<br>
这个带水印，是不是直接打印的。<br>
前面那个不带水印，后面这个带水印。<br>
排查这两个是不是一个是预览输出的，一个是直接打印输出的。<br>
<br>
用虚拟打印机测试下。<br>
不注册，应该都会带水印。<br>
<br>
预览下方状态栏纸张如果是一致的，<br>
那么效果应该也是一致的，预览和打印不同，一般和打印机驱动有关。<br>
都预览打印测试下，第二个图有水印，不是预览输出的。<br>
<br>
和远程本地无关，都用这个打印机预览输出测试下。<br>
<br>
2.<span style="color:blue;font-weight:bold">打印机有的会不支持这种指令码？（设置纸张为A4）</span><br>
有可能，有的打印机不支持这个自定义纸张语句，或不支持这种纸张。<br>
<br>
需要实际测试下，一般普通打印机都支持A4纸张，都有这个纸张名称。<br>
可以测试下样例5,http://www.c-lodop.com/demolist/PrintSample5.html<br>
<br>
有些特殊的小票的打印机等可能不会支持，一般的能打A4的纸张的打印机，都会有这个纸张名称。支持这个尺寸。<br>
<br>
<span style="color:blue;font-weight:bold">预览纸张和方向正常，实际打印出来不对</span><br>
横向纵向 参考http://www.c-lodop.com/blogs/Blog010.html<br>
参考链接，这里的横向纵向是指内容的方向，不是纸张的。<br>
<br>
预览下方状态栏查看下纸张是否和实际纸张一致。<br>
<br>
进纸的时候方向是否正确，按照这个纸张进纸<br>
横向纵向 参考http://www.c-lodop.com/blogs/Blog010.html<br>
参考链接，这里的横向纵向是指内容的方向，不是纸张的<br>
<br>
参考链接 参考http://www.c-lodop.com/blogs/Blog010.html<br>
如果进纸的方向不同，就是不同纸张。<br>
<br>
没有办法获取进纸方向，只能根据进纸方向设置不同模版。<br>
<br>
这个和进纸方向方向有关，进纸不同，也要设置不同的纸张方向。<br>
A4和A4r就是两种不同的纸张。<br>
可以实际在该打印机上测试调试下。<br>
<br>
如果是正确的，预览正常，实际打印有问题，是用的该真实打印机预览的。<br>
预览和打印不一致，可能和打印机或打印机驱动有关。重装打印机驱动，咨询下打印机客服试试。<br>
<br>
3.<span style="color:blue;font-weight:bold">图片存在oss上，lodop能将oss上的图片装载成背景图吗</span><br>
是lodop的背景图吗，参考http://www.c-lodop.com/demolist/PrintSample9.html<br>
需要能在ie里直接访问到的图片地址，odop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。<br>
<br>
可加载web图片，步骤1的这个是加载的web的。<br>
LODOP.ADD_PRINT_SETUP_BKIMG("XX");<br>
参考样例9，需要ie能直接访问的地址<br>
<br>
4.<span style="color:blue;font-weight:bold">打印出的表格  左右上下 距离都有要求</span><br>
参考http://www.c-lodop.com/demolist/PrintSample34.html<br>
参考http://www.c-lodop.com/demolist/PrintSample46.html<br>
<br>
排查内容样式人，如果想缩放到一张纸里，参考样例42<br>
<br>
这个是打印项宽度，需要查看里面的内容的实际宽度。<br>
排查样式，查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
<br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
和内部样式有关。用css样式等控制。<br>
<br>
4.<span style="color:blue;font-weight:bold">LODOP.SET_LICENSES,在哪调用</span><br>
参考收注册号的邮件，<br>
可以用写在每个打印方法里，每次打印的时候都要执行，也可以放在链接里的LodopFuncs.js标注处，每次调用LODOP的时候统一调用。<br>
<br>
不是这个lodopFucns.js，下载中心综合版里的。<br>
这个只是适用于c-lodop自带例子的，<br>
<br>
5.<span style="color:blue;font-weight:bold">打印控件未安装提示。我已经在自己电脑上安装了打印控件。而且，如果以自己的电脑做服务器，是没有问题的。如果用远程服务器，就有问题。</span><br>
参考http://www.c-lodop.com/demolist/t1.html<br>
参考链接里的三种角色及使用方法。<br>
是指后两种角色吗<br>
<br>
如果是第一种角色，每个客户端都要安装。<br>
<br>
需要每个客户端都安装，参考官网样例的使用方法。<br>
<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
如果样例正常，样例页面右键查看源码 ，参考样例的使用方法。<br>
<br>
客户端本地打印角色，服务器端不用安装，最后访问的也是客户端本地的c-lodop。<br>
服务器端只需要引用lodopFucs.js。<br>
<br>
可以查看lodopfuncs.js，最后访问的是http://localhost:8000/CLodopFuncs.js<br>
是客户端本地的，每个客户端都要安装。服务器端只是提示客户下载安装。<br>
<br>
使用方法是否正确，客户端必须要安装。<br>
<br>
http://localhost:8000/CLodopFuncs.js<br>
这个地址只有客户端安装启动成功后才能访问到。<br>
<br>
能访问这个地址，那么安装启动正常的，排查下使用方法是否正确，样例正常，对照官网样例，右键查看源码，对比下。<br>
<br>
6.<span style="color:blue;font-weight:bold">表格超过纸张不分页，想固定表头</span><br>
用的是什么语句，是否是add_print_table<br>
<br>
这个语句不切行，前面有超大行，不切行，导致后面的无法显示。<br>
换用可以用 add_print_htm,输出试试<br>
<br>
用 add_print_htm输出，并调整打印项高度小于纸张。不要紧贴纸张下方输出。<br>
<br>
不切行，就是这个超大行超过纸张，不会分页。<br>
<br>
<span style="color:blue;font-weight:bold">add_print_htm  表头就没法固定了</span><br>
没有很好的方法，或者拆分表头，设置为页眉页脚项，每页输出，参考http://www.c-lodop.com/demolist/PrintSample43.html<br>
<br>
<span style="color:blue;font-weight:bold">拆分表头 下面内容和表头 就不好对齐</span><br>
没有很好的处理方法，或者自己处理下数据，进行手动分页，参考样例30.<br>
每页的数据不同打印项控制，每个打印项都带表头。<br>
<br>
           </div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
