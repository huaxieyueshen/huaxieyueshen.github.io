<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>【非常见问题杂笔记】[item]is invalid，次页向下偏移等</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-【非常见问题杂笔记】[item]is invalid，次页向下偏移等</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../qa_notes.html"><div class="menuitem"><span style="color:blue;">问答等记录笔记，具体问题</span></div></a>
</div>



        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【非常见问题杂笔记】[item]is invalid，次页向下偏移等</h1>
1.<span style="color:blue;font-weight:bold">[item]is invalid item class name</span><br>
参数错误，调试JS，找到把报错的位置，排查参数是否正确。<br>
找到这个错误的位置，修改下。<br>
<br>
项目类名本身不能包含item关键字。<br>
换掉名字，不能包含。<br>
建议更换，规定是不能包含item.<br>
<br>
打印设计里设置下试试，例如itemd，会提示the Item Name no permit including "ITEM"。<br>
<br>
2.<span style="color:blue;font-weight:bold">lodop 分页时候，怎么把第二页的头部高度设置高一些？</span><br>
是距离上面的顶边距吗，还是打印项的高度。<br>
<br>
如果是自动分页后的高度，设置次页偏移<br>
如果是第二页的的打印项，直接top值定位。<br>
参考样例39 http://www.c-lodop.com/demolist/PrintSample39.html<br>
LODOP.SET_PRINT_STYLEA(0,"Offset2Top",-140);//设置次页向上偏移140<br>
<br>
是第一页不显示吗，禁止输出到第一页。参考http://www.c-lodop.com/demolist/PrintSample25.html<br>
<br>
是否有打印项覆盖，第一页的其他打印项的top值和页眉的top值是一致的。<br>
给页眉留出高度试试。<br>
<br>
打印项位置重叠了。<br>
上方给页眉留够足够高度试试。<br>
参考样例39 http://www.c-lodop.com/demolist/PrintSample39.html<br>
LODOP.SET_PRINT_STYLEA(0,"Offset2Top",-140);//设置次页向上偏移140<br>
或次页下方的自动分页的向下偏移，给上面的页眉留高度。<br>
<br>
第一页页眉不显示，第二页开始显示。<br>
下面的自动分页的，第二页开始向下偏移，给上面的页眉留出距离。<br>
<br>
第二页是不是被覆盖了，设置了每页显示后会每页显示。<br>
第二页的下方的自动分页的次页向下偏移，上方留出足够的距离<br>
正值是向下偏移。<br>
次页偏移负值向上偏移，正值向下偏移。调整偏移值到合适的数值。<br>
<br>
3.<span style="color:blue;font-weight:bold">某个公司名注册号，可以使用web打印服务版本吗？</span><br>
参考http://www.c-lodop.com/demolist/t1.html<br>
参考链接里的三种角色及使用方法。<br>
c-lodop客户端本地模式，是作为客户端本地的服务，lodop注册号对这种c-lodop角色默认有效。<br>
<br>
参考http://www.c-lodop.com/faq/pp21.html<br>
高版本的火狐谷歌不再支持np插件，需要使用c-lodop，可参考官网样例混合部署http://www.c-lodop.com/LodopDemo.html<br>
Lodop控件升级到C-Lodop云打印 参考http://www.c-lodop.com/faq/pp7.html<br>
<br>
Lodop控件升级到C-Lodop云打印 参考http://www.c-lodop.com/faq/pp7.html<br>
升级到c-lodop方式，支持所有浏览器，lodop注册号对这种c-lodop角色默认有效。<br>
<br>
是什么时候注册的，发一下注册日期和收注册号的邮箱，这边查一下。<br>
只要不是很久之前的，是有效的。<br>
<br>
实际测试下试试，在使用c-lodop的时候，在print语句前面直接加上这个注册语句，直接测试下。<br>
可以用虚拟打印机测试，查看输出文件下方是否有水印输出。<br>
<br>
4.<span style="color:blue;font-weight:bold">这边打印时报错Cannot read property 'indexof' of ..某个JS文件</span><br>
排查代码，排查写法是否正确，里面的JS内容是否正确。<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
如果样例正常，样例页面右键查看源码 ，参考样例的使用方法。<br>
<br>
进入欢迎页面http://localhost:8000，点欢迎页面的预览试试<br>
并测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
<br>
说明安装启动正常，样例页面右键查看源码，对照样例的使用方法排查下。<br>
<br>
样例是在有问题的机器上测试的正常吗，说明c-lodop是正常的。对照样例排查下代码。<br>
根据报错的提示排查下报错的位置。排查下代码。<br>
排查报错位置的代码是否正常。<br>
<br>
5.<span style="color:blue;font-weight:bold">dd print url不能一次性打多个吗？需要实现点击一次，打印多个不同的报表。</span><br>
可以，参考http://www.c-lodop.com/demolist/PrintSample14.html<br>
一个任务可以输出多个打印项。<br>
<br>
参考 样例14的3.<br>
打印了两个url打印项。<br>
由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(Cookies)，所以需要安全验证的页面不要用URL方式打印，要用页面已经下载好的内容的HTM方式打印，也就是ADD_PRINT_HTM或ADD_PRINT_TABLE等语句<br>
另外URL方式需要二次访问服务器，理论上存在下载失败的可能，所以专业的管理系统尽量不要用URL方式。<br>
<br>
6.<span style="color:blue;font-weight:bold">找不到打印机，直接打印不行</span><br>
选择打印机，测试参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
<br>
测试下样例5的这个打印机列表http://www.c-lodop.com/demolist/PrintSample5.html<br>
<br>
测试下样例7，选择个具体的打印机进行预览和打印试试。<br>
<br>
选个其他打印机试试，<br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
指定1号打印机。<br>
<br>
理论上本机虚拟打印没问题的话，说明插件代码没问题，程序可做的努力就的确很少了，毕竟windows下的打印是微软倡导的设备无关系原则，要在打印机和打印驱动程序 系统上排查下，尝试重装驱动 或者 打印机不支持一些功能 打印机精度太低。<br>
重装那个0号打印机驱动试试。<br>
<br>
用的是样例7的临时默认打印机吗。<br>
换用样例5的那种打印机列表选择试试。<br>
<br>
用的是样例7的这个临时默认打印机方式吗，SELECT_PRINTER;弹出界面选打印机并返回其序号，序号从0开始,返回-1表示放弃
如果测试样例的临时默认打印机也有问题，换用样例5的那种打印机列表选择试试。<br>
那个0号打印机打印不了，1号的虚拟打印机可以，重装下0号的打印机驱动试试。<br>
<br>
换用样例5的那种打印机列表选择试试。<br>
<br>
临时默认打印机是临时的，临时指定后，页面的都用这个，直接指定打印机语句无效了<br>
刷新页面等会失效。<br>
用样例5的获取打印机列表方式对比试试，客户选择后，每个任务里都传这个打印机的参数。<br>
<br>
7.<span style="color:blue;font-weight:bold">，pdf的url是https协议的，打印预览是空白的，打印出来的也是空白没内容的</span><br>
参考欢迎页面的第三步，(例如Https方式)需先下载好再打印<br>
<br>
<span style="color:blue;font-weight:bold">文件的url和 页面访问地址保持不了同源策略，所以跨域下载不成功</span>
或转成base64码输出。需要打开本地的文件路径，转换该文件。<br>
或者让客户下载pdf到本地，用本地的文件路径。<br>
<br>
如果是https跨域等问题，没有很好的处理方法。<br>
或者想办法让客户下载到本地，<br>
用后两种方式输出。<br>
<br>
8.<span style="color:blue;font-weight:bold">添加了背景图 ，在打印设计中 无法预览出来</span><br>
参考http://www.c-lodop.com/demolist/PrintSample9.html<br>
<pre>LODOP.ADD_PRINT_SETUP_BKIMG("<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">img </span><span style="color: #ff0000;">border</span><span style="color: #0000ff;">='0' </span><span style="color: #ff0000;">src</span><span style="color: #0000ff;">='http://www.c-lodop.com/demolist/PrintSample9.jpg'</span><span style="color: #0000ff;">&gt;</span>");</pre>
试试这种带img标签的方式。路径在src里<br>
图片路径地址需要能在本机ie里正常访问到。<br>
<br>
9.<span style="color:blue;font-weight:bold">有的电脑打印不会，有的电脑会出现试用字样</span><br>
参考排查一下http://www.c-lodop.com/faq/ph01.html<br>
先确保该注册语句执行了，每个打印方法里都要执行。<br>
可以先做个简单例子测试下，<br>
例如：<br>
LODOP.PRINT_INIT("打印任务名"); <br>
LODOP.ADD_PRINT_TEXT(0,0,100,20,"文本内容一");<br>
LODOP.SET_LICENSES........<br>
LODOP.PRINT(); <br>
直接放到PRINT()语句前面测试下。<br>
个别电脑，排查，第七  客户端浏览器缓存(也就是浏览历史记录)在作祟,此时表现过个别电脑不行，其它电脑可以；<br>
<br>
注册语句是去掉直接打印水印的。<br>
是所有电脑直接打印都有水印吗，应该是注册号没生效，参考排查一下http://www.c-lodop.com/faq/ph01.html<br>
<br>
注册的是什类型的，如果是ip或域名，<br>
访问的是否是注册的ip或域名，<br>
（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下<br>
：http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。<br>
（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名： www.c-lodop.com 登陆方式如下<br>
：http://www.c-lodop.com/index.html等，ip地址访问时，注册信息无效<br>
<br>
其中一台会，是指其他电脑直接打印是可以的，只有一台电脑打印有水印吗。<br>
清理下浏览器缓存试试，做个简单例子用有水印的电脑测试下。<br>
<br>
10.<span style="color:blue;font-weight:bold">偶尔发生重打，不可复现问题</span><br>
重打问题吗，用最新版测试下。<br>
<br>
1.用最新版测试下。<br>
2、c-lodop端口界面，右键开启日志功能，根据日志排查下。<br>
<br>
以管理员权限重启下c-lodop试试，以管理员权限安装，以管理员权限启动。<br>
<br>
以管理员重启，用c-lodop进行打印，查看上述路径下。<br>
C盘根目录下的文件，可能是权限不足引起的。<br>
<br>
系统盘符:\Program Files (x86)\MountTaiSoftware\<br>
或系统盘符:\Program Files\MountTaiSoftware\<br>
<br>
这里下载中心综合版里面有lodop和c-lodop，这个日志是c-lodop的，确保当前使用的是c-lodop方式。<br>
<br>
C盘里带Program Files的文件下查看下。系统盘符:\Program Files (x86)\MountTaiSoftware\<br>
<br>
11.<span style="color:blue;font-weight:bold">左侧打印项列表，控件名字能固定么</span><br>
是指右侧的打印项列表的名字吗。<br>
<br>
是打印项序号，打印项类型，内容，组成的打印项列表。<br>
<br>
不支持，打印设计左侧的打印项列表是固定的，不能修改。<br>
<br>
不支持重命名，可以根据序号和打印项类型是Line区分试试，选中左侧打印项列表的某个线条，右侧的的打印项周围会出现蓝色圆点。<br><br>
打印设计是辅助设计的，没有很好的方法，只能根据序号和类型，和点击选中后再右侧查看，找到是哪个线条。<br>
<br>
如果是在代码里区分，可以用设置对象类名。通过类名给打印项加样式和数据。<br>
对象类名不会在打印设计左侧的打印项列表里体现，但是可以在代码里和右键属性里体现。<br>
<br>
选中打印项，右键属性里可以设置。然后生成代码，例如ADD_PRINT_TEXTA第一个参数是对象类名。<br>
<br>
SET_PRINT_STYLEA的第一个参数可以是序号，也可以是对象类名。<br>
样例26里有纯文本的对象类名。<br>
http://www.c-lodop.com/demolist/PrintSample26.html<br>
<br>
12.<span style="color:blue;font-weight:bold">Value为true , 是否代表10条数据都已经成功加入打印队列 ？</span><br>
参考样例4,35的写法，获取print的返回值。<br>
判断的是一个任务是否加入队列<br>
<br>
写法不对，参考样例的写法。<br>
pirnt在循环里，执行了10次，需要加需要LODOP.On_Return_Remain=true;将回调结果保留，c-lodop任务可通过TaskID区分。<br>
<br>
参考群文件里的一个文件，批量打印输出得到结果。<br>
执行了10次print，这是10个任务的。<br>
每个任务里也需要加初始化语句和的打印项<br>
<br>
可以根据taskid区分，是第几个任务。<br>
<br>
是想判断print的返回值，重打该任务吗<br>
返回为false的通过taskid确定是哪个任务，然后重打下那个任务。<br>
二次打印是指第二次批量打印吗。<br>
<br>
一般情况下不会漏打，用最新版测试下、<br>
<br>
为false的时候记录下taskid，之后进行重打。<br>
<br>
群文件里有个获取批量打印结果的，结果里的taskid可以区分是哪个任务，这个判断是否加入队列，是指一个任务的。<br>
<br>
根据taskid，把该taskid对应的任务再打一遍。<br>
<br>
数据是自己控制的，就是那个taskid对应的的打印项和内容，再执行一遍打印。<br>
<br>
两批数据，每个任务是不同的。<br>
这个是根据任务判断的，判断的是一个任务的返回值，与批次无关。<br>
<br>
这个判断的是某个任务是否加入队列，与打印批次无关。<br>
<br>
13.<span style="color:blue;font-weight:bold">分组后打印的页码可以拼接显示吗？</span><br>
lodop的页码是一个任务的，如果不能知道上一个任务自动分页几页，不支持多个任务用一套页码。<br>
如果知道上一个任务是几页，LODOP.SET_PRINT_STYLEA(0,"NumberStartPage",2);//设置从哪一页开始显示<br>
LODOP.SET_PRINT_STYLEA(0,"StartNumberValue",3);//设置页码从几开始显示<br>
<br>
分组如果是指多个任务的，<br>
第二个任务，如果之前前一个任务页数，可以第二个任务设置初始值。<br>
LODOP.SET_PRINT_STYLEA(0,"StartNumberValue",3);//设置页码从几开始显示<br>
如果不能知道前面任务的页数，不支持接着上一个任务的页数显示。<br>
<br>
或者分页到一个任务里，就是整个任务的页码。<br>
<br>
14.<span style="color:blue;font-weight:bold">这个安装文件exe升级包要放到那个目录下，才是有效的</span><br>
自己的目录下，是个普通的a标签，只要能正常访问到就行。<br>
<br>
可以修改路径地址，或放置文件子在默认的这个路径下。<br>
<br>
15.<span style="color:blue;font-weight:bold">一个url生成成二维码。如果长度大于44码就会变成小码</span><br>
参考http://www.c-lodop.com/faq/pp10.html<br>
二维码可以通过设置具体的QRCode版本，让不同数值的二维码统一大小。<br>
<br>
参考http://www.c-lodop.com/faq/pp10.html<br>
宽度跳跃式放大或缩小，是非线性，宽度不能微小的调整，因为受所有二维码竖横的合计值影响。<br>
<br>
进入打印设计，调整到合适的宽高试试，然后生成代码，蓝色圆点里的是的打印项宽高，最后宽高一般是小于这个值。<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
http://www.c-lodop.com/demolist/PrintSample11.html<br>
样例右键，查看源码<br>
LODOP.PRINT_DESIGN();<br>
<br>
16.<span style="color:blue;font-weight:bold">打印不了圆角怎么处理</span><br>
安装最新版c-lodop4088 http://www.c-lodop.com/download.html<br>
http://localhost:8000/c_pdfprint<br>
这个页面有例子<br>
LODOP.ADD_PRINT_SHAPE(2,31,28,519,546,3,2,"#0080FF");<br>
LODOP.SET_PRINT_STYLEA(0,"CornerRate",0.5);    //矩形框的拐角率<br>
<br>
17.<span style="color:blue;font-weight:bold">连续快速的执行LODOP.PRINT()，会出现数据丢失的情况</span><br>
用虚拟打印机测试下，是指内容不全吗，是否打印的是超文本内容。<br>
<br>
漏任务，参考样例4，35，判断print的返回值。<br>
如果是c-lodop批量打印，则需要LODOP.On_Return_Remain=true;将回调结果保留，c-lodop任务可通过TaskID区分。<br>
一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br>
<br>
18.<span style="color:blue;font-weight:bold">odop调用的时候会直接把打印机的服务关掉是为什么呢 </span><br>
lodop不会关闭打印机的服务，用虚拟打印机测试下，或其他打印机驱动测试下。<br>
<br>
如果虚拟打印机正常，其他打印机正常，只有这一台打印机有问题，重装该打印机驱动试试。<br>
或做个简单例子，或测试官网样例http://www.c-lodop.com/demolist/PrintSample7.html<br>
<br>
打印服务，是指系统打印服务(Print Spooler)吗<br>
<br>
用虚拟打印机测试下，http://www.c-lodop.com/demolist/PrintSample7.html<br>
如果虚拟打印机也是这样，百度下系统打印服务(Print Spooler)自动关闭的原因，试试网上的解决方法。<br>
<br>
测试下样例7试试，指定个具体的打印机，或用虚拟打印机测试下。<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
<br>
19.<span style="color:blue;font-weight:bold">lodop调用的时候会直接把打印机的服务关掉是为什么呢 </span><br>
内容是否是table输出的。<br>
不要紧贴纸张下方输出，纸张下方留出点距离试试。<br>
<br>
如果是add_print_htm输出table自动分页，自动分页后会补线。<br>
以用 add_print_htm, 切行时调整分页粒度TableRowThickNess，参考 样例30<br>
http://www.c-lodop.com/demolist/PrintSample30.html<br>
超文本超过打印项高度会自动分页，调整打印项高度到合适的值试试。<br>
<br>
20.<span style="color:blue;font-weight:bold">输出为pdf文件，可以不预览输出吗。 </span><br>
指定打印机，参考http://www.c-lodop.com/demolist/PrintSample7.html，指定该pdf虚拟打印机进行直接打印。<br>
<br>
21.<span style="color:blue;font-weight:bold">那个“TableRowThickNess”，满a4纸高度，请问是多少px？想弄成mm单位不行</span><br>
参考http://www.c-lodop.com/demolist/PrintSample29.html<br>
分页粒度单位是px，调整到合适的数值。默认单位是px，只要通过预览达到合适的效果就行。<br>
<br>
建议用默认的单位，px单位，技术手册是整数型，没有说字符型的。写法不加单位，直接是整数型数据。<br>
<br>
22.<span style="color:blue;font-weight:bold">有样式，打印时候这个没有生效</span><br>
排查是哪个样式没有生效，单独测试下该样式试试，如果不行，可换用其他样式实现。<br>
<br>
http://www.c-lodop.com/demolist/PrintSample3.html<br>
在样例3里测试下试试。这边测试行高样式是正常的。<br>
<br>
这边测试是正常的，排查下代码。<br>
<pre>  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p </span><span style="color: #ff0000;">align</span><span style="color: #0000ff;">="center"</span><span style="color: #ff0000;"> style</span><span style="color: #0000ff;">="line-height:50px;"</span><span style="color: #0000ff;">&gt;&lt;</span><span style="color: #800000;">font </span><span style="color: #ff0000;">face</span><span style="color: #0000ff;">="宋体"</span><span style="color: #ff0000;"> size</span><span style="color: #0000ff;">="3"</span><span style="color: #0000ff;">&gt;</span>科学家<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">&gt;</span>ddddd<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">font</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span></pre>
通过和简单例子对比试试，逐步删减样式，或简单例子添加样式排查下。<br>
<br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
进入打印设计，选中超文本打印项，右键属性里拷出来的超文本代码发过来这边测试下。<br>
<br>
样式里设置是p标签样式，实际html里没有p标签，是div和span样式组成的。<br>
<br>
里面是div和span标签，没有看到p标签。也可以直接在span里写样式。<br>
<br>
23.<span style="color:blue;font-weight:bold">打印预览的生成图片能不能提高清晰度，要通过打印预览生成的图片发给客户打印</span><br>
用什么语句输出的，<br>
如果用的是ADD_PRINT_HTML ，换成 ADD_PRINT_HTM试试。<br>
或让用户通过代码打印，不通过生成的图片打印。<br>
<br>
24.<span style="color:blue;font-weight:bold">table的THEAD 和 tfoot 在lodop中都没有起作用呢,每页都要用同样的表头该怎么处理了</span><br>
参考http://www.c-lodop.com/demolist/PrintSample15.html<br>
需要用样例的两个语句输出。<br>
<br>
ADD_PRINT_TABLE只能输出一个表格，<br>
拆分成多个打印项。<br>
或参考http://www.c-lodop.com/demolist/PrintSample43.html<br>
把每页输出的内容拆分出来，设置为页眉页脚项。<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample15.html<br>
thead和tfoot每页输出，只能是ADD_PRINT_TABLE或ADD_PRINT_TBURL这两个语句，且只能输出一个表格。<br>
<br>


		   </div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
