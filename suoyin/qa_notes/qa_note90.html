<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>【非常见问题杂笔记】共享打印机、Canvas报错、二维码大小不一致、超出纸张等</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-【非常见问题杂笔记】共享打印机、Canvas报错、二维码大小不一致、超出纸张等</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../qa_notes3.html"><div class="menuitem"><span style="color:blue;">问答等记录笔记，具体问题</span></div></a>
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【非常见问题杂笔记】共享打印机、Canvas报错、二维码大小不一致、超出纸张等</h1>
1.<span style="color:blue;font-weight:bold">提示Printer selected is not valid</span><br>
参考http://www.c-lodop.com/faq/pp1.html<br>
并用最新版对比试试http://www.c-lodop.com/download.html<br>
<br>
查看下windows打印机列表是否有打印机，是否指定了默认打印机，指定有效默认打印机试试。<br>
去掉纸张语句测试下，并排查下链接里的条目http://www.c-lodop.com/faq/pp1.html<br>
<br>
出现该问题后，测试下其他打印机试试，是否是和该打印机驱动有关<br>
<br>
出现该问题后，测试下其他打印机试试，排查是否和该打印机有关。<br>
<br>
排查下链接里的条目http://www.c-lodop.com/faq/pp1.html<br>
安装最新版，查看下windows打印机列表是否有打印机，是否指定了默认打印机，该电脑是否有共享打印机，删除共享打印机。<br>
<br>
用最新版4127试试，http://www.c-lodop.com/download.html<br>
并排查下链接里的条目http://www.c-lodop.com/faq/pp1.html<br>
<br>
2.<span style="color:blue;font-weight:bold">ADD_PRINT_BARCODE，第三个参数可以用百分比么</span><br>
可以<br>
<br>
参考http://www.c-lodop.com/faq/pp10.html 条码随着数值不同，宽度可能不同，无法做到完全统一大小，可估计最大宽度，最后的实际宽度一般是小于等于设定宽度。<br>
设置百分比后，也会是一般是小于等于设定百分比。 <br>
<br>
3.<span style="color:blue;font-weight:bold">LODOP.PREVIEW();突然预览不了</span><br>
查看下JS的报错信息<br>
<br>
访问http://localhost:8000欢迎页面试试<br>
<br>
测试下样例4http://www.c-lodop.com/demolist/PrintSample4.html<br>
点样例的预览或打印设计试试，查看是否有JS报错或提示<br>
<br>
c-lodop一次只能打开一个窗口，点一次。<br>
参考http://www.c-lodop.com/faq/pp27.html<br>
<br>
是否有共享打印机，目前发现共享打印机会导致一些问题，删除共享打印机后，再测试下<br>
<br>
删除掉共享打印机再测试下。<br>
目前发现共享打印机故障会导致一些问题。<br>
如果需要共享，可以删除测试成功后，再重新共享下。<br>
<br>
一次只能打开一个窗口，用的c-lodop版本是多少，用最新版4127对比试试http://www.c-lodop.com/download.html<br>
<br>
刷新页面再测试下样例，点预览或打印设计，是否能较快的弹出来<br>
<br>
如果有共享打印机，可以先删除掉共享打印机试试，直接用本地打印机预览。<br>
<br>
可能该共享打印机连接或出现故障。删除掉重新共享试试。<br>
<br>
(客户排查后反馈：把共享的设为默认打印机就会出现问题)<br>
<br>
4.<span style="color:blue;font-weight:bold">自动分页后，怎么在不提前预览的情况下获取，打印总页数</span><br>
不支持预览前获取任务页数<br>
打印预览或打印后可以获取，参考样例22，http://www.c-lodop.com/demolist/PrintSample22.html<br>
<br>
预览或打印后才能获取到<br>
当前页只有内嵌预览时样例22那种才能获取到<br>
<br>
用IE等支持插件方式的浏览器测试下样例22，<br>
内嵌预览显示时可以获取<br>
<br>
参考http://www.c-lodop.com/faq/pp21.html<br>
高版本的火狐谷歌不再支持np插件，需要使用c-lodop，可参考官网样例混合部署<br>http://www.c-lodop.com/LodopDemo.html<br>
Lodop控件升级到C-Lodop云打印 参考http://www.c-lodop.com/faq/pp7.html<br>
c-lodop不支持内嵌预览，只能预览或打印后获取<br>
<br>
5.<span style="color:blue;font-weight:bold">域名是网页的域名吧</span><br>
IP和域名注册，根据浏览器地址栏访问方式注册，P访问，注册IP；域名访问，注册域名；不限IP域名，可做企业名称注册。<br>
（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。<br>
（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名：  www.c-lodop.com  登陆方式如下： http://www.c-lodop.com/index.html 等，ip地址访问时，注册信息无效<br>
是的，访问网页浏览器地址里的地址<br>
<br>
注册顶级域名，支持二级域名<br>
<br>
6.<span style="color:blue;font-weight:bold">能同时支持 绑定内网和外网 ip吗</span><br>
支持，可购买两个ip,然后合成一个注册语句<br>
<br>
购买两个ip注册，可联系淘宝客服合并，或参考lodop技术手册，在注册语句里添加两个注册号，合并到一句里<br>
<br>
两个ip，是两个ip注册。<br>
<br>
7.<span style="color:blue;font-weight:bold">电脑安装IE最新版本，打印还是出现排版混乱问题</span><br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
分析差异点，因浏览器版本不同遵循的html标准不同，造成某些标签属性显示有差异，尽量避免使用有差异的属性，
（...小问答三段...)<br>
<br>
排查下样式http://www.c-lodop.com/faq/pp8.html，通过删减或做简单例子排查，找到出问题的样式，修改样式。
定位到是哪些样式受容器影响或哪些样式有问题，修改样式<br>
<br>
截图下正常和不正常的预览效果<br>
<br>
观察出问题的样式部分，排查样式，不同电脑可能调用的解析超文本ie引擎版本不同等。<br>
<br>
在有问题的机器上用xps或pdf虚拟打印机测试一下，查看下虚拟打印机的输出效果。<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机
看上去第一个图示里有乱码输出，且多个文字被乱码中间切开。<br>
如果该电脑虚拟打印机正常，重装该问题打印机的打印机驱动试试。<br>
<br>
（因提到排版问题，在无截图效果等情况下，猜测可能是指样式排版问题，发了照片看到应该是打印机驱动问题，连试用版输出水印都被乱码从中间切开了，还是要先虚拟打印机测试，排除下打印机问题。）<br>
<br>
8.<span style="color:blue;font-weight:bold">access error 你们的建议是如果打印的数据量很大，且电脑配置较低，这种情况建议安装LODOP最新版本（至少6.0.4.9之后） ，但最新版本是4.1.2.7</span><br>
6.多的那个是lodop版本，4127是c-lodop最新版本，<br>
<br>
以管理员运行下桌面上的c-lodop方式试试，排查是否是权限问题<br>
<br>
用最新版c-lodop就可以，排查下其他条目，最常见的是权限问题<br>
<br>
9.<span style="color:blue;font-weight:bold">判断返回值，返回全false，之前用window.print 不会出现这个问题</span><br>
测试下样例4http://www.c-lodop.com/demolist/PrintSample4.html<br>
Value是返回值，taskid是区分哪个任务的<br>
<br>
是批量打印吗<br>
<br>
如果是c-lodop批量打印，则需要LODOP.On_Return_Remain=true;将回调结果保留，c-lodop任务可通过TaskID区分。<br>
<br>
LODOP.On_Return_Remain=true;<br>
批量打印是否加了这句<br>
<br>
修改例子，改成输出单个纯文本测试下。并加上选择打印机语句，指定一个打印机<br>
可以打印机脱机用于测试<br>
<br>
参考c-lodop技术手册<br>
C-Lodop特有属性之一。让所设置的回调函数持续保留，对后面多个动作连续有效。<br>
<br>
通过taskid输出下返回值，查看是哪些任务返回false,哪些任务返回true<br>
<br>
LODOP.On_Return_Remain=true;<br>
批量打印需要加上这个，并通过taskid判断是那个任务出错<br>
<br>
调试下JS，排查是否执行了5次print<br>
<br>
(图）<br>
先测试下是哪些任务出现false<br>
<br>
本地测试也可以，做个本地的例子测试<br>
<br>
是偶尔出现吗，参考上面，判断是按个taskid的任务出现错误，重打该任务。<br>
用的c-lodop版本是多少，用最新版4127测试对比下<br>
<br>
参考上面，批量打印需要加 LODOP.On_Return_Remain=true<br>
然后通过taskid看下是哪个任务漏打了。<br>
并用4127测试下。<br>
<br>
安装最新版c-lodop试试http://www.c-lodop.com/download.html<br>
开启日志功能，查看下日志是否正常。<br>
日志功能，在端口设置界面的右键菜单里勾选 Run Logs
日志存放目录：MountTaiSoftware/CLodop32/Logs，保留最新7天日志，每天不超过200k（约2千条）<br>
日志有对话REQUEST类和打印PRINTED类两类成功日志(暂无失败日志)，<br>
前者保存了请求目的、对方IP、对话协议、对话端口和对话时间;<br>
后者保存了打印机名、打印标题、打印任务页数、打印份数、打印时间；<br>
并开启日志，对照日志查看下。<br>
<br>
10.<span style="color:blue;font-weight:bold">分页想让每页最后留点空白应该怎么操作</span><br>
调整打印项高度，根据打印项高度自动分页，减小打印项高度小于纸张。<br>
<br>
11.<span style="color:blue;font-weight:bold">操作失败，Canvas does not allow drawing</span><br>
打印项是什么语句输出的，是add_print_text纯文本，还是add_print_htm超文本，还是其他打印项<br>
<br>
输出的单个图片吗<br>
<br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机
如果虚拟打印机也有问题，发一下图片地址，这边测试下<br>
<br>
是只有这一个图片有问题吗，测试下样例8试试http://www.c-lodop.com/demolist/PrintSample8.html<br>
或测试下其他图片。<br>
如果只有这一个图片有问题，发一下该图片地址，这边测试下<br>
<br>
发一下报错的图片地址，这边测试下<br>
选择的好像是WPS的pdf虚拟打印机，并选择其他打印机测试下。<br>
<br>
发一下报错的图片地址，这边测试下，排查下是否和该图片有关<br>
是指昨天可以，今天报错吗，选择其他打印机测试下，排查是否是打印机不同的原因。<br>
<br>
用base64方式输出试试，lodop语句直接输出base64码，不带img标签，不经过浏览器解析，参考样例38<br>
http://www.c-lodop.com/demolist/PrintSample38.html<br>
<br>
(客户反馈，清理了下浏览器缓存，就不报错了）<br>
<br>
打印项是什么语句输出的，是add_print_text纯文本，还是add_print_htm超文本<br>
如果是超文本，可直接输出超文内容。<br>
如果是单独输出图片，可参考样例38，base64码直接输出<br>
<br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html
分析差异点，因浏览器版本不同遵循的html标准不同，造成某些标签属性显示有差异，尽量避免使用有差异的属性，可以在ie下不同版本仿真情况下验证差异<br>
排查样式，尽量使用使用各浏览器无歧义的通用的 html css js，不支持的样式可尝试用其他样式代替。<br>
尽量不用canvas，一些IE版本不支持。可换用图片或其他方式实现。<br>
<br>
可以用jpg,或png等各种浏览器网页支持的图片格式<br>
<br>
Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致，或尝试升级ie<br>
由于canvas不是所有的IE浏览器版本都支持，建议换用其他实现方式，<br>
<br>
（该客户用到的不是单独输出图片方式，输出的是canvas，虽然是超文本，但用的是add_print_image输出的，这个图片语句输出一个canvas,以后找机会测试下）<br>
<br>
12.<span style="color:blue;font-weight:bold">预览正常，打印不一致，两台电脑</span><br>
两台电脑进入lodop打印预览查看下效果，预览是打印机的反显，预览和打印效果应该是一致的，观察预览是否有放大或缩小现象。<br>
1.查看本机ie浏览器的缩放比例应在100%，<br>
2.操作系统控制面板设置显示应在100%。<br>
<br>
进入两个电脑的打印预览，预览下方状态栏查看下纸张大小和是否有虚线可打区域。<br>
打印项在纸张中居中，受容器的影响。<br>
<br>
（图）（图）<br>
可能和纸张高度有关，左侧的竖线可以看出两个的高度不同<br>
<br>
13.<span style="color:blue;font-weight:bold">ADD_PRINT_BARCODE 怎么设置成只显示条形码，隐藏下面的条码值</span><br>
参考样例11http://www.c-lodop.com/demolist/PrintSample11.html<br>
LODOP.SET_PRINT_STYLEA(0,"ShowBarText",0);//设置不显示下方的条码数值<br>
<br>
（图）<br>
可以设置底部条码的数字大小，字体粗细不支持<br>
<br>
（图）<br>
参考样例11http://www.c-lodop.com/demolist/PrintSample11.html<br>
LODOP.SET_PRINT_STYLEA(0,"AlignJustify",2);//设置条码下方的文字相对于条码本身居中<br>
字间距如果需要居中，可以居中样式，<br>
<br>
例如：<br>
LODOP.ADD_PRINT_BARCODE(88,32,206,78,"128B","123456789012");//设置条码位置、宽高、字体、值<br>
LODOP.SET_PRINT_STYLEA(0,"FontSize",18);//设置上面这个条码下方的文字字体大小<br>
<br>
（图）<br>
也可以打印设计后，生成代码<br>
<br>
14.<span style="color:blue;font-weight:bold">Error:Socket Error # 10053
Software caused connection abort.打印时，打印机这边爆出的</span><br>
访问http://localhost:8000欢迎页面试试<br>
<br>
选择打印机，参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机
并用虚拟打印机测试下，虚拟打印机和真实打印机对比下。<br>
<br>
批量打印过程中出现的吗，是否有规律。<br>
<br>
用xps或pdf虚拟打印机测试下，用其他打印机驱动测试下，可打印机脱机用来批量测试，观察打印机队列的状况<br>
<br>
读写端口，参考http://www.c-lodop.com/demolist/PrintSample17.html<br>
可以用端口调试工具等测试下连接是否正常，并排查参数是否正常。<br>
<br>
15.<span style="color:blue;font-weight:bold">lodop无预览的直接后台打印   怎么样设置彩色打印</span><br>
彩色打印是打印机的设置，咨询下打印机客服<br>
<br>
lodop不支持这个设置彩色，只能咨询下打印机客服，在打印机的首选项或其他地方设置。<br>
<br>
16.<span style="color:blue;font-weight:bold">判断print返回值，打印机根本没纸 好像也能成功</span><br>
直接判断print的返回值，加入队列算成功。<br>
<br>
参考样例35 http://www.c-lodop.com/demolist/PrintSample35.html<br>
样例45的13 http://www.c-lodop.com/demolist/PrintSample45.html<br>
样例35返回的“打印成功”实际仅是成功加入后台队列。<br>
样例45的13 判断“JOB不在队列”就足可认定已经打印成功。<br>
一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br>
如果想进一步判断，或参考样例45的13，判断job不在队列为成功。<br>
<br>
17.<span style="color:blue;font-weight:bold">LODOP.ADD_PRINT_BARCODE(165, 280, 100, 100, "QRCode", codeArr);两个浏览器执行同一段代码。chrome和IE11打印出来的二维码大小不一致</span><br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
参考http://www.c-lodop.com/faq/pp10.html<br>
二维码可以通过设置具体的QRCode版本，让不同数值的二维码统一大小。<br>
<br>
并查看是否参数一致，如果是数值不同引起的大小不同，可设置具体的版本，统一大小<br>
<br>
是否是同样的数值，设置了具体的版本号。<br>
如果上述的是相同的，<br>
IE和谷歌左上角的图标截图下，是否是一个浏览器图标，一个是小打印机图标<br>
<br>
一个走的是lodop插件方式，一个是c-lodop方式，发一下这个二维码语句，用具体的数值，和版本设置语句，这边测试下。<br>
用最新版的lodop和c-lodop试试<br>
或参考，单独c-lodop，http://www.c-lodop.com/faq/pp34.html<br>
让IE和谷歌都走c-lodop，修改lodopFuns.js里needclodop方法返回true<br>
<br>
发一下这个二维码语句，用具体的数值，和版本设置语句，这边测试下。<br>
或参考，单独c-lodop，让IE也走c-lodop，http://www.c-lodop.com/faq/pp34.html<br>
<br>
左上角是小打印机图标为当前走的c-lodop方式<br>
单独c-lodop，让IE也走c-lodop，http://www.c-lodop.com/faq/pp34.html<br>
修改lodopFuns.js里needclodop方法返回true<br>
<br>
http://www.c-lodop.com/faq/pp34.html<br>
修改lodopFuns.js里needclodop方法返回true<br>
其他的不用改<br>
<br>
在lodopFuncs.js里写好了获取c-lodop的方法<br>
<br>
并发一下这个二维码语句，二维码数值用具体的数值，和版本设置语句，这边也lodop和c-lodop测试下。<br>
<br>
测试参考一下官网样例http://www.c-lodop.com/LodopDemo.html<br>
官网样例是混合部署LodopFuncs.js里已经写好了判断。<br>
客户端是浏览器支持np插件，是32位浏览器，就会提示下载32位的Lodop插件：install_lodop32.exe<br>
客户端浏览器支持np插件，是64位浏览器，就会提示下载64位的Lodop插件：install_lodop64.exe<br>
客户端浏览器不支持np插件（判断如高版本谷歌火狐等），会提示下载C-Lodop方式： CLodop_Setup_for_Win32NT.exe<br>
如果是混合部署，和浏览器有关<br>
<br>
如果想单独用c-lodop，参考http://www.c-lodop.com/faq/pp34.html<br>
修改lodopFuns.js里needclodop方法返回true<br>
<br>
发一下那个二维码语句和设置的版本语句，用具体的参数值，做个简单例子发过来，这边测试下。<br>
这边测试简单的值没有发现明显的大小差异。<br>
<br>
二维码的数值也发一下，codeArr这个变量的值<br>
<br>
设置具体的版本，可以统一二维码大小<br>
<br>
（图）（图）<br>
这边测试没有明显的差异，用虚拟打印机lodop和c-lodop测试下，排查是否和打印机精度等有关，预览是打印机的反显<br>
<br>
需要设置具体的版本号，否则数值不同，二维码大小会不同，建议设置上。<br>
<br>
qq浏览器兼容模式走的ie内核，改成兼容模式<br>
<br>
预览界面右键显示标尺<br>
<br>
之前测试的代码吗，<br>
LODOP.ADD_PRINT_BARCODE(35,47,100,100,"QRCode","D1;1-WS21040700001;;7-15#PTJ92]0001#N006Z00M;60.000;210329;TG");<br>
LODOP.SET_PRINT_STYLEA(0,"QRCodeVersion",7);<br>
<br>
（图）（图）<br>
这边把变量提换成具体值，在qq的兼容和极速模式下测试的。lodop和c-lodop效果正常。<br>
<br>
18.<span style="color:blue;font-weight:bold">lodop.add_print_setup_bkimg这个怎么设置图片距顶部的高度</span><br>
参考http://www.c-lodop.com/demolist/PrintSample9.html<br>
用函数SET_SHOW_MODE的类型BKIMG_LEFT、BKIMG_TOP、BKIMG_WIDTH、BKIMG_HEIGHT可以设置背景图的位置和大小<br>
<br>
背景图默认是不输出的，根据的需要设置<br>
<br>
如果是指某台打印机整体偏移，建议用打印维护，针对客户端本地调整<br>
<br>
参考http://www.c-lodop.com/faq/pp17.html<br>
如果在原始代码里设置，可能会偏移。<br>
如果有的打印机挡板在初始位置，会偏移。<br>
<br>
建议用打印维护，针对客户端本机调整整体偏移<br>
这种调整只针对这个客户端，对其他客户端没有影响。<br>
如果代码里设置，对所有客户端都有影响。<br>
<br>
19.<span style="color:blue;font-weight:bold">下载最新版的lodop，lodopFuncs.js要怎么改</span><br>
http://www.c-lodop.com/download.html<br>
可在官网下载中心下载最新版，如果是http网站，可用发行包里的lodopFuncs.js<br>
<br>
http://www.c-lodop.com/download.html<br>
下载中心<br>
<br>
这个提示修改了，参考lodopFuncs.js，是新的提示<br>
修改提示下载安装文件路径改成自己的路径<br>
<br>
(图）<br>
新版本的这个提示部分也有，改成路径是自己放置文件的路径<br>
<br>
（图）<br>
双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启c-lodop后刷新页面。<br>
并查看启动的端口是否正常。<br>
<br>
如果是指一进入页面就打印，参考http://www.c-lodop.com/faq/pp3.html<br>
<br>
如果不是一进入页面就打印，LODOP = getLodop();写在打印方法里，<br>
如果是页面点击后打印，把获取LODOP对象放在打印按钮里触发。参考样例2<br>
http://www.c-lodop.com/demolist/PrintSample2.html<br>
<br>
参考http://www.c-lodop.com/faq/pp3.html<br>
如果是一进入页面就打印，加延迟或样例22等c-lodop准备好。<br>
如果是点击页面按钮打印，getlodop写在打印方法里，进入页面稍等一会再点打印。<br>
<br>
访问http://localhost:8000欢迎页面试试<br>
<br>
lodopFuncs.js里和欢迎页面访问的clodopFuncs.js的地址是一致的，<br>
测试下样例试试http://www.c-lodop.com/demolist/PrintSample2.html<br>
<br>
如果不是页面一加载就打印，写在打印方法里调用，<br>
或加延迟等方式<br>
<br>
参考lodop技术手册，打印初始化<br>
初始化到打印是一个任务<br>
<br>
初始化到预览也是一个任务。<br>
<br>
最基本的打印过程至少有初始化语句、添内容语句和打印语句三部分组成，例如：<br>
LODOP.PRINT_INIT("打印任务名");               //首先一个初始化语句 <br>
LODOP.ADD_PRINT_TEXT(0,0,100,20,"文本内容一");//然后多个ADD语句及SET语句 <br>
LODOP.PRINT();                               //最后<br>
<br>
参考样例2，右键查看源码http://www.c-lodop.com/demolist/PrintSample2.html<br>
<br>
20.<span style="color:blue;font-weight:bold">，如何设置等待选择打印机后再打印呢，不等待吗？，代码如LODOP.SELECT_PRINTER();LODOP.PRINT();</span><br>
去掉SELECT_PRINTER();这个临时默认打印机<br>
LODOP.PRINTA();直接打印前弹出打印机选择框<br>
<br>
21.<span style="color:blue;font-weight:bold">样例31，这个案例可以改成每页都有一个标题么</span><br>
参考样例43等，http://www.c-lodop.com/demolist/PrintSample43.html<br>
需要每页输出的打印项设置为页眉页脚项<br>
LODOP.SET_PRINT_STYLEA(0,"ItemType",1);//设置上面的为页眉页脚，每页固定位置输出<br>
<br>
可以把标题单独作为一个打印项输出，并把该打印项设置为页眉页脚项。<br>
<br>
22.<span style="color:blue;font-weight:bold">打印带电子签章的pdf，直接打印不预览。虚拟打印机生成的pdf不带电子签章了</span><br>
一些有加密的电子签章的pdf目前不支持。<br>
<br>
23.<span style="color:blue;font-weight:bold">买了按IP注册的打印控件，注册的ip是XXX，那么该ip下的两个网页XXX/index.php，XXX/download.php，都可以使用这个控件进行打印吗？</span><br>
可以，只要是访问的是注册的ip就行，和后面的端口或页面无关<br>
<br>
与网络无关<br>
<br>
24.<span style="color:blue;font-weight:bold">发送指令端口，可以设置纸张大小吗</span><br>
读写端口和打印机指令等，具体指令可咨询下打印机客服。<br>
<br>
25.<span style="color:blue;font-weight:bold">如何输出清晰图片那种，怎样把图片位置随着单元格尺寸的变化而变化？</span><br>
没有很好的处理方法，如何输出清晰图片 参考http://www.c-lodop.com/faq/pp14.html<br>
如果是超文本内的图片，尽量用高精度的打印机。<br>
<br>
26.<span style="color:blue;font-weight:bold">套打的东西出来有很大偏差，有些a3有些a4</span><br>
如果是整体偏移，参考http://www.c-lodop.com/faq/pp17.html<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。 选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
<br>
（图）<br>
如果测试1自定义纸张该打印机没生效，或换成下面的纸张名称试试，如果打印机自带的纸张里有这个名称<br>
<br>
27.<span style="color:blue;font-weight:bold">图片有时候显示，有时候不显示</span><br>
1）查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
查看一下传入的图片路径是否正确<br>
（...迷你问答大段...）<br>
<br>
排查上面的条目<br>
如果不显示的图片有规律，某几个特定的图片不显示，排查下该图片路径是否正常<br>
如果是偶尔出现无规律，显示空白，给图片加延迟试试<br>
<br>
stylea第一个参数0代表紧跟着的的打印项<br>
批量打印大量图片，或用base64方式输出试试，lodop语句直接输出base64码，不带img标签，不经过浏览器解析，参考样例38
http://www.c-lodop.com/demolist/PrintSample38.html<br>
<br>
可以换成base64对比测试下，这种不经过浏览器解析，lodop直接输出。<br>
<br>
用lodop语句缩放图片，参考http://www.c-lodop.com/faq/pp14.html<br>
<br>
这个图片是二维码吗，或换成lodop语句输出二维码，参考样例11<br>
<br>
lodop语句输出二维码，参考样例11 http://www.c-lodop.com/demolist/PrintSample11.html<br>
参考http://www.c-lodop.com/faq/pp10.html<br>
二维码可以通过设置具体的QRCode版本，让不同数值的二维码统一大小。<br>
<br>
28.<span style="color:blue;font-weight:bold">安装lodop之后影响了别的打印机</span><br>
发一下具体的现象，lodop不会影响打印机<br>
<br>
另一个打印机不行了，是指lodop无法调用吗<br>
测试下样例5、7试试，用该打印机点预览试试<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
<br>
（图）<br>
测试样例5,7试试，如果能选到这个打印机，点预览试试，一般能预览就能打印<br>
<br>
可以混合部署，也可以单独使用c-lodop.<br>
混合部署：<br>
官网样例http://www.c-lodop.com/LodopDemo.html<br>
官网样例是混合部署LodopFuncs.js里已经写好了判断。<br>
客户端是浏览器支持np插件，是32位浏览器，就会提示下载32位的Lodop插件：install_lodop32.exe<br>
客户端浏览器支持np插件，是64位浏览器，就会提示下载64位的Lodop插件：install_lodop64.exe<br>
客户端浏览器不支持np插件（判断如高版本谷歌火狐等），会提示下载C-Lodop方式： CLodop_Setup_for_Win32NT.exe<br>
单独部署c-lodop:<br>
单独c-lodop，http://www.c-lodop.com/faq/pp34.html<br>
<br>
29.<span style="color:blue;font-weight:bold">想在表格线之间画一根线   有什么方法么    自己用定位在td里面写的在xp系统里面预览的时候显示不出</span><br>
加载css样式，参考样例10 http://www.c-lodop.com/demolist/PrintSample10.html<br>
单元格合并或其他样式等，可加载上样式<br>
<br>
点预览的放大试试，或用虚拟打印机直接输出试试<br>
<br>
可表格合并单元格等方式，增加表格的列数，然后合并一些单元格。<br>
<br>
30.<span style="color:blue;font-weight:bold">二级域名授权可以升级到一级域名授权么，还是说需要重新购买？</span><br>
需要重新购买<br>
<br>
域名是一次性注册，按照规定只能重新购买<br>
<br>
31.<span style="color:blue;font-weight:bold">分页的时候为什么打一整页，底部还是满满的</span><br>
LODOP.ADD_PRINT_HTM第四个参数是打印项高度，调整成具体的值测试下<br>
<br>
32.<span style="color:blue;font-weight:bold">lodop打印完成之后，需要不要清理缓存</span><br>
不需要，会自动释放缓存<br>
<br>
如果打印是超文本，浏览器解析引擎可能有缓存，如果批量打印大量内容，建议纯文本<br>
<br>
可尝试base64码输出，参考样例<br>
38http://www.c-lodop.com/demolist/PrintSample38.html<br>
直接输出base64位码，无需经过浏览器引擎解析。<br>
<br>
33.<span style="color:blue;font-weight:bold">打快递单，超出纸张</span><br>
用xps或pdf虚拟打印机测试对比下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
虚拟打印机支持自定义纸张的<br>
<br>
用xps或pdf虚拟打印机测试对比下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
内容超出纸张了，如果预览下方状态栏和实际纸张不一致，用虚拟打印机输出测试下。<br>
<br>
如果预览下方状态栏纸张和实际纸张一致，<br>
整页缩放，参考样例42 http://www.c-lodop.com/demolist/PrintSample42.html<br>
<br>
预览下方状态栏的纸张是否和实际纸张一致<br>
<br>
如果纸张正常，说明内容超出纸张了，且超出了可打区域<br>
“可打区域”边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br>
http://www.c-lodop.com/faq/pp26.html<br>
<br>
内容超出可打区域，可用虚拟打印机输出测试下，虚拟打印机无可打区域<br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
1 html内容可能有不可视内容 导致打印内容高度超过打印项高度 打印设计里调整下打印项高度<br>
（....多出空白页，迷你问答...)<br>
<br>
给传入的整个超文本添加背景色，看输出的空白页中是否有背景色。<br>
<br>
快递单，小票，标签，票据等，建议用ADD_PRINT_TEXT等纯文本和画线等进行设计，不受浏览器解析的影响。<br>
参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
<br>
可打区域和打印机有关，<br>
你可以用一个虚拟打印机测试对比下<br>
<br>
lodop没有模版，这面单的超文本是自己的内容，参考上面空白页的条目排查超文本内容<br>
<br>
参考上面空白页的条目排查超文本内容，给整个超文本加背景色查看下<br>
<br>
快递单，小票，标签，票据等，建议用ADD_PRINT_TEXT等纯文本和画线等进行设计，不受浏览器解析的影响。<br>
参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
建议换成纯文本和画线输出这种快递单，纯文本不会因为浏览器解析等样式差异，不会自动分页。<br>
<br>
34.<span style="color:blue;font-weight:bold">域名买的时候忘了买哪一个价格了</span><br>
是指忘了注册等级吗，发一下注册日期和收注册号的邮箱，或发一下域名，这边查一下。<br>
<br>
35.<span style="color:blue;font-weight:bold">设定好横向打印的内容之后，有什么简单的办法让他转个90度，变成纵向打印</span><br>
横向打印，纵向预览，参考样例16的E http://www.c-lodop.com/demolist/PrintSample16.html<br>
<br>
横向纵向 参考http://www.c-lodop.com/blogs/Blog010.html<br>
设置打印方向，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
横向打印，纵向预览，参考样例16的E http://www.c-lodop.com/demolist/PrintSample16.html<br>
如果是指代码设置横向后，后期需要预览调整方向，参考样例7的7，可重选的打印预览，设置允许重选方向。<br>
<br>
直接打印之后没有选项了，或参数设置变量，让客户设置横向还是纵向。<br>
<br>
会按照代码的方向，<br>
根据自己的需要，根据自己的模版和纸张设置合适的方向<br>
可以预览观察下效果<br>
<br>
横向纵向 参考http://www.c-lodop.com/blogs/Blog010.html<br>
这个方向是进纸方向吗，进纸方向是否正常<br>
<br>
参考http://www.c-lodop.com/blogs/Blog010.html<br>
设置合适的纸张，例如A4短边进纸和长边进纸是不同的纸张。<br>
<br>
36.<span style="color:blue;font-weight:bold">提示Printer selected is not valid</span><br>
参考http://www.c-lodop.com/faq/pp1.html<br>
<br>
参考http://www.c-lodop.com/faq/pp1.html<br>
系统打印服务(Print Spooler)是否开启。<br>
查看下windows打印机列表是否有打印机，是否指定了默认打印机，指定有效默认打印机试试。<br>
去掉set_print_pagesize语句对比试试。<br>
<br>
用的是哪种pdf虚拟打印机<br>
<br>
下载安装群文件里的Doro PDF Writer虚拟打印机，测试下这个pdf虚拟打印机<br>
<br>
导出pdf借助的是pdf虚拟打印机，lodop不支持直接导出pdf。<br>
安装群文件里的Doro PDF Writer虚拟打印机，测试下这个pdf虚拟打印机，排查是否是之前的虚拟打印机的问题。<br>
<br>
37.<span style="color:blue;font-weight:bold">域名注册后部分电脑打印仍有水印,现出现问题的电脑操作系统为win8，怀疑是否和操作系统有关</span><br>
参考排查一下http://www.c-lodop.com/faq/ph01.html<br>
先确保该注册语句执行了，每个打印方法里都要执行。<br>
可以先做个简单例子测试下，<br>
(...小问答大段...)<br>
<br>
和操作系统无关，逐条排查下，如果是单个电脑有问题，排查下里面个别电脑出现的条目<br>
<br>
38.<span style="color:blue;font-weight:bold">（图裂）这个版本安装界面在繁体下解决乱码问题不？我之前购买的“按域名顶级注册”，在繁体下安装会出现乱码</span><br>
用新版本测试下4127，http://www.c-lodop.com/download.html<br>
<br>
（搜索变更记录，找到可能有关的一条，但域名注册不会定制安装，所以应该不是这个问题，通用版安装乱码只能先用新版本测试下。）<br>
3.0.0.8<br>
修正：解决自定义安装程序的繁体名称乱码问题；<br>
<br>
39.<span style="color:blue;font-weight:bold">lodop支持打印gif吗</span><br>
参考样例8，样例38，正常网页中显示的图片格式可以支持<br>
如果是加img标签的，Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。<br>
<br>
40.<span style="color:blue;font-weight:bold">共享打印机  lodop找不到</span><br>
选择打印机，参考样例5、7 http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
打印机的一些优先级 http://www.c-lodop.com/blogs/Blog002.html<br>
测试一样例5,7，是否能获取到该打印机，获取的是安装到windows操作系统打印机列表的打印机。如果获取不到，重新共享试试。<br>
<br>
测试下样例5获取打印机列表，查看是否能获取到该打印机<br>
（图）<br>
并查看下windows打印机列表的打印机是否正常，如果是刚刚共享的，清理下浏览器缓存，重启下电脑等测试下。<br>
<br>
41.<span style="color:blue;font-weight:bold">pdf分页一起预览只有最后一个</span><br>
NewPageA和NewPage使用特性区分，参考http://www.lodop.net/faq/pp19.html<br>
<br>
用NewPageA分隔pdf打印项测试下<br>
<br>
42.<span style="color:blue;font-weight:bold">批量预览是应该怎么做</span><br>
一个预览一个任务，分页，参考样例30，一个任务里分页<br>
<br>
43.<span style="color:blue;font-weight:bold">可以打印pdf文件么</span><br>
官网下载中心，下载最新的C-lodop<br>
http://www.c-lodop.com/download.html<br>
安装后在欢迎页面末尾找“PDF打印”链接，或输入地址: <br>
http://localhost:8000/c_pdfprint<br>
<br>
不是顶级注册，会有个弹窗提示，点确定可预览或打印<br>
<br>
点确定或顶级注册。<br>
<br>
控件注册号 注意事项 最新价格表、购买方式和使用方法见(官网)：<br>
http://www.c-lodop.com/Lodop_Lic.html<br>
pdf打印去掉这个弹窗，需要顶级注册。域名顶级或公司名顶级。<br>
<br>
购买的是什么类型的注册。<br>
如果是ip或域名注册，是一次性注册，需要重新购买<br>
如果是公司名高级注册，可补差价升级到公司名顶级<br>
<br>
可以联系淘宝旺旺客服，提供之前的订单信息等，查到后，目前公司名顶级价格减去之前购买的价格，可补差价公司名高级升级到公司名顶级<br>
<br>
公司名高级有高级的功能，顶级注册是以前的无限注册，两种注册功效不同。<br>
<br>
之前的高级注册，对后续版本都有效，功能保证注册时的功能后续版本都有效<br>
<br>
高级注册和顶级注册区别不同，参考功能区别，还有些其他功能也在顶级注册里<br>
控件注册号 注意事项 最新价格表、购买方式和使用方法见(官网)：<br>
http://www.c-lodop.com/Lodop_Lic.html<br>
<br>
44.<span style="color:blue;font-weight:bold">字体挤到一起</span><br>
指定其他字体试试，如果是超文本，css样式设置下具体的字体，如果是中文字体，不要用中文字体的英文别名。<br>
用中文原本的名称，例如宋体等。<br>
<br>
一个ADD_PRINT_TEXT打印项设置一种字体大小。<br>
如果需要同一个打印项设置不同的字体大小，可拆成多个打印项<br>
<br>
不支持，和字体和文字本身有关，例如中文逗号和英文逗号所占空间不同。<br>
<br>
如果是字间距，可以设置整个纯文本打印项的字间距<br>
<br>
如果是纯文本，如下设置纯文本行间、距字间距。<br>
例如：<br>
LODOP.ADD_PRINT_TEXT(115,169,100,20,"新加文本2");<br>
LODOP.SET_PRINT_STYLEA(0,"LineSpacing",3);//设置行间距为3，也可以设置负值<br>
LODOP.SET_PRINT_STYLEA(0,"LetterSpacing",3);//设置字间距为3，也可以设置负值<br>
<br>
打印设计选中该纯文本打印项，右键属性里也可以设置，然后生成代码<br>
<br>
45.<span style="color:blue;font-weight:bold">winform程序，调用lodop去打印  打印机响应时间很不稳定</span><br>
打印项是什么语句输出的，是add_print_text纯文本，还是add_print_htm超文本<br>
如果是CS架构的，尽量用纯文本试试。<br>
或用xps或pdf虚拟打印机测试下，并排查是否和打印机有关<br>
<br>
纯文本和画线输出应该是比较快的，用xps或pdf虚拟打印机测试下，并排查是否和打印机有关<br>
<br>
纯文本和画线是比较快的，用虚拟打印机输出测试下，排查慢在哪个环节。<br>
<br>
不好判断，只能再观察排查下，慢的时候和快的时候有什么现象。<br>
清理下电脑内存等试试，用虚拟打印机输出测试下。<br>
<br>
46.<span style="color:blue;font-weight:bold">newpage在这种情况下面都不行，是不是不能用eval呢？</span><br>
eval里是否包含了初始化语句，一个任务只能初始化一次，分页语句在初始化和打印之间<br>
<br>
47.<span style="color:blue;font-weight:bold">打印维护模式弹窗大小怎么调</span><br>
不支持设置打印维护的弹窗大小，<br>
支持设置预览窗口的大小<br>
参考http://www.c-lodop.com/demolist/PrintSample16.html<br>
<br>
48.<span style="color:blue;font-weight:bold">这个群还可以拉人吗？有个技术想请教下问题</span><br>
参考http://www.c-lodop.com/about.html<br>
这个F群满了，可以加P群<br>
<br>
49.<span style="color:blue;font-weight:bold"> 打印调打印预览是那个方法？</span><br>
参考http://www.c-lodop.com/demolist/PrintSample2.html<br>
样例右键查看源码LODOP.PREVIEW();<br>
<br>
50.<span style="color:blue;font-weight:bold"> 虚拟打印机软件推荐一个</span><br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>

</div><!--main_middle结束-->
        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
