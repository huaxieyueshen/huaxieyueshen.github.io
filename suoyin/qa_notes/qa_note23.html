<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>【非常见问题杂笔记】add_print_table只能输出一个表格等</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-【非常见问题杂笔记】add_print_table只能输出一个表格等</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../qa_notes.html"><div class="menuitem"><span style="color:blue;">问答等记录笔记，具体问题</span></div></a>
</div>



        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【非常见问题杂笔记】add_print_table只能输出一个表格等</h1>
1.<span style="color:blue;font-weight:bold">表格合计怎样只在最后一页输出，只页头每页输出</span><br>
页尾不要放在tfoot里，会最后一页输出。<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample15.html<br>
thead和tfoot标签内，被当做页头页尾。<br>
如果只要页头每页输出，页尾的部分可以不放在tfoot里。<br>
<br>
2.<span style="color:blue;font-weight:bold">某内容怎样只在最后一页输出</span><br>
参考http://www.c-lodop.com/demolist/PrintSample41.html<br>
如果要紧跟着表格在后面，关联表格。<br>
<br>
如果指定在最后一页固定位置输出，参考http://www.c-lodop.com/demolist/PrintSample25.html<br>
<br>
3.<span style="color:blue;font-weight:bold">实际的打印和预览位置和虚拟不同</span><br>
参考http://www.lodop.net/faq/pp17.html<br>
用打印维护针对该客户端进行调整，调整结果在客户端本地，只针对该客户端有影响。<br>
<br>
用打印维护针对该客户端进行调整，调整结果在客户端本地，只针对该客户端有影响。<br>
其他客户端没有影响，是针对客户端调整的。<br>
<br>
虚拟打印机是无可打区域的，而且支持自定义纸张。<br>
真实打印机千差万别，可以用打印维护针对客户端本地调整，调整的结果不会影响其他客户端。<br>
<br>
参考http://www.c-lodop.com/faq/pp9.html<br>
是打印维护，维护在会在本地生成一个该任务名的配置文件，只针对该客户端有影响。<br>
<br>
每个客户端在自己的电脑本地维护。<br>
<br>
打印维护（PRINT_SETUP语句）打印维护。设置具体的任务名，点应用。<br>
<br>
如果是整体偏移，可以拖动这个纸钉，对内容会全部偏移。<br>
<br>
需要进入打印维护调整，设计和维护都可以拖动纸钉，上面这个是图是演示拖动纸钉。<br>
<br>
是虚拟打印机预览正常，真实打印机预览有问题，<br>
还是有偏移问题。<br>
<br>
打印维护结果不会影响其他用户，<br>
每个用户都是根据自己的打印机进行维护调整。<br>
<br>
让所有用户都偏移，可以直接调整代码。<br>
<br>
所以需要开放打印维护给客户端进行微调。<br>
<br>
单独设置一个按钮，设置该模版内容，设置具体的任务名，进行打印维护，维护一次后点应用，每次走这个任务都会是维护后的。<br>
<br>
如果是指一个客户端换了打印机，换了打印机需要针对该打印机重新调整。<br>
<br>
调整一次后，就每次都走这个调整后的了。<br>
<br>
对其他客户端没有影响，这个调整是在客户端本地的，只对这一台电脑有影响。<br>
<br>
4.<span style="color:blue;font-weight:bold">有没有水印的样例？</span><br>
参考样例37的打印预览2http://www.c-lodop.com/demolist/PrintSample37.html<br>
<br>
5.<span style="color:blue;font-weight:bold">代码可以关闭预览窗口吗</span><br>
参考http://www.c-lodop.com/demolist/PrintSample16.html<br>
没有关闭的代码方法。<br>
可以设置打印后自动关闭。<br>
LODOP.SET_PRINT_MODE("AUTO_CLOSE_PREWINDOW",1);//打印后自动关闭预览窗口<br>
<br>
6.<span style="color:blue;font-weight:bold">lodop如果多个版本，有没办法设置，不同的程序，用的不同的版本</span><br>
安装的时候会覆盖旧版本。<br>
尽量都用最新版，最新版一般都兼容之前的语句。<br>
<br>
7.<span style="color:blue;font-weight:bold">虚拟打印机不弹出保存框</span><br>
点确定后，正常虚拟打印机会弹出一个保存框。<br>
之前有个客户虚拟打印机也是不弹出保存框，反馈的是 是360安全卫士把spool drivers里的核心dll文件阻止了。<br>
排查该电脑操作系统和一些安全软件，是否是有限制。<br>
<br>
正常情况下虚拟打印机都会弹出保存框，和操作系统或一些电脑设置权限等有关。<br>
百度下虚拟打印机不弹出保存框试试。<br>
<br>
8.<span style="color:blue;font-weight:bold">多页，水印在二页输出了，只想在第一页输出</span><br>
去掉页眉页脚属性。<br>
LODOP.SET_PRINT_STYLEA(0,"ItemType",1);//设置上面的为页眉页脚，每页固定位置输出<br>
去掉这句。<br>
<br>
9.<span style="color:blue;font-weight:bold">打印维护下，我把条码位置移到了图片中红框中的位置， 当另一条数据 有5个打印任务的时候 前三个任务的条码位置是在我上一次在打印维护中应用的位置，后面两个任务的条码位置 就不是了。</span><br>
这个是根据任务名的，不同任务名不同模版缓存。<br>
<br>
这是三个任务模版是否相同，打印项个数相同。<br>
<br>
三个任务名是一样的吗，那么走的是同一个配置文件。<br>
发一下代码，三个任务名是否相同。<br>
<br>
这里面有分页，这三个任务是执行了三次初始化和print吗<br>
还是分了三页。<br>
<br>
如果是一个任务里的三页，参考样例26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
为每一个对象起个类名，可测试样例26的打印维护。<br>
<br>
那是一个任务里的分页，<br>
不是多任务。<br>
参考样例26，可以设置项目类名。<br>
<br>
维护多页的每个打印项。<br>
或参考样例26，每页同样模版，设置项目类名。<br>
<br>
模版的打印项需要固定。<br>
维护了5个打印项，就是5个打印项的。<br>
参考样例26，设置项目类名，维护单页的，就可以每页都同类目的维护了。<br>
<br>
10.<span style="color:blue;font-weight:bold">同一个打印，两台电脑打印预览效果不太一样</span><br>
（需要的效果是自定义纸张不生效的那种）<br>
<br>
预览下方状态栏，查看下纸张大小是否一致。<br>
<br>
两台电脑都用虚拟打印机测试下。<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。 选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
<br>
代码里的纸张语句是怎样设置的。<br>
<br>
纸张的一些优先级 http://www.c-lodop.com/blogs/Blog002.html<br>
如果不设置纸张，会根据优先级走。<br>
<br>
右侧的那个图走的是A4纸张尺寸，第一个图不是。<br>
右侧的图是A4纸张，纵向，设置该尺寸试试。<br>
<br>
右侧的图这个代码没生效，走的A4纵向默认纸张。<br>
纸张的一些优先级 http://www.c-lodop.com/blogs/Blog002.html<br>
<br>
LODOP.SET_PRINT_PAGESIZE(2,2200,3070, <br>
是需要右侧的效果吗，纸张语句换掉，纸张语句设置右侧的那个，A4纵向试试。<br>
<br>
显示的尺寸不同，左侧的是210X307.右侧的是A4尺寸。<br>
去掉纸张语句，或纸张语句换成A4尺寸。<br>
<br>
11.<span style="color:blue;font-weight:bold">需要连续批量打印多个表格，并且分页，每页都要有表头，可是打出来只能打第一个表格怎么办</span><br>
ADD_PRINT_TABLE只能输出一个表格。<br>
<br>
两个表格，分成两个表格打印项试试。<br>
<br>
这里面是一个table表格输出的吗，还是有嵌套表格。<br>
<br>
换成ADD_PRINT_HTM输出试试<br>
<br>
这些表格是在一个打印项里吗<br>
<br>
那个页头页尾的是一个table打印项自动分页的。<br>
这种情况是一个打印项里很多表格，每个表格本身自己带着头尾，直接用ADD_PRINT_HTM输出<br>
<br>
或者一个表格一个add_print_table打印项输出。<br>
如果有个table自动分页了，第二页会显示页头。<br>
<br>
或者多任务，一个任务一个单子，一个单子一个table，add_print_table打印项输出。<br>
<br>
拆分打印项，多个table，多个add_print_table打印项输出。<br>
ADD_PRINT_HTM一次输出多个表格，每页固定位输出的也可以设置页眉页脚项，参考样例43那种。<br>
或者多任务，一个任务一个单子，一个单子一个table，每个单子自己的table打印项自动分页，add_print_table打印项输出。<br>
<br>
add_print_table只能输出一个表格。<br>
修改内容样式，变成一个表格。<br>
或多次输出。<br>
或add_print_htm输出多个表格。<br>
<br>
是想多任务吗，多一个任务输出一个add_print_table。<br>
<br>
可以，多任务，不预览直接打印。<br>
会发送多个任务，效果和一次性打印一样。<br>
<br>
12.<span style="color:blue;font-weight:bold">虚拟打印机不弹出保存框</span><br>
不支持，这个是pdf打印机的功能，<br>
或百度下是否有不弹出这个保存框的pdf虚拟打印机。<br>
<br>
13.<span style="color:blue;font-weight:bold">内容左右有边距</span><br>
打印项是什么语句输出的，是add_print_text纯文本，还是add_print_htm超文本<br>
<br>
观察是否有缩放现象，这两个比例是否在100%<br>
1.查看本机ie浏览器的缩放比例应在100%，<br>
2.操作系统控制面板设置显示应在100%。<br>
<br>
打印项语句是怎样输出的，add_print_htm的参数。<br>
预览界面右键显示标尺，查看下左边距和顶边距是否一致。打印项宽度是否一致。<br>
<br>
14.<span style="color:blue;font-weight:bold">A用户操作，跑到B用户的屏端去了</span><br>	
三种角色及使用方法：<br>	
参考http://www.c-lodop.com/demolist/t1.html<br>	
是第一种角色吗<br>	
<br>	
第一种角色访问的是客户端本地的c-lodop，不会打印到其他电脑上。<br>	
测试下欢迎页面http://localhost:8000<br>	
测试官网样例5,7<br>	
http://www.c-lodop.com/demolist/PrintSample5.html<br>	
http://www.c-lodop.com/demolist/PrintSample7.html<br>	
安装最新版c-lodop时勾选仅本机模式试试。<br>	
<br>	
15.<span style="color:blue;font-weight:bold">纸张来源怎么获取</span><br>	
参考样例7 http://www.c-lodop.com/demolist/PrintSample7.html<br>
获取当前的纸盒参数，切换不同纸盒，获取下参数值。<br>
<br>
样例7可以获取默认的纸张来源。<br>
切换不同纸盒，获取数值。设置纸张来源，参考样例6 http://www.c-lodop.com/demolist/PrintSample6.html<br>
<br>
在打印机首选项里切换不同的默认纸盒测试下。<br>
<br>
在windows打印机列表的首选项里切换，获取的是当前的默认纸盒。<br>
获取的纸盒不是文字，是纸盒的数字，代表当前纸盒。<br>
<br>
16.<span style="color:blue;font-weight:bold">我超文本打印，生成的html是正常的怎么一预览就乱了，table单元格宽度不同</span><br>	
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>	
看上去是样式和容器有关，排查样式。<br>	
<br>	
看上去和样式有关，排查样式，修改样式。<br>	
加载css样式，参考样例10 http://www.c-lodop.com/demolist/PrintSample10.html<br>	
可试试给每个单元格控制下宽高等样式。<br>	
<br>	
排查样式是否受容器的影响。<br>
可以给每个td加宽高，宽高可以是具体值，也可以是百分比。<br>
并排查样式是否生效。<br>
<br>
17.<span style="color:blue;font-weight:bold">打印需要保留一份记录。代码能获取到已打印或待打印的图片之类的嘛</span><br>	
导出图片，参考http://www.c-lodop.com/demolist/PrintSample27.html<br>
借助pdf虚拟打印机，可以打印成pdf文件。<br>
<br>
lodop获取不到已打印或待打印内容。<br>
可以在JS里处理或判断下试试。<br>
<br>
18.<span style="color:blue;font-weight:bold">用了关联，表格居中显示，怎么办呢，设置左边距它下面表格就会偏移位置了</span><br>
一个内容关联别人后，其Top值不再是上边距，而是与被关联者的间隙距离,Left值也变为左边距相对偏离量。<br>
设置左边距后，下面的表格左边距都是0，和上面的表格位置不偏移。<br>
<br>
参考样例23 http://www.c-lodop.com/demolist/PrintSample23.html<br>
除了设置打印项居中，还要确保打印项内容相对于打印项宽度居中。<br>
<br>
19.<span style="color:blue;font-weight:bold">一执行getLODOP就报错</span><br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
如果样例正常，样例页面右键查看源码 ，参考样例的使用方法。<br>
<br>
分页语句需要在初始化之后，打印之前。<br>
<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
点样例的预览试试，是否正常。<br>
<br>
LODOP=getLodop(); <br>
如果样例正常，参考样例的源码，可以直接用这句。<br>
<br>
是BS架构的吗，BS架构和官网样例是一致的<br>
测试官网样例和自己代码是否用的是同一个浏览器。<br>
<br>
这些语句是自己写的吗 ，用默认的lodopFuncs.js测试下<br>
<br>
是用的默认的lodopFuncs.js吗，这边查看都是没有的。<br>
是否是自己加了判断windows位数的语句，<br>
<br>
http://www.mtsoftware.cn/download.html<br>
下载最新的lodopFuncs.js测试下。<br>
<br>
只要每个打印方法里能调用到就行。<br>
<br>
看上去是判断操作系统位数的。<br>
不需要设置这个，c-lodop都用32位的就行。32位c-lodop支持32和64位操作系统。<br>
<br>
客户端本地打印角色，建议都用32位的c-lodop，用lodopFuncs.js里默认的。<br>
<br>
第一种角色，建议都用32位的，<br>
64位的适合后两种角色的云服务器那种，三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
<br>
都用32位版的c-lodop，下载中心综合版里的也是提示的32位的。<br>
<br>
20.<span style="color:blue;font-weight:bold">Access violation at address XXXX in module 'CLodopPrirnt32.exe' Read of address XXXXX</span><br>
access error，参考http://www.c-lodop.com/faq/pp1.html<br>
以管理员权限重新安装下试试，排查下链接里的access error条目。<br>
<br>
(客户反馈以管理员权限安装就好了）<br>
<br>
21.<span style="color:blue;font-weight:bold">AO打印，端桥好像是最多能取出20个？</span><br>
参考http://localhost:8000/c_aobridge<br>
因在线打印机可能很多，为避免拖累速度，主JS文件(CLodopfuncs.js)里默认仅含20个(可用AOListCount自定)打印机信息，<br>
故在实际应用中一般都是对SET_BRIDGE_INDEX参数赋具体值<br>
<br>
GET_VALUE("AO_PRINT_JSON_PrinterList",0);获取在线AO打印设备(打印机及端桥)清单<br>
试试这个。参考http://localhost:8000/c_aoprintget<br>
<br>
主JS文件(CLodopfuncs.js)里默认仅含20个(可用AOListCount自定)打印机信息，<br>
故在实际应用中一般都是对SET_BRIDGE_INDEX参数赋具体值，<br>
<br>
(可用AOListCount自定)，这个值大一些试试。比如设置AOListCount=200<br>
<br>
</div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
