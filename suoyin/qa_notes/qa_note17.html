<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>【非常见问题杂笔记】打印图片不清晰，打印url卡住等</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-【非常见问题杂笔记】打印图片不清晰，打印url卡住等</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../qa_notes.html"><div class="menuitem"><span style="color:blue;">问答等记录笔记，具体问题</span></div></a>
</div>



        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【非常见问题杂笔记】打印图片不清晰，打印url卡住等</h1>
1.<span style="color:blue;font-weight:bold"> 打印图片的时候，预览或者查看图片的清晰度和大小都可以，但是使用热敏打印机打印出来就模糊了，特别是面单中条码都带齿痕</span><br>
如何输出清晰图片 参考http://www.c-lodop.com/faq/pp14.html<br>
<br>
用xps或pdf虚拟打印机直接打印查看下效果，查看下虚拟打印机直接打印生成的文件。<br>
理论上本机虚拟打印没问题的话，说明插件代码没问题，程序可做的努力就的确很少了，毕竟windows下的打印是微软倡导的设备无关系原则，要在打印机和打印驱动程序 系统上排查下，尝试重装驱动 或者 打印机不支持一些功能 打印机精度太低。<br>
<br>
虚拟打印机清晰，说明和打印机或打印机驱动有关了。<br>
或尝试纯文本输出，这个纯文本是lodop直接输出的，可能会更清晰一些<br>
纯文本输出试试
纯文本+线输出表格：ADD_PRINT_TEXT、ADD_PRINT_LINE<br>
画线输出表格，参考http://www.c-lodop.com/demolist/PrintSampleA1.html<br>
条码输出 参考样例11 http://www.c-lodop.com/demolist/PrintSample11.html<br>
<br>
是pdf文件吗，c-lodop可以直接打印pdf文件了<br>
官网下载中心，下载最新的C-lodop<br>
http://www.c-lodop.com/download.html<br>
安装后在欢迎页面末尾找“PDF打印”链接，或输入地址: <br>
http://localhost:8000/c_pdfprint<br>
<br>
是c-lodop的新功能，不注册打印的时候，会有一个弹窗提示，提示需要顶级注册。<br>
点确定后可以使用。<br>
如果要去掉这个pdf的弹出提示，需要顶级注册。<br>
<br>
2.<span style="color:blue;font-weight:bold">没有单独的指令来获取，指定名称打印机是否已连接还是未连接的状态吗</span><br>
没有其他判断方法，<br>
样例4,35返回的打印成功，是指加入队列<br>
如果打印机不连接，会一直在队列里排队。<br>
<br>
只能通过打印机状态，或不在队列判断。<br>
样例45的打印机状态需要实际测试下，需要测试打印机是否支持。<br>
<br>
3.<span style="color:blue;font-weight:bold">有部分电脑显示的模板格式乱了</span><br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
如果虚拟打印机正常，说明和打印机或打印机设置有关，如打印机不支持自定义纸张，不同打印机可打区域不同等影响。<br>
如果虚拟打印机也不正常，可能和内容样式等有关，参考http://www.c-lodop.com/faq/pp8.html<br>
<br>
预览是打印机的反显，用虚拟打印机和真实打印机预览对比下。<br>
如果虚拟打印机也不正常，可能和内容样式等有关，参考http://www.c-lodop.com/faq/pp8.html<br>
<br>
4.<span style="color:blue;font-weight:bold">客户开了广域网，看不到打印主机</span><br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
是第三种角色吗<br>
<br>
访问下http://[C-Lodop服务所在主机ip或域名]:[C-Lodop端口]/c_aoprint 欢迎页面，查看下端桥是否在线<br>
<br>
访问下http://[C-Lodop服务所在主机ip或域名]:[C-Lodop端口]/c_aobridge 测试查看端桥下的打印机<br>
<br>
5.<span style="color:blue;font-weight:bold">系统重装，注册号还有效吗？(加群邮箱查到是A注册）</span><br>
购买的是clodop注册号A注册吗，这种绑定的是机器硬件。<br>
只要硬件信息不变就行，重装系统还可以使用。<br>
重装系统后观察下请求号是否有变化，如果变化不大，可能是网卡顺序的影响，还可以继续使用原来的注册号。<br>
<br>
6.<span style="color:blue;font-weight:bold">pdf 面单怎么打印 ？</span><br>
官网下载中心，下载最新的C-lodop<br>
http://www.c-lodop.com/download.html<br>
安装后在欢迎页面末尾找“PDF打印”链接，或输入地址: <br>
http://localhost:8000/c_pdfprint<br>
<br>
控件注册号 注意事项 最新价格表、购买方式和使用方法见(官网)：<br>
http://www.c-lodop.com/Lodop_Lic.html<br>
顶级注册号，域名顶级或公司名顶级<br>
<br>
没有，公司统一定价，按照那个价格表执行。<br>
<br>
7.<span style="color:blue;font-weight:bold">提示“有窗口已打开，先关闭它（持续如此请刷新页面）！”</span><br>
参考http://www.c-lodop.com/faq/pp27.html<br>
<br>
是否有共享打印机，删除共享打印机后，重新安装试试。<br>
<br>
测试下官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启c-lodop后刷新页面。<br>
重启c-lodop后，刷新下页面后再点击样例的预览试试，只点击一次。<br>
<br>
重启c-lodop后只点样例的打印预览一次。<br>
<br>
重启c-lodop后测试下样例7试试，指定一个有效的打印机进行预览http://www.c-lodop.com/demolist/PrintSample7.html<br>
<br>
这个是备用进程，不用删。<br>
<br>
windows操作系统是否存在打印机，指定个有效的默认打印机。<br>
如果有共享打印机，删除共享打印机再测试下。<br>
<br>
能显示预览吗<br>
<br>
样例正常，对照样例排查下代码。<br>
<br>
8.<span style="color:blue;font-weight:bold"> 有linux 版本的吗 ？ 我们有用linux 系统</span><br>
目前lodop和c-lodop只能安装到windows操作系统上，其他操作系统无法安装，无法用客户端本地打印角色，其他操作系统可以用集中打印，或广域网打印角色。<br>
三种角色及使用方法 参考http://www.c-lodop.com/demolist/t1.html<br>
开发人员正在研发中，后续可能会推出。<br>
<br>
广域网打印没有视频资料，可参考：<br>
三种角色及使用方法 参考http://www.c-lodop.com/demolist/t1.html<br>
参考http://www.c-lodop.com/aoprint.html<br>
<br>
8.<span style="color:blue;font-weight:bold"> 一个驱动，两个相同设备，会出现串嘛</span><br>
两个打印机吗，需要装两个驱动，一个驱动会出现带副本字样的。<br>
获取的是windows打印机列表的打印机，可以通过驱动名称区分。<br>
<br>
相同设备，安装到同一个windows电脑上吗，一个会出现副本字样，两个会是不同名的。<br>
<br>
9.<span style="color:blue;font-weight:bold"> 样例38，png图片不能用吗</span><br>
和图片原始格式一致。<br>
<br>
图片用样例40生成base64试试，然后放到样例38里测试。<br>
<br>
确保原始格式和设置的格式一致。<br>
如果还是不行，发一下这个原始图片，这边测试下。<br>
<br>
10.<span style="color:blue;font-weight:bold"> 不通过js，服务端调用a段桥下的a1设备吗</span><br>
不指定打印机吗，需要指定下，端桥还要有是否在线等问题，建议让客户进行选择。<br>
<br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
<br>
11.<span style="color:blue;font-weight:bold"> 一个循环 有多张图片需要打印。图片太大会导致打印不出来</span><br>
图片批量打印，src 方式输出，需要通过浏览器引擎解析，存在不释放缓存的现象，可尝试base64码输出，参考样例<br>38http://www.c-lodop.com/demolist/PrintSample38.html<br>
base64位码输出直接通过本地lodop程序解析，无需经过浏览器引擎解析<br>
或尽量减小图片。<br>
<br>
尽量不要批量打印大量太大的超文本图片，处理图片大小到合适的质量，或<br>
可尝试base64码输出，参考样例38http://www.c-lodop.com/demolist/PrintSample38.html<br>
<br>
理论上没有限制，但是Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。<br>
超文本内容会经过浏览器解析，可能会造成影响，尽量不要打印太大量的大图片。<br>
<br>
12.<span style="color:blue;font-weight:bold">针式打印机的老是跳纸是什么原因呢  他最后一行明明能打完  还有打印机如果有默认边距那种怎么处理呢</span><br>
是指最后一行纸张下方还有距离，但是分页了吗，<br>
调整打印项高度到合适的值，超文本会根据打印项高度自动分页。<br>
<br>
预览查看下效果，边距是否有虚线，“可打区域”边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br>
http://www.c-lodop.com/faq/pp26.html<br>
<br>
13.<span style="color:blue;font-weight:bold">样例2，打印没反应</span><br>
测试下样例7试试，选择个其他打印机。<br>
<br>
可能默认打印机有问题，用语句指定具体的打印机试试，<br>
<br>
如果还是不行，在代码里指定打印机试试，参考样例5，在页面让用户选择打印机列表。<br>
<br>
14.<span style="color:blue;font-weight:bold">选择打印机打印，不用预览，是 那个样例</span><br>
选择打印机，参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
打印机优先级，参考http://www.c-lodop.com/blogs/Blog002.html<br>
或PRINTA，直接打印前弹出打印机选择框<br>
<br>
15.<span style="color:blue;font-weight:bold">提示AO printer not found!</span><br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
<br>
如果是第一种角色，获取的是客户端本地的打印机<br>
选择打印机，参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
<br>
进入欢迎页面http://localhost:8000，点欢迎页面的预览试试<br>
欢迎页面下方选择打印机，点预览。<br>
<br>
16.<span style="color:blue;font-weight:bold"> 43 这个案例中 LinkedItem   1   设置关联项1是什么意思</span><br>
就是关联哪个打印项，<br>
打印项序号的解释，可见技术手册set_print_stylea篇的第一个参数。<br>
<br>
样例43的1就是第一个的打印项，这个table打印项，<br>
<br>
<span style="color:blue;font-weight:bold">那这个 1 代表跟随上一个打印项吗？</span><br>
不是，是第一个打印项，可见技术手册set_print_stylea篇的第一个参数。<br>
整个任务的第一个打印项。<br>
<br>
如果是想关联紧跟着的上一个的打印项，可以用-1。<br>
<br>
样例43中是都关联的这个table打印项。<br>
都是关联的这个打印项。相对这个打印项的位置进行偏移。<br>
<br>
一个内容关联别人后，其Top值不再是上边距，而是与被关联者的间隙距离,Left值也变为左边距相对偏离量。<br>
可以紧挨着，设置top和left小一些。<br>
设置关联后就是相对位置了。<br>
<br>
可以关联-1，形成关联串。<br>
<br>
可以连续关联，参考样例41的2.<br>
注意LinkedItem值为负数代表“前移几位”的对象,所以-1就是上一个。这个语句可以实现连续关联。<br>
<br>
样例43的需求是表格自动分页，那两个跟着表格。<br>
根据需求决定关联方法。<br>
<br>
<span style="color:blue;font-weight:bold">自动分页  不能 使用 跟随项吗</span><br>
可以，根据自己的需求。<br>
多个对象顺序关联后形成“关联串”，这个“串”分页时在每页高度以第一个对象为准，<br>
<br>
其他打印项不能关联页眉页脚，<br>
页眉页脚可以关联其他的。<br>
<br>
可以测试下样例，<br>
这个样例的div3，第一页在表格下方，分页后的最后一页也是跟在表格下方。<br>
<br>
17.<span style="color:blue;font-weight:bold"> 用C-lodop  总是报这个错，某地址18000端口访问出错</span><br>
查看下启动的端口是否正常。<br>
<br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
是哪种角色<br>
<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
参考链接，如果客户端是访问网站后，在自己的电脑的打印机上打印，属于第一种角色。<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
如果样例正常，样例页面右键查看源码 ，参考样例的使用方法。访问的是localhost本地的c-lodop<br>
<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
是第一种角色吗，进入欢迎页面http://localhost:8000，点欢迎页面的预览试试<br>
<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
是第一种角色吗，第一种角色用lododpFuncs.js默认的localhost。<br>
<br>
访问这个http://localhost:8000，这个欢迎页面是正常的，说明正常。<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
测试下样例是否正常<br>
<br>
18.<span style="color:blue;font-weight:bold">打印预览总是自动关闭，样例2也是</span><br>
用管理员权限安装最新版http://www.c-lodop.com/download.html，右键以管理员权限运行，再对比试试。<br>
<br>
参考http://www.c-lodop.com/faq/pp5.html<br>
排查开机启动项，用管理员权限安装最新版http://www.c-lodop.com/download.html，右键以管理员权限运行，再对比试试。<br>
排查c-lodop是否能开机自启动，默认情况c-lodop是开机自动启动的，没自动开启可能问题：<br>
1. 在系统msconfig启动选项列查看c-lodop是否是开启自启动；<br>
2. 当前操作用户权限不足，无系统管理员权限；<br>
3. 注意安全软件禁用c-lodop. 目前常用的360及金山已进行了安全认证，其他的杀毒软件请加入白名单，或直接上报提交对应的杀毒软件服务器。<br>
<br>
样例2的打印预览也会自动关闭吗<br>
<br>
是否只有这一台电脑有问题，用其他电脑测试下。<br>
<br>
自动关闭很不正常，用其他电脑测试下，是否是该电脑或操作系统存在问题。<br>
看视频中，好像是点右下角的时候，导致了自动关闭，不好判断，用其他电脑测试下。<br>
<br>
不能用从服务里拷出来的，那个不是，那个是给c-lodop例子的，<br>
下载中心综合版里的lodopFuncs.js。<br>
<br>
19.<span style="color:blue;font-weight:bold">为什么页面中某地方行数和页面不一致，换行了</span><br>
看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
分析差异点，因浏览器版本不同遵循的html标准不同，造成某些标签属性显示有差异，尽量避免使用有差异的属性，可以在ie下不同版本仿真情况下验证差异 排查样式，尽量使用使用各浏览器无歧义的通用的 html css js，不支持的样式可尝试用其他样式代替。<br>
排查样式是否和容器有关，4行是多出来 一个字，修改下样式事实上，增大这个位置的宽度试试。<br>
<br>
lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。排查下样式http://www.c-lodop.com/faq/pp8.html<br>
排查样式，修改样式。<br>
排查下样式，可能和字体，字体大小或其他样式等有关，逐步删减等方法排查下。<br>
<br>
lodop本身没有解析超文本的引擎，lodop是基于本机windows底层引擎进行渲染解析的。<br>
标签和样式都有可能受影响。<br>
如果样式和容器有关，样式等更容易受影响，特别是容器大小不同导致的换行问题。<br>
<br>
20.<span style="color:blue;font-weight:bold">在打印使用的时候 突然 打印的内容 就打歪了</span><br>
参考http://www.lodop.net/faq/pp17.html<br>
<br>
<span style="color:blue;font-weight:bold">用 相对定位 来控制 打印的位置  不是用 套打的方式</span><br>
是指关联在，相对是打印项相对打印项的位置，对于纸张中，还是在固定位置的。<br>
<br>
预览查看下效果。<br>
是第一张就偏移，还是连续打印累计偏移。<br>
<br>
一张就偏移，参考http://www.lodop.net/faq/pp17.html<br>
用打印维护针对该客户端进行调整，调整结果在客户端本地，只针对该客户端有影响。<br>
<br>
<span style="color:blue;font-weight:bold"> 过了一段时间，会跑偏了</span><br>
打印维护调整后，会在本地生成ini文件，参考http://www.c-lodop.com/faq/pp9.html<br>
这个ini文件是否存在。<br>
<br>
如果是过一段时间后偏了，是否打印机本身位置存在问题，再用打印维护调整下试试，咨询下打印机客服，是否打印机有问题，比如位置矫正了之类的。<br>
<br>
建议用纯文本方式，如果是超文本，也会受浏览器引擎的影响，可以用样例4的方式。<br>
<br>
可以装载背景图，参考样例http://www.c-lodop.com/demolist/PrintSample9.html<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample9.html<br>
参考样例9的3，指定背景图的位置和大小<br>
<br>
需要自己设置，或者控制下扫描出来的图片大小 ，参考样例9的3<br>
可以设置图片尺寸和纸张一致。或打印出来后再调整下。<br>
<br>
用虚拟打印机测试。预览右键显示标尺。<br>
群文件里有个doro pdf虚拟打印机，可以打印成pdf文件。<br>
<br>
21.<span style="color:blue;font-weight:bold">样例2预览不出来，样例7可以</span><br>
测试下样例7试试，样例7也有选择打印机的。<br>
<br>
选择打印机，参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
打印机优先级，参考http://www.c-lodop.com/blogs/Blog002.html<br>
不指定打印机的样例，会按照优先级走。<br>
<br>
样例7正常，说明和打印机的选择有关，选择打印机后再进行打印。<br>
可能默认打印机或优先级里的打印机有问题。<br>
<br>
选择打印机后，打印预览是正常。<br>
不选择的时候走优先级出了问题，可能和默认打印机有关，也可能和根据优先级记忆走的某个打印机有关。<br>
<br>
样例7指定了具体的打印机，样例2没有指定打印机，会走优先级的打印机。<br>
<br>
如果样例7正常，指定下打印机再预览或打印机试试。<br>
获取下这个打印机名称，获取下个数，或测试样例5，逐个打印机预览试试。<br>
<br>
-1特指windows的默认打印机。查看windows默认打印机是否是有效的正常打印机。<br>
<br>
（最近反馈不选打印机不能打印预览的用户增多，但是这边测试不出问题，看上去可能和这些用户默认打印机有关。已反馈到梦泰尔群里，有客户说默认打印机正常。）<br>
<br>
22.<span style="color:blue;font-weight:bold">用的打印URL，卡在 正在打开页面下载数据，限时5分钟</span><br>
由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(Cookies)，所以需要安全验证的页面不要用URL方式打印，要用页面已经下载好的内容的HTM方式打印，也就是ADD_PRINT_HTM或ADD_PRINT_TABLE等语句<br>
另外URL方式需要二次访问服务器，理论上存在下载失败的可能，所以专业的管理系统尽量不要用URL方式。<br>
尽量不用url方式，用样例2等传入超文本信息的方式。<br>
<br>
尽量用样例2那种传入超文本信息的方式，URL方式需要二次访问服务器，理论上存在下载失败的可能，所以专业的管理系统尽量不要用URL方式。<br>
<br>
url方式的特点决定的。<br>
测试下其他网址试试，比如百度首页等，常见地址。<br>
测试网络是否正常，在该机器ie里访问下需要的地址试试。需要Ie能直接访问的地址。<br>
<br>
<span style="color:blue;font-weight:bold">我用IE试一下，可以打开，然后在打印预览，就能打开了。</span><br>
可能本机ie存在某些问题，Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。<br>
ie启动的时候早成了一些影响。<br>
<br>
		   </div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
