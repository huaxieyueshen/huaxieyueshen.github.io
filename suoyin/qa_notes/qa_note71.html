<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>【非常见问题杂笔记】行间距负值，导出图片不完整，pdf跨域等</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-【非常见问题杂笔记】行间距负值，导出图片不完整，pdf跨域等</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../qa_notes2.html"><div class="menuitem"><span style="color:blue;">问答等记录笔记，具体问题</span></div></a>
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【非常见问题杂笔记】行间距负值，导出图片不完整，pdf跨域等</h1>
1.<span style="color:blue;font-weight:bold">换行之后,字间距有办法近一点吗</span><br>
LODOP.ADD_PRINT_TEXT(115,169,100,20,"新加文本2");<br>
LODOP.SET_PRINT_STYLEA(0,"LineSpacing",3);//设置行间距为3，也可以设置负值<br>
<br>
2.<span style="color:blue;font-weight:bold">虚线怎么设置</span><br>
参考lodop技术手册，<br>
和打印设计<br>
（图）<br>
虚线线宽为0。<br>
<br>
3.<span style="color:blue;font-weight:bold">点击设计模板   提示(AO)Printer not found!</span><br>
安装最新版c-lodop测试下http://www.c-lodop.com/download.html<br>
安装时不要勾选云服务器端工作模式。<br>
<br>
4.<span style="color:blue;font-weight:bold">window7 中datamatrix格式二维码 打印预览不显示，但是在window10 中没有问题</span><br>
是图片方式输出的吗<br>
<br>
lodop目前不支持输出datamatrix格式二维码，参考http://www.c-lodop.com/demolist/PrintSample11.html<br>
<br>
图片不显示，参考<br>
1）查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
查看一下传入的图片路径是否正确，尽量用绝对路径地址，换个图片试试。<br>
（2）显示空白或者图片缺失等问题，加延迟试试：<br>
LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒<br>
（3）权限问题，图片显示叉号 说明服务端拒绝了 可能证书 session等问题，导致没有直接访问该图片的权限，有些需要验证之后才能访问图片。由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(cookies)<br>
（4）清空ie缓存 重置ie 后在ie中查看下。IE中的URL最大长度限制为2048字节。超过这个长度会不支持。<br>
（5） 查看服务器端错误日志排查下 。<br>
（6）做个简单的例子验证下，排除其他因素的干扰。Base64输出图片参考样例38。<br>
<br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
（小问答3段）<br>
<br>
5.<span style="color:blue;font-weight:bold">想动态更改背景图片有没有什么办法</span><br>
把背景图的参数用变量控制。<br>
<br>
把参数改成变量，变量赋值等需要自己控制。<br>
<br>
是ADD_PRINT_SETUP_BKIMG背景图吗<br>
参考http://www.c-lodop.com/demolist/PrintSample9.html<br>
<br>
图片上传服务器需要自己控制<br>
<br>
6.<span style="color:blue;font-weight:bold">ie脱机工作会影响lodop正常工作吗</span><br>
可以测试下，lodop是基于本机windows底层引擎进行渲染解析的，尽量让ie处于正常状态。<br>
<br>
(图片显示叉号排查大段）<br>
如果测试ie脱机会有影响，尽量ie处于正常状态，重置ie测试下。<br>
<br>
批量打印大量图片，可以用base64方式输出试试，lodop语句直接输出base64码，不带img标签，参考样例38
http://www.c-lodop.com/demolist/PrintSample38.html<br>
<br>
7.<span style="color:blue;font-weight:bold">样式怎么在浏览器里访问，现在不兼容</span><br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
（小问答3段）<br>
<br>
排查下样式http://www.c-lodop.com/faq/pp8<br>
尽量用通用的样式，升级ie最新版试试。<br>
<br>
发一下超文本内容代码，和样式差异部分。<br>
<br>
是字体大小问题吗，查看IE和操作系统显示里是否设置了缩放<br>
<br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机
在有问题的机器上用虚拟打印机输出测试下，如果是在纸张中居中，排查是否有可打区域和不支持自定义纸张等问题。<br>
<br>
8.<span style="color:blue;font-weight:bold">图片白边这个如何处理</span><br>
参考http://www.c-lodop.com/demolist/PrintSample38.html<br>
用base64方式输出试试，不加img标签，直接输出base64<br>
<br>
9.<span style="color:blue;font-weight:bold">图片白边这个如何处理</span><br>
如何输出清晰图片 参考http://www.c-lodop.com/faq/pp14.html<br>
<br>
参考http://www.c-lodop.com/faq/pp14.html<br>
尽量用lodop语句输出。<br>
打印项是怎样输出的，如果用的是ADD_PRINT_HTML ，换成 ADD_PRINT_HTM试试，这种是解析后的超文本<br>
<br>
需要实际测试下，ADD_PRINT_HTML是图形模式，能较好的还原样式。<br>
ADD_PRINT_HTM是解析后的超文本，比较清晰，两者各有优势。<br>
<br>
如果想图片更清晰，需要单独输出图片方式，参考http://www.c-lodop.com/faq/pp14.html<br>
<br>
没有方法判断，尽量用精度较高的打印机，例如激光打印机等可能会更清晰些。<br>
<br>
10.<span style="color:blue;font-weight:bold">打印html内容，img失真</span><br>
如何输出清晰图片 参考http://www.c-lodop.com/faq/pp14.html<br>
<br>
参考http://www.c-lodop.com/faq/pp14.html<br>
尽量用lodop语句输出。<br>
打印项是怎样输出的，如果用的是ADD_PRINT_HTML ，换成 ADD_PRINT_HTM试试，这种是解析后的超文本<br>
<br>
需要实际测试下，ADD_PRINT_HTML是图形模式，能较好的还原样式。<br>
ADD_PRINT_HTM是解析后的超文本，比较清晰，两者各有优势。<br>
<br>
如果想图片更清晰，需要单独输出图片方式，参考http://www.c-lodop.com/faq/pp14.html<br>
<br>
没有方法判断，尽量用精度较高的打印机，例如激光打印机等可能会更清晰些。<br>
<br>
11.<span style="color:blue;font-weight:bold">提交 的是XXX  刚看邮箱发来 的是www.XXX</span><br>
控件注册号 注意事项 最新价格表、购买方式和使用方法见(官网)：<br>
http://www.c-lodop.com/Lodop_Lic.html<br>
<br>
970的那个是顶级注册一级域名<br>
另一个域名注册是二级或三级域名，如果发的是一级域名，会前面加www.<br>
<br>
12.<span style="color:blue;font-weight:bold">有没有套打的实例,一张出库单每张只能打10条记录，现在出库单是18条记录，，要打二张</span><br>
打印设计和定位套打 参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
手把手教你WEB套打程序开发 参考http://www.c-lodop.com/blogs/Blog008.html<br>
<br>
如果这些条数是表格，如果用超文本，超文本超过打印项高度或纸张高度自动分页。<br>
分页 参考样例30，43等 http://www.c-lodop.com/demolist/PrintSample30.html<br>
超文本超过设置的打印项高度或纸张会自动分页。<br>
<br>
13.<span style="color:blue;font-weight:bold">导出Excel不成功</span><br>
测试下样例12，参考http://www.c-lodop.com/demolist/PrintSample12.html<br>
<br>
用样例12的写入excel试试。<br>
如果是样例27那种，lodop采用“Excel.Application”来导出excel，所以要求系统必须安装excel相关软件且非绿色安装那种。<br>
<br>
参考http://www.c-lodop.com/faq/pp3.html<br>
<br>
14.<span style="color:blue;font-weight:bold">操作失败，请关闭浏览器重试
Error reading Images1.Bitmap:Failed to read ImageList data from stream，单条打印是可以的</span><br>
做个简单例子测试下，调试排查下是否是打印项或打印项内容引起的。<br>
<br>
单条和多条是，一个任务多页，还是多个任务。<br>
<br>
调试JS，排查每个任务的数据传入等是否正常。<br>
<br>
15.<span style="color:blue;font-weight:bold">lodop可以在服务端直接打印吗</span><br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
后两种角色可以打印到其他电脑上。<br>
<br>
是CS架构吗，还是BS架构的<br>
BS架构的建议传数据到前端，再传值给lodop<br>
<br>
是指在服务器端的打印机上打印吗，<br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
后两种角色可以。<br>
<br>
需要实现什么效果，打印端是在客户端本地电脑的打印上，还是在服务器端或其他电脑的打印机上。<br>
<br>
是别人都打印到你的电脑上的打印机吗，<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
可以把你的电脑作为端桥，其他电脑选择这个端桥进行打印。<br>
或只有这一台电脑打印，第二种角色集中打印。<br>
<br>
如果客户访问网站后，在自己的电脑的打印机上打印，就是第一种角色，官网样例是这种角色。<br>http://www.c-lodop.com/LodopDemo.html<br>
<br>
(大段）<br>
以上是一些客户端反馈的CS架构的使用方法，可以参考摸索下。没有样例。<br>
<br>
安装lodop插件后，<br>
类似路径如下： 系统盘符:\Program Files (x86)\MountTaiSoftware\Lodop<br>
<br>
16.<span style="color:blue;font-weight:bold">程序怎样知道打印成功了</span><br>
参考样例35 http://www.c-lodop.com/demolist/PrintSample35.html<br>
样例45的13 http://www.c-lodop.com/demolist/PrintSample45.html<br>
样例35返回的“打印成功”实际仅是成功加入后台队列。<br>
样例45的13 判断“JOB不在队列”就足可认定已经打印成功。<br>
一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br>
<br>
样例45的那个是这样判断的，打印成功状态或不在队列为成功。<br>
也可以样例4简单方法判断，加入队列算成功。<br>
<br>
c-lodop是异步的，样例右键源码，参考样例的写法<br>
<br>
On_Return是用来回调GET_VALUE等的返回值的。参考c-lodop技术手册的说明。<br>
c-lodop回调获取返回值，lodop直接返回。<br>
<br>
参考样例45，job代码。<br>
<br>
加了这句会变成job代码<br>
LODOP.SET_PRINT_MODE("CATCH_PRINT_STATUS",true);<br>
该任务的JOB代码（打印机序号和JOB序号组成）<br>
<br>
不加就是样例4的方式。加入队列算成功。<br>
<br>
根据需要，一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br>
<br>
根据需要，可以直接参考样例4判断返回值，加入队列算成功。<br>
也可以用打印状态成功和不在队列判断。<br>
建议用简单方式判断，加入队里算成功。<br>
<br>
17.<span style="color:blue;font-weight:bold">提示，打印任务不存在，请重新预览！</span><br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
是后两种角色吗<br>
<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
点样例的预览试试，查看是否有报错或提示<br>
<br>
双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启c-lodop后刷新页面。<br>
查看操作系统是否存在打印机，系统打印服务(Print Spooler)是否开启了<br>
<br>
如果确认是第一种角色，样例正常，对照样例排查代码。<br>
样例页面右键查看源码 ，参考样例的使用方法。<br>
<br>
18.<span style="color:blue;font-weight:bold">第二页表格上方有空白</span><br>
可以设置次页偏移，超文本自动分页后，次页开始的位置不再是初始位置，而是偏移后的位置。<br>
例如：LODOP.SET_PRINT_STYLEA(0,"Offset2Top",-140);//设置次页向上偏移140<br>
<br>
是指下方打印项的内容次页向上偏移的距离吗<br>
次页偏移的高度需要自己设置。<br>
<br>
只能估计表格上面打印项的高度。<br>
根据上面打印项的高度，设置表格的次页偏移值。<br>
<br>
19.<span style="color:blue;font-weight:bold">条码有锯齿</span><br>
条码打印项是怎样输出的，是打印的pdf文件吗<br>
<br>
（图）<br>
预览看上去效果还可以，用xps或pdf虚拟打印机输出测试下。<br>
<br>
或换用lodop语句输出对比测试下试试<br>
参考样例11 http://www.c-lodop.com/demolist/PrintSample11.html<br>
<br>
用xps或pdf虚拟打印机测试下，<br>
理论上本机虚拟打印没问题的话，说明插件代码没问题，程序可做的努力就的确很少了，毕竟windows下的打印是微软倡导的设备无关系原则，要在打印机和打印驱动程序 系统上排查下，尝试重装驱动 或者 打印机不支持一些功能 打印机精度太低。<br>
或换用样例11的方式输出条码。<br>
<br>
用xps或pdf虚拟打印机测试下，其他输出方式和lodop输出方式不同。<br>
<br>
（图）<br>
这边测试打成xps，看上去效果还可以。<br>
或换样例11的方式输出试试。<br>
<br>
理论上本机虚拟打印没问题的话，说明插件代码没问题，程序可做的努力就的确很少了，毕竟windows下的打印是微软倡导的设备无关系原则。<br>
或换其他打印机测试下，如激光打印机等。<br>
<br>
20.<span style="color:blue;font-weight:bold">导出的图片不完整</span><br>
导出图片，参考http://www.c-lodop.com/demolist/PrintSample27.html<br>
<br>
进入打印预览查看下效果<br>
<br>
是指右侧吗，看上去内容超出纸张了<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。 选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
<br>
在有问题的电脑上用虚拟打印机输出测试下，有的打印机不支持自定义纸张，或纸张有问题。<br>
<br>
“可打区域”边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br>
http://www.c-lodop.com/faq/pp26.html<br>
<br>
在有可打区域的那个电脑上用虚拟打印机预览查看下。<br>
<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
支持win7，安装虚拟打印机后，选择该虚拟打印机进行预览查看下。<br>
<br>
“可打区域”边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br>
http://www.c-lodop.com/faq/pp26.html<br>
可打区域lodop不能调整，和打印机有关，虚拟打印机无可打区域<br>
<br>
虚拟打印机无可打区域，且支持自定义纸张<br>
<br>
21.<span style="color:blue;font-weight:bold">条码有锯齿</span><br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
并排多个标签，可以把并排标签看做一个纸张。<br>
<br>
打印项的位置是自己控制的，<br>
如果是多列的标签纸张，可以把并排的标签看做一张纸。<br>
在一张纸上定位各个打印项到合适的位置。<br>
<br>
22.<span style="color:blue;font-weight:bold">PDF打印，纸张有问题</span><br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。 选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
纸张的一些优先级 http://www.c-lodop.com/blogs/Blog002.html<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
最新版4115，也可以用pdf自己的尺寸<br>
增加：单一PDF打印模式;<br>
       当仅有单个PDF主对象+纸张大小PAGESIZE=模式3(纸张随内容变化)+PDF对象按原始大小输出，此时最终输出纸张大小按PDF文档内部定义的纸张尺寸;<br>
       例如:<br>
       LODOP.ADD_PRINT_PDF(0,0,"100%","100%",strURLorContent);<br>
       LODOP.SET_PRINT_STYLEA(0,"PDFScalMode",1);<br>
       LODOP.SET_PRINT_PAGESIZE(3,0,0,"");<br>
<br>
23.<span style="color:blue;font-weight:bold">papage size(W:0 H:0) invalid!</span><br>
去掉纸张语句测试下，有的打印机不支持设置的该自定义纸张。<br>
修改纸张语句参数直到这个打印机正常。<br>
<br>
去掉纸张语句测试下对比下。<br>
如果去掉正常，修改下纸张语句，纸张是怎样设置的，是否设置的宽高是0<br>
<br>
和打印机有关，<br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
查看操作系统是否存在打印机，系统打印服务(Print Spooler)是否开启了<br>
<br>
24.<span style="color:blue;font-weight:bold">条码属性里含变量，怎么把变量与常量字符串串接起来</span><br>
JS的字符串拼接起来，加号连接。<br>
<br>
字符串用英文引号括起来，变量直接是变量名，加号连接拼接字符串。<br>
<br>
25.<span style="color:blue;font-weight:bold">为什么 \r\n没换行</span><br>
Lodop如何实现换行，参考http://www.c-lodop.com/faq/pp12.html<br>
如果是超文本，需要用超文本的换行符<br>
<br>
调试JS，查看传入的数值是否正常<br>
<br>
26.<span style="color:blue;font-weight:bold">https的pdf文件打印不了</span><br>
https的pdf路径，和访问的网站的域名是否相同，是否是在同一域名下。<br>
<br>
pdf文件放到和访问网页相同的域名下试试。<br>
<br>
如果和电脑有关，不好判断，<br>
或用欢迎页面的后两种方式，下载到本地打印，或用base64码打印。<br>
<br>
查看下能打印的电脑是否设置了相关跨域访问资源的设置。<br>
或试试在后台等设置下。<br>
<br>
base64只能本地转，转好的pdf文件可以根据需要储存。<br>
或百度下设置下pdf跨域访问试试。<br>
<br>
这个是JS是怎样添加的。<br>
clodopprint.js，是否是自己的JS文件，报错这个文件访问有问题。<br>
<br>
参考http://www.c-lodop.com/faq/pp23.html<br>
是把lodopFuncs.js改名了吗<br>
<br>
看报错，有错误是这个文件没访问到，如果是lodopFuncs.js改名后的，查看下该文件路径是否正常。<br>
<br>
27.<span style="color:blue;font-weight:bold">lodop怎么扩展条码，客户需求必须要matrix二维码</span><br>
lodop目前不支持matrix二维码，支持样例11的两种二维码。<br>
lodop生成不了，或只能用图片等方式输出。<br>
图片输出，参考样例8<br>
<br>
目前支持的是能在网页浏览器解析显示的图片，参考样例8<br>
如png,jpg等。<br>
<br>
需要ie能正常显示的图片。<br>
<br>
Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。在样式有问题所在电脑上，尝试重置ie，升级ie，<br>
或排查下样式http://www.c-lodop.com/faq/pp8.html，通过删减或做简单例子排查，找到出问题的样式，修改样式。<br>
<br>
28.<span style="color:blue;font-weight:bold">papage size(W:0 H:0) invalid，只有一台电脑这样</span><br>
去掉纸张语句测试下，有的打印机不支持设置的该自定义纸张。<br>
修改纸张语句参数直到这个打印机正常。<br>
<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
点样例的预览试试，这个样例没有设置纸张，会根据优先级走。<br>
<br>
29.<span style="color:blue;font-weight:bold">一条数据多行的情况用ADD_PRINT_HTM  如何截取</span><br>
可以用 add_print_htm, 切行时调整分页粒度TableRowThickNess，参考 样例30<br>
http://www.c-lodop.com/demolist/PrintSample30.html<br>
超文本超过设置的打印项高度就会自动分页，可通过调整超文本打印项的高度，控制当前页面输出的多少内容<br>
<br>
超文本超过设置的打印项高度就会自动分页，减小打印项高度试试<br>
<br>
打印项高度可在打印设计界面可视化调整，调整后在点设计的预览查看效果，不断调整到合适的分页高度。<br>
<br>
把需要每页固定位置输出的打印项设置为页眉页脚项：<br>
LODOP.SET_PRINT_STYLEA(0,"ItemType",1);//设置上面的为页眉页脚，每页固定位置输出<br>
<br>
自动分页表格ADD_PRINT_TABLE输出，参考http://www.c-lodop.com/demolist/PrintSample15.html<br>
需要每页显示的页头页尾放到thead和tfoot里，thead和tfoot会每页输出。<br>
<br>
超文本的换行，需要用css样式控制，加载css样式，参考样例10 <br>http://www.c-lodop.com/demolist/PrintSample10.html<br>
<br>
如果是add_print_table，尽量用简单样式，td里直接放数值，不用div包裹试试。<br>
<br>
排查下样式，是否设置了超出隐藏样式等。<br>
例如样例2的这种单元格样式。<br>
（图）<br>
<br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
通过删减内容，或做简单例子的方式，找到出问题的html或样式，定位到哪些html或样式引起的。<br>
<br>
排查下样式http://www.c-lodop.com/faq/pp8.html<br>
table没有样式，超过宽度默认应该会换行，撑大高度。<br>
<br>
做个简单例子对比测试下，<br>
做个简单例子，发过来，这边测试下。<br>
<br>
（图）<br>
这边测试12的耗材名称是正常的，纸张大小是多少。<br>
<br>
直接测试的例子，我看例子里是 LODOP.ADD_PRINT_TABLE<br>
（图）<br>
<br>
发一下纸张语句，代码里没有设置纸张，这边用的是A4纸张。<br>
<br>
内容样式用的时候百分比，样式和容器有关，看截取纸张较小，应该是自动分页了，这边A4纸张测试没有自动分页。<br>
<br>
（图）<br>
这边测试带纸张的12项目的耗材也是正常显示的。<br>
是否有其他电脑，用其他电脑测试下。<br>
在样式有问题所在电脑上，尝试重置ie，升级ie试试<br>
并用最新版4115测试下，这边用4115测试的<br>
<br>
用最新版4115测试下，这边用4115测试的<br>
尝试重置ie，或升级ie试试，在其他电脑上测试下试试。<br>
<br>
这边测试是正常的，用4115版测试下。<br>
<br>
30.<span style="color:blue;font-weight:bold">这个水印如何去掉？</span><br>
Lodop c-lodop是一款专业共享软件，公开版本未限制功能，多数用户可免费长期使用。仅如下情况需要注册收费(费用很少)：您希望用到(不经过弹出预览窗口的)“直接打印”功能时。不注册时该功能直接打印的纸张左下角会有“本页由XXX试用版输出”小字样水印。另外导出Excel文件或图片也需要注册。<br>
控件注册号 注意事项 最新价格表、购买方式和使用方法见(官网)：<br>
http://www.c-lodop.com/Lodop_Lic.html<br>
<br>
如果是ip或域名注册类型，<br>
访问的是否是注册的ip或域名，浏览器地址栏输入的是否是注册的ip或域名，<br>
（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下
：http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。<br>
（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名： www.c-lodop.com 登陆方式如下
：http://www.c-lodop.com/index.html等，ip地址访问时，注册信息无效<br>
<br>
域名注册，只能在该域名访问下有效。<br>
验证的是浏览器地址栏的地址。<br>
<br>
浏览器地址栏访问的必须是注册的地址<br>
<br>
31.<span style="color:blue;font-weight:bold">以用这个控件 掉接口自动打印吗 ， 不放到浏览器里面</span><br>
自动打印，是怎样触发的打印。<br>
是CS架构的，还是BS架构的。<br>
<br>
CS使用大段。<br>
以上是其他客户反馈的方法，参考摸索下。<br>
<br>
32.<span style="color:blue;font-weight:bold">其他打印机打印正常 但是这个打印机打出来效果是这样的，内容倒着的，且一个标签跟着一个空白的。</span><br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
如果这个电脑上只有这一个打印机有问题，是怎样输出的，是否是一个标签一个任务。<br>
输出单个任务进入打印预览查看下效果。<br>
查看下输出内容方向是否正常，下方状态栏的纸张高度是否和标签一致。<br>
<br>
33.<span style="color:blue;font-weight:bold">怎么设置显示二维码的值。</span><br>
不支持显示二维码的值，<br>
可以用add_print_text输出二维码的值。<br>
<br>
34.<span style="color:blue;font-weight:bold">UPC_A 原本12位的 21148551700， 扫码枪 扫出来的是11148551700</span><br>
进入打印预览，查看条码是否显示完全<br>
<br>
一维条码能包含的字符内容及长度限制<br>
http://www.c-lodop.com/faq/pp18.html<br>
<br>
35.<span style="color:blue;font-weight:bold">打印机的状态可以获取到吗？</span><br>
参考样例45http://www.c-lodop.com/demolist/PrintSample45.html<br>
获取打印状态，需要实际测试下，不同打印机状态码可能不同。<br>
<br>
只能直接打印后获取状态<br>
<br>
36.<span style="color:blue;font-weight:bold">看例子，看不到代码的实现，以前用的时候，好像有一个文档，这里怎么找不到了</span><br>
样例右键，查看代码<br>
代码参数的解释等，可参考下载中心下方的技术手册http://www.c-lodop.com/download.html<br>
<br>
37.<span style="color:blue;font-weight:bold">ADD_PRINT_TABLE(因为想在每页输出表头)就会丢失一部分，ADD_PRINT_HTM可以正确分页，但是没有表头</span><br>
表格ADD_PRINT_TABLE输出，参考http://www.c-lodop.com/demolist/PrintSample15.html<br>
需要每页显示的页头页尾放到thead和tfoot里，thead和tfoot会每页输出。<br>
<br>
add_print_table不切行，如果我有超大行，不会自动分到下页。。<br>
可以减小打印项高度，下方留些空白，会不切行的情况下按照打印项高度自动分页。<br>
<br>
ADD_PRINT_HTM不支持每页输出tabe的thead， 或拆分需要每页显示的内容，拆成两个打印项，页头的打印项设置为页眉页脚项。<br>
<br>
超文本超过设置的打印项高度或纸张会自动分页。可以不断调整打印项高度到合适的分页值。<br>
<br>
页眉页脚项会每页固定位置输出<br>
<br>
分页位置不对，是指本页想分到更多的内容吗，只能不断调整打印项高度到合适的值。<br>
<br>
去掉关联试试，只设置页眉页脚项，每页固定位置输出下方的内容。<br>
<br>
设置具体的打印项高度<br>
<br>
这个联系电话是页眉页脚项吗<br>
<br>
红色区域是和上面表格一体的，自动分页<br>
还是每页固定位置输出的页眉页脚项。<br>
<br>
打印项自动分页，是整个打印项的，和上面的如果是一个打印项，一个table，是这个整体的自动分页高度。<br>
<br>
红色区域和上面的表格是一个打印项输出的，还是多个打印项输出的。<br>
做个简单例子发过来，这边测试下。<br>
<br>
这两个table是两个打印项输出的吗，两个table之前是怎样设置的，是样例41的关联吗。<br>
还是第二个table打印项固定顶边距输出。<br>
<br>
个对象顺序关联后形成“关联串”，这个“串”分页时在每页高度以第一个对象为准<br>
会根据这个串的高度自动分页。增大第一个打印项的高度试试。<br>
<br>
设置具体的打印项高度，第一个打印项高度设置成100%试试，或较大的打印项高度。<br>
<br>
超文本超过设置的打印项高度或纸张会自动分页。<br>
这个是分页高度<br>
<br>
INITA这个是整体偏移值，可以设置为0。建议原始代码设置0防止偏移。<br>
<br>
是指打印项高度自动分页问题件吗，这个和打印项高度有关，设置打印项高度具体值，按照高度值分页。<br>
如果有关联串，按第一个关联串的打印项高度分页。<br>
<br>
38.<span style="color:blue;font-weight:bold">有部份几台电脑。生成图片保存不到目录里</span><br>
如果是导出图片不成功，查看下是否是权限问题，以管理员权限运行c-lodop。<br>
保存到其他磁盘试试，不是C盘的，如D盘等。<br>
<br>
预览界面右键，保存图片试试。<br>
<br>
代码导出和预览界面右键导出应该是一样的。<br>
直接测试下样例27试试<br>
<br>
在有问题的客户端，测试下样例27导出图片试试。<br>
<br>
对照样例排查代码。是指弹出保存框吗<br>
<br>
FILE_PROMPT的值：整数或字符型，1或true=是, “0”或其它=否。<br>
该值为“是”时，控件会在保存前弹出窗口选择文件名及其路径。该值为“否”时控件按程序指定的文件名直接保存，不再弹出文件路径框，但会弹出安全提示框(做初次确认)。缺省值是“是”。<br>
是否是这个设置了不弹出。这种可能会弹出安全提示框，可能和windows的安全设置有关。<br>
<br>
可能和安全设置或权限有关，<br>
该值为“否”时控件按程序指定的文件名直接保存，不再弹出文件路径框，但会弹出安全提示框(做初次确认)。<br>
<br>
只能在有问题的电脑上进行排查，不弹出保存路径，向本机保存或写入文件，windows可能会有安全提示。<br>
<br>
以管理员权限重启下c-lodop试试，桌面上的c-lodop右键以管理员权限运行。<br>
再排查是否是管理员权限登录，登录账户的权限是否正常等，只能在有问题的机器上自己排查下。<br>
<br>
只能自己在有问题的机器上，可以对照正常机器，排查下，例如看下账户在报错路径的权限等。<br>
<br>
只能在有问题的机器上排查下。<br>
<br>
对照没有问题的电脑排查下，如登陆了的管理员的权限。<br>
写入权限，或winodws安全设置等。<br>
<br>
保存的那个路径的写入权限。<br>
参考样例27，写个判断试试，结果：返回逻辑结果，保存成功时返回真，保存失败或放弃保存时返回假。<br>
是否是提示保存失败。<br>
<br>
39.<span style="color:blue;font-weight:bold">有时莫名其妙打印出来成这样了，打成一半了</span><br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
偶尔发生不好判断，可以用虚拟打印机多次测试下。<br>
如果虚拟打印机正常，可能和该打印机或打印机驱动有关，重装打印机驱动试试。<br>
<br>
40.<span style="color:blue;font-weight:bold">设置纸张大小之后，预览界面纸张没有发生任何变化</span><br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。 选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。<br>
<br>
用xps或pdf虚拟打印机和真实打印机预览对比下，<br>
如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。<br>
<br>
41.<span style="color:blue;font-weight:bold">一个打印图形大小占 一半的 A4纸，我想一张A4纸打印2个，如何实现连打</span><br>
打印项的位置可以自己确定，<br>
直接打印项在纸张中定位，例如：ADD_PRINT_HTM(intTop,intLeft,intWidth,intHeight,strHtml)增加超文本项 前两个参数，顶边距和左边距。<br>
缩放图片宽高，参考参考http://www.c-lodop.com/faq/pp14.html<br>
<br>
纸张设置，参考样例5。<br>
图片顶边距左边距可用参数控制，缩放后的宽高参考http://www.c-lodop.com/faq/pp14.html<br>
<br>
42.<span style="color:blue;font-weight:bold">出现进度条，这样就卡死了</span><br>
出现进度条，打印过慢，可能和很多原因有关：打印内容或样式或图片等过多，有需要下载有脚步执行或本身网络慢；<br>
机器性能过低 系统ie有问题或缓存过多；或使用的是共享打印机。<br>
如果预览页数多，可以多分一些任务，太多不建议预览，建议直接打印，在任务和页数之间平衡一下，参考样例26 <br>
http://www.c-lodop.com/demolist/PrintSample26.html<br>
<br>
打印的是什么内容，输出的是什么打印项<br>
<br>
打印的是pdf吗，发一下有问题的pdf文件，这边测试下。<br>
<br>
用的c-lodop版本是多少，用最新版c-lodop测试对比下http://www.c-lodop.com/download.html<br>
这边测试预览单个这个pdf文件正常。<br>
以管理员权限安装c-lodop，运行c-lodop试试。<br>
<br>
是批量打印这种pdf吗，是一个任务输出多个pdf，还是一个任务输出一个这种pdf文件。<br>
<br>
这边测试单独预览这个pdf是正常的，没有出现进度条。<br>
<br>
偶尔出现不好判断，不好判断和什么有关，只能再排查观察下。<br>
<br>
43.<span style="color:blue;font-weight:bold">edge 和谷歌浏览器能打开打印，但是360和IE则不能打开的</span><br>
测试参考一下官网样例http://www.c-lodop.com/LodopDemo.html<br>
官网样例是混合部署LodopFuncs.js里已经写好了判断。<br>
客户端是浏览器支持np插件，是32位浏览器，就会提示下载32位的Lodop插件：install_lodop32.exe<br>
客户端浏览器支持np插件，是64位浏览器，就会提示下载64位的Lodop插件：install_lodop64.exe<br>
客户端浏览器不支持np插件（判断如高版本谷歌火狐等），会提示下载C-Lodop方式： <br>CLodop_Setup_for_Win32NT.exe<br>
<br>
如果是混合部署，IE，360兼容模式等走的是lodop插件方式。<br>
<br>
44.<span style="color:blue;font-weight:bold">上一个请求在忙，请稍后重试</span><br>
参考http://www.c-lodop.com/faq/pp27.html<br>
<br>
调试下JS，排查这个提示的来源。<br>
<br>
45.<span style="color:blue;font-weight:bold">ESPON 的纸张size有问题，DAS 的正常</span><br>
“可打区域”边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br>
http://www.c-lodop.com/faq/pp26.html<br>
size是可打区域<br>
<br>
“可打区域”边缘与打印机本身有关，不同打印机可打区域可能不同。<br>
参考http://www.lodop.net/faq/pp17.html<br>
<br>
预览页面，右键显示标尺查看下，顶边距和左边距是否是以纸张边缘为基点的。<br>
<br>
默认以可打区域为基点，加了纸张边缘为基点，会按照纸张边缘为基点。<br>
<br>
查看下代码设置的顶边距，和左边距。<br>
如果是设置了以纸张边缘为基点，会按照纸张边缘为基点定位。<br>
<br>
或用打印维护，针对不同的客户端进行微调，结果在客户端本地。<br>
<br>
只要能达到自己的合适效果就行。可以以纸张边缘为基点。<br>
<br>
“可打区域”边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br>
http://www.c-lodop.com/faq/pp26.html<br>
size和打印机有关。<br>
<br>
size和打印机有关。<br>
用虚拟打印机测试下，虚拟打印机无可打区域<br>
<br>
参考http://www.lodop.net/faq/pp17.html<br>
<br>
纸张边缘为基点，内容留足边距在可打区域范围内。<br>
或用打印维护本地调整。<br>
<br>
46.<span style="color:blue;font-weight:bold">把网页打包，出现试用版</span><br>
参考排查一下http://www.c-lodop.com/faq/ph01.html<br>
（小问答大段）<br>
<br>
购买的是什么类型的，如果是ip或域名注册类型，访问的是否是注册的ip或域名<br>
<br>
浏览器地址栏的地址是否是该域名。<br>
<br>
就是打印所在页面浏览器地址栏的地址，是否是注册的地址。<br>
如果内部是本地路径，或localhost或127.0.01，是没注册过的这种，确定下地址，或注册公司名。<br>
<br>
验证的是浏览器地址栏的地址。需要访问的是那个地址，并确保注册语句执行了。<br>
<br>
排查下非网页版内部访问的地址是哪个。<br>
如果内部是本地路径，或localhost或127.0.01，确定地址，或注册公司名。<br>
<br>
BS架构的内部也是有网页内嵌的方式的，排查下内部的访问地址。<br>
如果是CS架构的，或内部是本地路径，或localhost或127.0.01，，或注册公司名。<br>
<br>
这个访问地址是自己的路径地址。<br>
或注册公司名，本地路径等，不限ip域名，CS架构的等都可以使用。<br>
<br>
CS架构的注册公司名，公司名不限制了，什么地址都行。<br>
<br>
CS架构，这种只能注册公司名<br>
<br>
域名顶级，验证的也是浏览器地址栏的地址。<br>
<br>
CS架构的没有经过web访问地址，只能注册公司名的。<br>
<br>
47.<span style="color:blue;font-weight:bold">出现试用版</span><br>
参考排查一下http://www.c-lodop.com/faq/ph01.html<br>
（小问答大段）<br>
<br>
访问的是否是注册的ip或域名<br>
<br>
查看下浏览器地址栏访问的是否注册的地址<br>
<br>
先确保该注册语句执行了，每个打印方法里都要执行。<br>
可以先做个简单例子测试下，<br>
例如：<br>
LODOP.PRINT_INIT("打印任务名"); <br>
LODOP.ADD_PRINT_TEXT(0,0,100,20,"文本内容一");<br>
LODOP.SET_LICENSES........<br>
LODOP.PRINT(); <br>
直接放到PRINT()语句前面测试下。<br>
只要调用到就行，可以先做个简单例子测试下<br>
<br>
只要每次打印调用到就行，可以先做个简单例子测试下<br>
可以先这样写测试下。<br>
<br>
只要每次打印的时候都调用到就行，也可以自己写方法统一调用。<br>
<br>
可能是调用问题，调试下JS，排查原因。<br>
<br>
正常在lodopFuncs.js这里，获取LODOP对象的时候会统一调用到。<br>
<br>
getLodop方法在lodopFuncs.js里。下载中心发行包里http://www.c-lodop.com/download.html<br>
<br>
没用getLodop方法。<br>
查看下是否是用了欢迎页面的方式，http://localhost:8000/<br>
<br>
是不是页面直接加了&lt;script src='http://localhost:8000/CLodopfuncs.js'>&lt;/script><br>
<br>
lodopFuncs.js里动态引用了这个。<br>
<br>
单独c-lodop，http://www.c-lodop.com/faq/pp34.html<br>
<br>
根据需要确定使用方法，一般建议用lodopFuncs.js，里面写好了一些判断和提示。<br>
如需单独用c-lodop，可以参考链接修改。<br>
<br>
是不是页面直接加了&lt;script src='http://localhost:8000/CLodopfuncs.js'>&lt;/script><br>
页面直接加了这种，就可以直接用LODOP对象，不用getLODOP，去掉这个，直接用lodopFucs.js，就可以用里面方法。<br>
<br>
调试JS，排查代码。<br>
<br>
lodop.js这个JS是自己写的吗<br>
<br>
下载中心发行包里的lodopFuncs.js改名后的吗<br>
<br>
用下载中心发行包里最新的lodopFuncs.js<br>
<br>
needCLodop是判断，判断后会执行getLODOP函数，<br>
如果页面有clodopFuncs.js之类的引用，去掉。<br>
<br>
参考http://www.c-lodop.com/faq/pp23.html<br>
lodoFuncs.js里动态引用了clodopFuncs.js<br>
<br>
48.<span style="color:blue;font-weight:bold">提示“Web打印服务CLodop未安装启动，点击这里下载执行安装”</span><br>
Lodop页面总提示"未安装"或"请升级"的可能原因 参考http://www.c-lodop.com/faq/pp2.html<br>
<br>
双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启后刷新页面。<br>
<br>
http网站，还是https的<br>
<br>
访问http://localhost:8000欢迎页面试试<br>
<br>
（图）<br>
点预览试试<br>
<br>
欢迎页面正常，说明安装启动正常，对照欢迎页面或样例排查代码。<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
如果样例正常，样例页面右键查看源码 ，参考样例的使用方法。<br>
<br>
对照样例排查代码，<br>
调试自己的JS，查看JS的报错信息<br>
<br>
联系一下你所使用网站的开发技术人员，让他们排查一下。<br>
<br>
需要联系下网站的开发或技术人员。<br>
如果是http的网站，不需要https的这个修改。<br>
<br>
49.<span style="color:blue;font-weight:bold"> 分页问题，只要用两个table 兼容性就有问题</span><br>
做个简单例子，发过来，这边测试下。<br>
两个table是两个打印项，还是一个超文本打印项里有两个table。<br>
<br>
第二个table的是关联了第一个table吗<br>
<br>
多个对象顺序关联后形成“关联串”，这个“串”分页时在每页高度以第一个对象为准<br>
第一个对象高度设置足够大，分页高度按照这个分页。<br>
<br>
http://www.c-lodop.com/demolist/PrintSample41.html<br>
增大第一个打印项的高度，<br>
第二个根据需要设置就行。<br>
<br>
(图）<br>
例如，这个两个表格，第一个表格设置34，可以看到是按照这个高度自动分页的。<br>
关联串可以看做一个整体。<br>
<br>
（图）<br>
如图，分了很多也，根据的是第一个打印项的高度分页。<br>
<br>
（图）<br>
增大第一个打印项的高度，（关联串的第一个），会减小分页的页数，增大整个的超文本的打印项分页高度。<br>
<br>
后面的位置是根据前面的打印项定位的，设置具体的高度。<br>
实际分页的高度可以两个看做一个超文本串。实际分页以第一个打印项高度分页。<br>
<br>
和可打区域，纸张等也有关系。<br>
可以减小或增大打印项分页高度到合适的值。<br>
<br>
可打区域lodop控制不了。<br>
留出足够边距，会用打印维护等本地调整。<br>
或参考样例30，直接手动分页，不用自动分页，自己控制每页的内容。<br>
<br>
50.<span style="color:blue;font-weight:bold">本地图片背景图，走不过去了</span><br>
参考http://www.c-lodop.com/demolist/PrintSample9.html<br>
测试下样例<br>
<br>
路径里是有中文吗，尽量都用英文的<br>
<br>
改成全英文路径试试，直接在样例9里试试。<br>
<br>
走不过去，调试JS，是有什么报错，<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample9.html<br>
直接测试下样例9试试<br>
（图）<br>
<br>
CS架构的吗，是否有什么报错。<br>
<br>
是CS架构的，还是BS架构的。<br>
如果是BS架构的，样例右键，参考样例的写法。<br>
<br>
只有背景图有问题吗，一个任务输出一个add_print_text测试下。<br>
<br>
（图）<br>
进入打印设计，点打印设计的装载背景图测试下<br>
<br>
（图）<br>
打印设计如果装载背景图成功了，再生成代码，拷出来测试下。<br>
<br>
再点下方的再次进入打印设计查看下<br>
<br>
设置预览显示背景图<br>
点设计的预览查看下效果<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample9.html<br>
里的4，预览包含背景图<br>
LODOP.SET_SHOW_MODE("BKIMG_IN_PREVIEW",true);<br>
<br>
换其他图片测试下，比如减小图片的质量，或换成小图对比测试。<br>
或参考样例38，把图片转成base64码加载测试下。<br>
<br>

</div>
</div><!--main_middle结束-->
        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
