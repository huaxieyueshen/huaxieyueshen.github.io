<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>【非常见问题杂笔记】pdf缩放，多批任务顺序，凌晨定时重启等</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-【非常见问题杂笔记】pdf缩放，多批任务顺序，凌晨定时重启等</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../qa_notes2.html"><div class="menuitem"><span style="color:blue;">问答等记录笔记，具体问题</span></div></a>
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【非常见问题杂笔记】pdf缩放，多批任务顺序，凌晨定时重启等</h1>
1.<span style="color:blue;font-weight:bold">PDF原来是纵向的，打印变成横向的了</span><br>
可在欢迎页面测试下这个文件http://localhost:8000/c_pdfprint<br>
<br>
（图示）<br>
这边测试是这样的，用的A4纸张<br>
<br>
可以设置旋转试试
LODOP.ADD_PRINT_PDF(0,0,"100%","100%",XXXX);<br>
LODOP.SET_PRINT_STYLEA(0,"Angle",-90);<br>
（图示）<br>
<br>
这边测试用的是A4纸张，默认纸张。<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
<br>
纸张需要设置，不支持自动识别纸张，pdf在纸张中的大小有三种缩放模式，默认是缩小大页面，当pdf大于纸张时缩小，当pdf小于纸张时，原pdf大小显示。也有其他缩放模式。<br>
<br>
可以根据自己纸张的需要决定旋转角度和旋转方向。<br>
<br>
发一下纸张语句，这边测试下。<br>
<br>
那个是纸张不定高，只有一些小票打印机等支持。<br>
建议用实际的纸张大小设置纸张。<br>
<br>
发一下纸张语句，实际纸张是怎样设置的，<br>
<br>
纸张设置看起来是瘦长的，是否纸张宽高设置反了。<br>
<br>
（图片）<br>
如果进纸方向是反的，那么纸张设置可以是瘦长的这种60mmX100的。纵向打印。<br>
<br>
横向纵向 参考http://www.c-lodop.com/blogs/Blog010.html<br>
进纸是宽边进去吗，参考链接，设置合适的纸张宽高。<br>
<br>
（图）<br>
宽度这个边进去，如图这种吗，纸张设置100X60mm的。<br>
<br>
设置纸张后，用该真实打印机预览下，查看下该打印机是否支持了这个自定义纸张。<br>
预览下方状态栏可以看到纸张大小。<br>
<br>
不行是指自定义纸张没生效吗，进入真实打印机打印预览下方查看下。<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。 选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
<br>
每种大小的尺寸自定义纸张，都在需要的打印机上测试下。<br>
<br>
2.<span style="color:blue;font-weight:bold">重启电脑、重新安装打印控件，均不生效。另：能打开8443这个页面。</span><br>
https://localhost.lodop.net:8443<br>
这个地址是否能正常访问，且是安全的。在这个欢迎页面测试下。<br>
<br>
在这个页面点预览，或切换打印机等测试下。<br>
<br>
是指用的旧版本吗，用的版本是多少<br>
<br>
这个太旧了，访问https://localhost:8443欢迎页面试试<br>
高版本的谷歌等应该不支持这个证书了，火狐也不认这个证书，试试旧版本的欢迎页面。<br>
<br>
在这个旧版本的谷歌上访问下旧的地址试试https://localhost:8443
测试这个页面的预览，选择打印机等试验。<br>
<br>
测试下样例7，如果样例7的选择打印机正常，参考样例7右键查看源码，给打印机指定语句加判断试试，防止走下一个优先级。<br>
<br>
直接测试下样例7试试，调试JS，排查指定的打印机是否正常，调用打印机语句的位置是否正常，<br>
调用打印机语句在初始化init或inita之后，print之前。<br>
<br>
 https://localhost:8443页面如果提示不安全，可以添加到浏览器例外等方式，或升级到最新版用新地址 。<br>
<br>
 https://localhost:8443页面如果不显示打印机列表，排查操作系统打印机列表是否正常。<br>
<br>
https://localhost:8443这个是欢迎页面，旧版本的需要测试这个地址是否正常访问，这个地址正常了才能打印。<br>
<br>
测试下样例7，之前的版本太旧了，不好判断，测试样例7指定打印机是否正常。<br>
<br>
参考http://blog.sina.com.cn/s/blog_721e77e50102z33a.html<br>
安装最新版c-lodop的4101或之后的版本，并参考链接修改JS地址。<br>
新版本https的需要修改地址<br>
<br>
网站是http的还是https的。<br>
<br>
调试JS，跟踪下代码，是否有报错提示。<br>
<br>
这个地址会跳转到新地址，但是新版本，这个localhost应该会提示不安全。<br>
<br>
3.<span style="color:blue;font-weight:bold">调整后  如何实时获取到代码？  还是说只能通样例36的获取</span><br>
获取代码，样例35，样例36.<br>
可以是样例36的这个，也可以是样例35的关闭打印设计的返回值。<br>
<br>
不支持自动实时的，只有这两种方式。<br>
<br>
4.<span style="color:blue;font-weight:bold">CS应用没有问题，但是只要执行Lodop.LodopX PRLodop = new LodopX();应用程序池里应用就会死掉</span><br>
参考上面其他客户反馈的使用方法，引用ocx文件试试。<br>
<br>
可以在需要使用的电脑本地安装后，引用安装路径下的该ocx文件。<br>
<br>
报错的提示是什么，是提示没有注册类吗<br>
<br>
不好判断，上面的都是其他客户反馈的，没有CS的例子。<br>
或者只输出一个add_print_text测试下。<br>
<br>
插件方式可参考lodop技术手册，修改安装文件的名字，前面加un，变成卸载文件。<br>
<br>
5.<span style="color:blue;font-weight:bold">这个文本框遇到-就折行，一行都没有占满就自动折行了</span><br>
打印项是什么语句输出的，是add_print_text纯文本，还是add_print_htm超文本<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample6.html<br>
设置这个：LODOP.SET_PRINT_STYLEA(0,"TextNeatRow",true);//允许标点溢出，且英文单词拆开。<br>
<br>
6.<span style="color:blue;font-weight:bold">每个电脑都引用localhost这个地址吗</span><br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
是的，第一种角色，每个客户端都安装，用的是每个客户端本地的c-lodop。<br>
<br>
最新版是双端口，8000和18000一个能用就行。<br>
（图示）<br>
http的是这两个端口。<br>
<br>
7.<span style="color:blue;font-weight:bold">如何打印pdf文件</span><br>
官网下载中心，下载最新的C-lodop<br>
http://www.c-lodop.com/download.html<br>
安装后在欢迎页面末尾找“PDF打印”链接，或输入地址: <br>
http://localhost:8000/c_pdfprint<br>
<br>
http://localhost:8000/c_pdfprint<br>
安装后这个地址下有例子<br>
<br>
安装最新版c-lodop启动成功后，浏览器访问这个地址http://localhost:8000/c_pdfprint<br>
<br>
安装的c-lodop版本是多少<br>
<br>
目前只有c-lodop支持pdf打印。<br>
<br>
插件方式目前不支持pdf打印，安装c-lodop版本。<br>
<br>
4.0后的版本可以支持pdf打印。<br>
<br>
lodop插件方式不支持pdf打印。参考http://www.c-lodop.com/blogs/Blog021.html<br>
<br>
支持这三种方式，可参考欢迎页面（图）<br>
<br>
8.<span style="color:blue;font-weight:bold">是不是只需要在服务器端装插件就行了   客户的机子需要装么</span><br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
第一种角色，服务器端不安装，每个客户端都安装，用的是每个客户端本地的c-lodop。<br>
<br>
第一种角色每个客户端都需要安装。服务器可引用lodopFuncs.js提示客户端下载安装。<br>
<br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
<br>
在哪儿打印就在哪儿安装。如果客户本机不打印，可以后两种角色打到其他电脑上，其他电脑上安装。<br>
<br>
客户端本地的c-lodop。<br>
obj的那个不用加也可以，参考官网样例页面，右键查看源码，可引用lodopfuncs.js。<br>
<br>
可以混合部署，也可以单独使用c-lodop.<br>
混合部署：<br>
官网样例http://www.c-lodop.com/LodopDemo.html<br>
官网样例是混合部署LodopFuncs.js里已经写好了判断。<br>
客户端是浏览器支持np插件，是32位浏览器，就会提示下载32位的Lodop插件：install_lodop32.exe<br>
客户端浏览器支持np插件，是64位浏览器，就会提示下载64位的Lodop插件：install_lodop64.exe<br>
客户端浏览器不支持np插件（判断如高版本谷歌火狐等），会提示下载C-Lodop方式： CLodop_Setup_for_Win32NT.exe<br>
单独部署c-lodop:<br>
单独c-lodop，http://www.c-lodop.com/faq/pp34.html<br>
<br>
可以，单独c-lodop，http://www.c-lodop.com/faq/pp34.html<br>
<br>
参考lodopFuncs.js里的判断，会提示下载安装，放置安装文件到自己项目里，修改lodopFuncs.js里的提示下载的路径，客户根据提示点击下载安装。<br>
<br>
下载中心发行包里有这个JS，http://www.c-lodop.com/download.html<br>
是的。<br>
<br>
lodopFuncs.js里判断，哪些用lodop，哪些用c-lodop，都返回true，可以都用c-lodop。<br>
<br>
lodopFuncs.js里面动态引用了。<br>
<br>
这个是例子文件，也可以自己修改，里面已经写好了判断安装和判断升级的提示。<br>
<br>
（最近问服务器和客户端安装的好像多了，以后把它整理到常见的位置，很久以前常见，前段时间不太常见，所以经常打字回复）<br>
<br>
9.<span style="color:blue;font-weight:bold">标签打印机获取不到 JOB</span><br>
是指job代码吗，测试下样例45 http://www.c-lodop.com/demolist/PrintSample45.html<br>
如果有其他打印机驱动，用其他打印机也测试下。<br>
<br>
删除打印机驱动，重装打印机驱动试试，咨询下打印机客服关于这些打印机驱动试试。<br>
<br>
可以测试下其他打印机和其他打印机驱动。<br>
<br>
可能和这个打印机或打印机驱动有关，重装打印机驱动试试。<br>
<br>
不好判断，清理下浏览器缓存试试。<br>
咨询下打印机客服试试。<br>
<br>
10.<span style="color:blue;font-weight:bold">提示,请关闭浏览器重试，A call to an OS function failed</span><br>
按照提示关闭浏览器重试一下，这个错误是什么时候发生的，是否有能还原问题的简单例子 ，并用最新版测试下。<br>
<br>
11.<span style="color:blue;font-weight:bold"> 针式打印机打印一般怎么设置？</span><br>
选择打印机，参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
打印机优先级，参考http://www.c-lodop.com/blogs/Blog002.html<br>
<br>
（图）<br>
加了以纸张边缘为基点，可以去掉这个，以可打区域为基点，放置内容超出可打区域。<br>
<br>
12.<span style="color:blue;font-weight:bold">Lodop在打印预览页面是否支持复制里面的文字</span><br>
不支持在打印预览里复制文字。<br>
<br>
（本来还打了点字，但是这人回复了，所以就不用继续回复了，估计只是来询问下而已，他应该已经测试过了预览界面不能复制）<br>
<br>
13.<span style="color:blue;font-weight:bold">可以只预览吗 </span><br>
可以，参考样例2等，把打印设计语句改成打印预览语句。<br>
<br>
内嵌吗，参考样例22，ie等支持内嵌的浏览器可以。<br>
<br>
14.<span style="color:blue;font-weight:bold">银河麒麟系统需要.deb的包。请问你们有这个安装包吗</span><br>
没有，安装下下载中心的版本试试，参考http://www.c-lodop.com/download.html<br>
linux版，在下载中心其他版本里<br>
<br>
15.<span style="color:blue;font-weight:bold">可以给 printText  加背景颜色吗</span><br>
可以设置实心矩形，设置矩形颜色，<br>
文本项在实心矩形后面输出，后输出的的打印项在上层。<br>
<br>
16.<span style="color:blue;font-weight:bold">提示“网页还没下载完毕，请稍等一下再操作.”</span><br>
参考http://www.c-lodop.com/faq/pp3.html 新版修改了该提示，是同一问题，参考链接里的方法。<br>
<br>
参考http://www.c-lodop.com/faq/pp3.html<br>
参考链接里的方法，如果是一进入页面就打印，参考样例22，等c-lodop准备好再打印。<br>
如果是点击后打印，参考样例，点击后再获取lodop对象。<br>
<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
如果样例正常，样例页面右键查看源码 ，参考样例的使用方法。<br>
<br>
操作系统的打印机列表是否有打印机存在。<br>
<br>
进入页面稍等一会再点击试试。<br>
<br>
(虽然有整理的问答，但是还是打字弄了个简短但是两种方式都包括的问题，不知道对方写法的情况，对方又不想看太长的情况，感觉这个回复前面还可以，再整理下。）<br>
<br>
17.<span style="color:blue;font-weight:bold">clodopFuncs.js访问不到</span><br>
http://localhost:8000/点欢迎页面的预览试试<br>
<br>
（图）<br>
选个其他正常的打印机进行预览试试<br>
<br>
xps或pdf虚拟打印机也可以，如果有真实打印机驱动，可以用真实打印机驱动预览<br>
<br>
点预览试试，如果欢迎页面正常，对照欢迎页面和样例排查代码。<br>
<br>
说明安装启动正常，对照样例和欢迎页面排查自己的代码。<br>
<br>
欢迎页面加载速度是否正常，是的，安装启动后自动生成的。<br>
<br>
安装启动后就可以正常访问，是的，安装启动后自动生成的<br>
<br>
参考http://www.c-lodop.com/faq/pp23.html<br>
不能那样使用，需要用通过端口动态访问。<br>
<br>
参考http://www.c-lodop.com/faq/pp23.html<br>
不要引用本地路径的，用动态生成的这个路径的。通过localhost和端口访问。<br>
<br>
参考http://www.c-lodop.com/faq/pp23.html<br>
如果判断为使用c-lodop，里面会动态引用。<br>
<br>
只要安装启动成功，这个clodopFuncs.,js就能访问到，http://localhost:8000/<br>
<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
如果样例正常，样例页面右键查看源码 ，参考样例的使用方法。<br>
<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
测试下样例是否正常，第一次进入页面是有websoke准备时间，但是很短，参考http://www.c-lodop.com/faq/pp3.html<br>
<br>
测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
测试下样例加载是否卡，这边测试速度还是挺快的。<br>
<br>
正常不会加载一分多钟，测试官网样例http://www.c-lodop.com/demolist/PrintSample2.html<br>
样例的加载时间是否正常。<br>
<br>
官网样例正常，应该和自己的代码其他地方有关，对照样例做简单例子或筛查自己的代码，是否是自己的其他代码影响了。<br>
<br>
18.<span style="color:blue;font-weight:bold">用最新版，样式有变化</span><br>
打印项是什么语句输出的，是add_print_text纯文本，还是add_print_htm超文本<br>
<br>
是超文本输出的吗，如果是超文本，排查样式<br>
<br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
分析差异点，因浏览器版本不同遵循的html标准不同，造成某些标签属性显示有差异，尽量避免使用有差异的属性，可以在ie下不同版本仿真情况下验证差异 排查样式，尽量使用使用各浏览器无歧义的通用的 html css js，不支持的样式可尝试用其他样式代替。<br>
<br>
可尝试把ADD_PRINT_HTM 换成 ADD_PRINT_HTML（图形模式）试试，ADD_PRINT_HTML不如ADD_PRINT_HTM清晰，适合高精度的打印机，两者各有优势。<br>
<br>
如果是必现问题，可以删减内容，做个简单例子发过来，这边测试下。<br>
<br>
用的本机底层引擎解析的超文本，如果是必现问题，可以做个简单例子，这边测试反馈下。<br>
<br>
如果只有那个客户有问题，可能和那个客户端有关。<br>
在该客户端排查下试试。<br>
<br>
如果都有问题，做个能还原问题的简单例子发过来，这边测试下。<br>
<br>
需要个能还原问题的例子进行反馈。<br>
<br>
18.<span style="color:blue;font-weight:bold">有个技术想进群可以帮忙进下不</span><br>
可以群里的人邀请加入，也可以申请验证加入。<br>
<br>
没有收到验证消息，再加一下试试。还有个P群，也加一下试试http://www.c-lodop.com/about.html<br>
<br>
是这个吗，XXX，大约是什么时候购买的，这边没有查到这个公司名<br>
<br>
如果当时购买的是ip或域名，也可以发一下ip或域名，或验证消息输入收注册号邮箱。<br>
并排查注册的公司名是否是这个XXX，<br>
<br>
这边可以查到14年10月之后的，大约是什么时候购买的<br>
<br>
已同意加入，测试这个注册号是有效的。<br>
<br>
19.<span style="color:blue;font-weight:bold">打印设计里面的字体种类就只有那几种么，仿宋gb2312字体</span><br>
字体获取的是本机windows系统安装的字体，查看下缺少的字体，安装下字体试试。<br>
<br>
查看下本机的windows字体库里的字体<br>
<br>
（图）<br>
如果没有这个字体，在网上下载一个，安装一下试试。<br>
<br>
（个人查看自己操作系统，自己操作系统没这个字体，在网上下载了个gb2312的字体，防止之后有人需要，该字体在桌面名为4099的文件夹里）<br>
<br>
相关链接：（以前的cnblog里的博文） <a href="https://www.cnblogs.com/huaxie/p/9923162.html" style="color:blue">LODOP打印安装到win的特殊字体</a>。<br>
<br>
20.<span style="color:blue;font-weight:bold">火狐有做TLS1.2的强制改动吗？</span><br>
旧版本的火狐也会有问题，火狐不认localhost证书，需要添加例外。<br>
<br>
如果火狐也有问题，也可以更新到最新版，用新地址。<br>
<br>
21.<span style="color:blue;font-weight:bold">用户浏览器不支持lodop插件，需要加载clodop这样直接打印会有水印吗</span><br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
lodop注册号对c-lodop第一种角色客户端本地角色默认有效。可以去c-lodop客户端本地打印角色的水印。<br>
<br>
对这种角色的c-lodop去水印有效。<br>
<br>
22.<span style="color:blue;font-weight:bold">PDF条码打印出来锯齿严重</span><br>
发一下有问题的pdf文件，这边测试下。<br>
<br>
(图示）<br>
用虚拟打印机打印成xps文件看上去还可以。<br>
是否有其他打印机，如激光打印机等，用其他打印机测试下。<br>
<br>
用样例11的lodop方式输出条码试试，试试那种lodop输出条码打印项的清晰度是否正常。<br>
<br>
这边用xps虚拟打印机输出清晰度还可以。<br>
用其他打印机输出测试下，如激光打印机。<br>
<br>
不好判断，可能和原始pdf条码的生成有关，也可能和打印机有关。<br>
用的c-lodop版本是多少，是否是最新版4114.<br>
<br>
不好判断，看输出的xps文件清晰度还可以。<br>
如果用激光打印机等，可能会更清晰些。<br>
<br>
23.<span style="color:blue;font-weight:bold">打印太长了，强制截位哪个参数</span><br>
是指纸张过长，还是内容过长。<br>
如果是内容，用add_print_text输出的，超过打印项宽度，高度不够，会隐藏后面的内容。<br>
<br>
如果是内容过长，超文本输出，可以用css样式控制超出隐藏或截取，传入css样式，参考样例10.<br>
是的，纯文本减小打印项高度，超过高度的文本会隐藏。<br>
<br>
根据需要设置，可以在打印设计里选中这个打印项调整高度测试下，然后预览，调整到合适的打印项高度。<br>
<br>
24.<span style="color:blue;font-weight:bold">提示：Paper size(W:0 H:0)invalid!</span><br>
去掉纸张语句测试下，有的打印机不支持设置的该自定义纸张。<br>
修改纸张语句参数直到这个打印机正常。<br>
<br>
不是INITA，纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
<br>
（图示，样例5截图）<br>
没有设置，应该会走默认纸张，在样例5里选择该打印机的一些自带的纸张样例测试下。<br>
<br>
25.<span style="color:blue;font-weight:bold">竖条码打印出来扫不到</span><br>
竖条的条码是怎样生成的，测试下样例11，用样例11的方式输出试试，影响条码识别率的可能原因 <br>http://www.c-lodop.com/faq/pp6.html<br>
<br>
是用的样例11的方式输出的吗，用样例11的方式输出试试，响条码识别率的可能原因 http://www.c-lodop.com/faq/pp6.html<br>
<br>
26.<span style="color:blue;font-weight:bold">横版的pdf打印可以扭转吗？</span><br>
进入欢迎页面测试下http://localhost:8000/c_pdfprint<br>
如果想旋转pdf，可以用这个语句<br>
LODOP.SET_PRINT_STYLEA(0,"Angle",-35);<br>
<br>
发一下这个有问题的pdf文件，这边测试下。<br>
<br>
有的横向的pdf会自动变成适应的方向。<br>
发一下这个pdf文件，这边测试下，如果不行，可以加旋转控制。<br>
<br>
（图）<br>
横向纵向 参考http://www.c-lodop.com/blogs/Blog010.html<br>
设置打印方向，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
可以设置下内容方向为横向，在纸张语句里设置参数。<br>
<br>
27.<span style="color:blue;font-weight:bold">历史打印任务在哪里查询</span><br>
lodop没有记录历史任务，如果是c-lodop的日志信息：<br>
最新版c-lodop试试http://www.c-lodop.com/download.html<br>
开启日志功能，查看下日志是否正常。<br>
日志功能，在端口设置界面的右键菜单里勾选 Run Logs<br>
日志存放目录：MountTaiSoftware/CLodop32/Logs，保留最新7天日志，每天不超过200k（约2千条）<br>
日志有对话REQUEST类和打印PRINTED类两类成功日志(暂无失败日志)，<br>
前者保存了请求目的、对方IP、对话协议、对话端口和对话时间;<br>
后者保存了打印机名、打印标题、打印任务页数、打印份数、打印时间；<br>
<br>
28.<span style="color:blue;font-weight:bold">为什么重新开启打印插件就好了。 而且三点前是正常打印的</span><br>
默认会凌晨三点定时重启，安装最新版测试下http://www.c-lodop.com/download.html<br>
以管理员权限重新安装试试。是否是定时重启权限不足等原因。<br>
<br>
12、http://localhost:8000/c_options       设置显示选项(需注册)<br>
<br>
c-lodop的D注册号可设置。<br>
这个是针对云主机凌晨定时重启的。<br>
<br>
D注册号，可以关闭云主机的凌晨定时重启。<br>
<br>
三种角色及使用方法：<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
后两种角色的云主机的注册号。<br>
<br>
这个凌晨定时重启是针对云主机的，进一步确保云主机的c-lodop的启动。<br>
<br>
先安装最新版4114测试下，以管理员权限安装。<br>
重启不会影响打印，再测试下。<br>
<br>
访问http://localhost:8000/c_sysmessage，查看clodop出错信息<br>
<br>
出问题的时候访问下这个页面，http://localhost:8000/c_sysmessage，查看clodop出错信息<br>
查看下是否有报错信息。以管理员重装c-lodop测试下。<br>
<br>
以管理员权限重启下c-lodop，刷新这个错误页面<br>
<br>
可以桌面上的快捷方式，右键以管理员权限运行。<br>
<br>
刷新错误页面，查看错误页面错误是否消失，这个错误是权限问题。<br>
<br>
这个报错的是写入的的权限问题。<br>
用最新版c-lodop测试下，以管理员权限安装运行。<br>
<br>
凌晨重启不会影响打印。<br>
<br>
（因问的比较少，忘了在问答哪个位置和具体地址，临时去c-lodop技术手册复制的，需在整理问答到明细位置）<br>
<br>
29.<span style="color:blue;font-weight:bold">  通过URL 打印快呢 还是 自己手动绘制快呢</span><br>
由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(Cookies)，所以需要安全验证的页面不要用URL方式打印，<br>要用页面已经下载好的内容的HTM方式打印，也就是ADD_PRINT_HTM或ADD_PRINT_TABLE等语句<br>
另外URL方式需要二次访问服务器，理论上存在下载失败的可能，所以专业的管理系统尽量不要用URL方式。<br>
<br>
建议用已经加载后的超文本。<br>
或用纯文本画线输出，这种最快，使用ADD_PRINT_TEXT等纯文本和画线进行设计，这种不受浏览器引擎解析的影响。<br>
参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
<br>
可以是html也可以是纯文本，可根据需要设置。<br>
都可以通过传入变量等控制。<br>
<br>
纯文本+线输出表格：ADD_PRINT_TEXT、ADD_PRINT_LINE<br>
画线输出表格，参考http://www.c-lodop.com/demolist/PrintSampleA1.html<br>
<br><br>
如果表格行间距等比较固定，也可以用纯文本，根据需要选择纯文本或超文本都可以。<br>
<br>
30.<span style="color:blue;font-weight:bold">打印维护加了这行 LODOP.SET_PRINT_STYLEA(1,"ReadOnly",0); 还是不能编辑内容</span><br>
LODOP.ADD_PRINT_TEXT(90,300,236,35,"可修改的文本内容");<br>
LODOP.SET_PRINT_STYLEA(0,"ReadOnly",0);<br>
LODOP.ADD_PRINT_TEXT(150,301,234,35,"一般文本内容禁止修改");<br>
<br>
对照样例排查代码，SET_PRINT_STYLEA第一个参数是打印项序号，对某个打印项进行设置。1代表第一个打印项，排查要修改的打印项是否是第一个打印项。<br>
<br>
参考lodop技术手册SET_PRINT_STYLEA篇第一个参数的介绍，所有打印项都参与排序。<br>
<br>
用SET_PRINT_STYLE全局控制<br>
<br>
SET_PRINT_STYLE放在初始化之后，所有打印项之前调用<br>
<br>
31.<span style="color:blue;font-weight:bold">二维码里的内容为左边显示的内容， 版本为最大14，根本扫不出来</span><br>
增大二维码宽高再扫描试试，如果字符不多，可用其他版本试试<br>
二维码 相对于低容错L 7% 所能输出的最大字符数值参考http://www.c-lodop.com/faq/pp10.html<br>
<br>
32.<span style="color:blue;font-weight:bold">lodop 可以在linux上用吗</span><br>
参考http://www.c-lodop.com/download.html<br>
linux版，在下载中心其他版本里，安装测试下。<br>
<br>
参考http://www.c-lodop.com/download.html<br>
目前支持的功能是，目前仅支持纯文本、图形、图片、条码的预览和打印<br>
<br>
运行 install.sh 或者 直接在linux桌面双击lodop安装试试，目前有些不支持x86指令的cpu不支持。<br>
安装成功启动界面右下角有个欢迎页面也可以进入<br>
或访问http://localhost:8000欢迎页面试试<br>
<br>
33.<span style="color:blue;font-weight:bold">怎么给打印机发送空指令，就是不打印纸张，目的就是为了激活下打印机</span><br>
发送指令，参考http://www.c-lodop.com/demolist/PrintSample17.html<br>
不清楚空指令，咨询下打印机客服试试，<br>
<br>
34.<span style="color:blue;font-weight:bold">为什么打印机不是按照下单的打印任务打印出来</span><br>
调试JS，排查JS的执行顺序是否正常，按照JS的任务顺序输出。<br>
<br>
打印机脱机，查看下任务进入队列的情况。<br>
<br>
或参考样例45的13，http://www.c-lodop.com/demolist/PrintSample45.html，判断上一个任务不在队列后再执行下一个任务。<br>
<br>
会按照顺序执行。<br>
调试JS，排查任务的执行顺序。或每个任务之间加点延迟或定时器试试。<br>
<br>
每个任务之间加点延迟或定时器试试。<br>
是否是前面的任务执行过快等导致的。<br>
<br>
批量打印，分页分任务，在页数和任务之间平衡一下，参考样例<br>26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
<br>
(图示）<br>
参考样例26，创建lodop对象后，循环任务试试。获取LODOP对象在循环外面。<br>
<br>
那么里面就是每次只有初始化和打印，并没有每次获取LODOP对象。
如果单个任务内容较少，参考样例26，分页分任务试试。
<br>
是指循环中途，又添加了其他任务吗
<br>
尽量等着一批打印完，再执行下一批任务的循环。<br>
<br>
不建议这样做，建议一批多个任务循环发送完后，再发送另一批任务。<br>
或在JS判断下试试，前一批的打印完成，再执行后面的一批任务。<br>
<br>
参考样例4,35，判断加入队列算成功，前一批的都成功后，再执行新的另一批任务试试。<br>
<br>
参考样例35 http://www.c-lodop.com/demolist/PrintSample35.html<br>
样例45的13 http://www.c-lodop.com/demolist/PrintSample45.html<br>
样例35返回的“打印成功”实际仅是成功加入后台队列。<br>
样例45的13 判断“JOB不在队列”就足可认定已经打印成功。<br>
一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br>
<br>
直接打印返回逻辑真假结果（1或true代表真，false或0代表假），表示是否成功<br>
c-lodop需要回调函数，写法一致。<br>
<br>
样例4也有演示。和c-lodop技术手册。<br>
<br>
LODOP.On_Return_Remain=true;将回调结果保留，c-lodop任务可通过TaskID区分。<br>
<br>
调试JS，排查代码，是否加了样例45的那句捕获状态，加了那句会变成job代码，去掉那句，参考样例4，直接回调获取返回值。<br>
<br>
35.<span style="color:blue;font-weight:bold">LODOP.PRINTA();会弹出打印机选择页面，如何去掉</span><br>
LODOP.PRINT();不弹出，PRINTA会弹出。<br>
<br>
36.<span style="color:blue;font-weight:bold">能拉我个同事进群嘛，还是需要他自己申请提交</span><br>
您好，您在哪个群里，如果是vip群。<br>
可邀请加入，也可以申请加入。<br>
<br>
申请加入可以填写注册时的验证信息，如收注册号的邮箱等。<br>
参考http://www.c-lodop.com/download.html，目前K群和P群有空。<br>
<br>
37.<span style="color:blue;font-weight:bold">报错：操作失败，请关闭浏览器重试，Error reading images1:Bitmap:Failed to read ImageList data from stream</span><br>
关闭浏览器重试一下，调试JS，排查代码。<br>
<br>
打印的是什么内容，查看下JS报错，是否能做出还原问题的例子，排查是否和打印内容等有关。<br>
<br>
百度下这个提示试试，参考下网上的处理方法，重启浏览器试试。<br>
<br>
参考http://www.c-lodop.com/faq/pp1.html<br>
并排查下链接里的操作失败的条目。<br>
<br>
38.<span style="color:blue;font-weight:bold">通过IP访问打印机</span><br>
获取的是安装到windows操作系统打印机列表的打印机。<br>
<br>
参考样例5、7 http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
测试一样例5,7，是否能获取到该打印机，获取的是安装到windows操作系统打印机列表的打印机。如果获取不到，重新安装打印机驱动试试<br>
<br>
获取的带驱动的打印机。<br>
可测试下样例7试试，如果是共享打印机，可能带有前缀。<br>
<br>
39.<span style="color:blue;font-weight:bold">导出表格电脑是不是必须要有excel</span><br>
导出excel，<br>
参考http://www.c-lodop.com/demolist/PrintSample27.html<br>
参考http://www.c-lodop.com/demolist/PrintSample12.html<br>
<br>
由于lodop采用“Excel.Application”来导出excel，所以要求系统必须安装excel相关软件且非绿色安装那种。<br>
大量复杂的导出建议采用样例12的办法。样例12导出不需要excel支持。打开是转换需要excel支持.<br>
<br>
40.<span style="color:blue;font-weight:bold">发送打印请求，这个间隔是多长时间啊，还是可设置的</span><br>
 可能和很多原因有关：打印内容或样式或图片等过多，有需要下载有脚步执行或本身网络慢；<br>
机器性能过低 系统ie有问题或缓存过多；或使用的是共享打印机。<br>
如果需要延迟打印，可用JS设置延迟或定时器。<br>
<br>
和很多原因有关，打印内容或样式或图片等过多，有需要下载有脚步执行或本身网络慢；<br>
机器性能过低 系统ie有问题或缓存过多；或使用的是共享打印机等。<br>
<br>
和很多原因有关，可以逐个测试下，如果怀疑和内容有关，可用一个add_print_text对比测试。<br>
如果怀疑和打印机驱动有关，可安装其他打印机驱动对比测试。<br>
<br>
41.<span style="color:blue;font-weight:bold">有的打印机显示不全，怎么办？我自定义的纸张</span><br>
进入打印预览查看下，下方状态栏纸张和可打区域是否正常。<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。 选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
<br>
“可打区域”边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br>
http://www.c-lodop.com/faq/pp26.html<br>
<br>
42.<span style="color:blue;font-weight:bold">批量打印二维码，有时中间会出现几张扫码扫不出来的</span><br>
二维码是怎样输出的，用样例11的方式输出测试下。<br>
<br>
发一下二维码语句，这边测试下，是用微信扫描的吗<br>
<br>
如果单个任务打印都是能扫的，批量打印效果是相同的。<br>
对比下能扫和不能扫的二维码，是否有清晰度等差异，是否和打印机有关。<br>
 <br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
用虚拟打印机或其他打印机测试下，排除打印机的影响，<br>
如果虚拟打印机和其他打印机都正常，和该打印机有关。<br>
<br>
单个任务打印都是能扫的，批量打印效果是相同的。执行的都是同样的任务同样的打印项。<br>
用虚拟打印机或其他打印机测试下，排查是否和打印机有关。<br>
<br>
批量打印，参考样例26，每个任务的打印项都要加载上 ，需要变化的用变量，不需要的也可以用具体的数值。<br>
<br>
43.<span style="color:blue;font-weight:bold">打印快递单 加载很慢,打印20个订单 还行,超过不基本就这 出不来了</span><br>
出现进度条，打印过慢，可能和很多原因有关：打印内容或样式或图片等过多，有需要下载有脚步执行或本身网络慢；<br>
机器性能过低 系统ie有问题或缓存过多；或使用的是共享打印机。<br>
如果预览页数多，可以多分一些任务，太多不建议预览，建议直接打印，在任务和页数之间平衡一下，参考样例26 <br>
http://www.c-lodop.com/demolist/PrintSample26.html<br>
<br>
用的是什么打印项输出的,是url吗<br>
由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(Cookies)，所以需要安全验证的页面不要用URL方式打印，要用页面已经下载好的内容的HTM方式打印，也就是ADD_PRINT_HTM或ADD_PRINT_TABLE等语句<br>
另外URL方式需要二次访问服务器，理论上存在下载失败的可能，所以专业的管理系统尽量不要用URL方式。<br>
<br>
如果不是url，分页分任务，可以多分些任务试试，每个任务输出少量的内容。<br>
<br>
需要实际测试，分组分任务。<br>
<br>
44.<span style="color:blue;font-weight:bold">提示“有窗口已打开，先关闭它（持续如此请刷新页面）！”</span><br>
参考http://www.c-lodop.com/faq/pp27.html<br>
<br>
任务里是否有其他返回值，<br>
如果有能还原问题的例子，发一下代码这边测试下。<br>
<br>
45.<span style="color:blue;font-weight:bold">有客户的电脑，在你们lodop demo 页面查看是否安装，然后安装后 在点是否安装还是一直提示无安装</span><br>
测试下这个样例，点预览，查看样例的提示是什么http://www.c-lodop.com/demolist/PrintSample2.html<br>
<br>
Lodop页面总提示"未安装"或"请升级"的可能原因 参考http://www.c-lodop.com/faq/pp2.html<br>
<br>
双击桌面上的c-lodop快捷方式，重启一下本机的c-lodop，重启c-lodop后刷新页面。<br>
<br>
查看下JS里的报错信息<br>
<br>
(图示）<br>
c-lodop启动界面查看下端口是否正常<br>
<br>
访问http://localhost:8000欢迎页面试试<br>
<br>
参考http://www.c-lodop.com/faq/pp5.html<br>
排查链接条目，是否是localhost无法访问问题。<br>
<br>
（图）<br>
访问下这个127.0.0.1的本地试<br>
<br>
并安装最新版4114测试下。<br>
安装或重启c-lodop后刷新页面<br>
<br>
http://localhost:8000<br>
就是把localhost换成ip测试下。<br>
<br>
（图）<br>
并在启动界面进入18000端口试试。<br>
<br>
（图）<br>
这个安装启动界面是否能正常访问<br>
<br>
（图）<br>
点右下角的这个链接试试。<br>
<br>
查看下防火墙或杀毒软件等是否阻挡了，hosts文件是否正常<br>
<br>
45.<span style="color:blue;font-weight:bold">循环打印上百单任务，中间会有一单重复,比如第51单打印出来的是第50单的数据,是循环执行的太快了吗</span><br>
有可能，可以加延迟，或用定时器在任务之间加些间隔时间试试。<br>
并用最新版c-lodop测试下。<br>
<br>
不好判断，再调试下JS，排查是否有内容重复了。<br>
开启日志功能，查看下日志是否正常。<br>
日志功能，在端口设置界面的右键菜单里勾选 Run Logs<br>
日志存放目录：MountTaiSoftware/CLodop32/Logs，保留最新7天日志，每天不超过200k（约2千条）<br>
日志有对话REQUEST类和打印PRINTED类两类成功日志(暂无失败日志)，<br>
前者保存了请求目的、对方IP、对话协议、对话端口和对话时间;<br>
后者保存了打印机名、打印标题、打印任务页数、打印份数、打印时间；<br>
查看下两个日志是否正常，请求和打印日志对比下<br>
<br>
尽量用新版本，并加定时器和延迟试试，试试是否不再有重打任务。<br>
<br>
端口界面右键的菜单里。<br>
需要比较新的c-lodop版本。<br>
<br>
可能是版本过旧，安装最新版打开日志测试下。<br>
<br>
在端口界面空白处右键，会有个菜单显示<br>
<br>
这个是自动重启c-lodop的功能。安装c-lodop版本是多少<br>
<br>
最新版是4114，参考http://www.c-lodop.com/download.html<br>
<br>
46.<span style="color:blue;font-weight:bold">服务器原始IP是153开头的，但经过策略转成了172开头，应该是买哪一个</span><br>
浏览器的地址栏访问的是哪个<br>
<br>
IP和域名注册，根据浏览器地址栏访问方式注册，P访问，注册IP；域名访问，注册域名；不限IP域名，可做企业名称注册。<br>
（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。<br>
（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名： www.c-lodop.com 登陆方式如下：http://www.c-lodop.com/index.html等，ip地址访问时，注册信息无效<br>
<br>
验证的是浏览器地址栏的访问地址，注册访问地址的那个。<br>
<br>
47.<span style="color:blue;font-weight:bold">打印的时候标题和数据是错位的</span><br>
是否是多个表格<br>
1.尽量统一成一个表格。<br>
2.查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
排查样式问题，调试样式 ，更换样式。<br>
用不随容器或内容导致样式不同的影响，不受容器影响，不受内容影响的样式。<br>
<br>
相关链接：（以前的cnblog里的博文） <a href="https://www.cnblogs.com/huaxie/p/11045426.html" style="color:blue">LODOP打印表格错位的几种情况</a>。<br>
<br>
48.<span style="color:blue;font-weight:bold">为什么有时候打印会缓存上一次的打印任务</span><br>
每个任务是否都加了初始化语句INIT或INITA。<br>
调试JS，排查每个任务传入的数据是否正常。<br>
<br>
如果是整个任务都重打了，用最新版对比测试下。<br>
<br>
用最新版clodop对比测试下。<br>
如果多次测试发现是个别打印机不正常，也可能和该打印机有关。每个任务的任务名是否是不同的，也可能和该打印机重复输出了之前的任务。<br>
多个打印机对比测试下试试，用最新版c-lodop试试。<br>
<br>
如果多次测试和个别打印机本身有关，重装打印机驱动试试。<br>
<br>
49.<span style="color:blue;font-weight:bold">提示：Paper size(W:0 H:0)invalid!</span><br>
去掉纸张语句测试下，有的打印机不支持设置的该自定义纸张。<br>
修改纸张语句参数直到这个打印机正常。<br>
<br>
是否是同一个打印机，同样的纸张参数。<br>
<br>
在有问题的那个功能那里，去掉纸张语句测试下。<br>
纸张是怎样设置的，是否是宽高为0，走最后一个参数纸张名称。<br>
<br>
有的打印机会报错宽高为0纸张设置问题。<br>
去掉纸张语句对比测试下。如果去掉纸张语句正常，说明和该语句有关。<br>
可尝试宽高设置具体的数值测试下。
<br>
（另一个客户来反馈了，是因为装了wps,有一个wps的pdf打印机。该客户反馈装了该wps的pdf打印机会报错）<br>
<br>
选择打印机，参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
打印机优先级，参考http://www.c-lodop.com/blogs/Blog002.html<br>
<br>
测试下样例7，用样例7的语句指定下打印机试试。<br>
<br>
（再整理下这个问答，感觉整理和描述的不是特别好，自己经常还是要打字）<br>
<br>
50.<span style="color:blue;font-weight:bold">提示：目标打印机已有程序控制，无法修改</span><br>
参考样例7的7，可重选的打印预览<br>
<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
设置允许重选打印机<br>
<br>
（常用的迷你问答的选择打印机里没有这个，以后在常见的地方整理下，之前的问答有，但是找起来麻烦，最后还是打了下字）<br>
<br>
</div><!--main_middle结束-->
        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
