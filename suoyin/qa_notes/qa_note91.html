<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>【非常见问题杂笔记】累计偏移、canvs条码、自动分页设为页眉页脚不分页等</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-【非常见问题杂笔记】累计偏移、canvs条码、自动分页设为页眉页脚不分页等</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../qa_notes3.html"><div class="menuitem"><span style="color:blue;">问答等记录笔记，具体问题</span></div></a>
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【非常见问题杂笔记】累计偏移、canvs条码、自动分页设为页眉页脚不分页等</h1>
1.<span style="color:blue;font-weight:bold">连续打印，后打印的距上边距每次都小1mm,越来越小  最后直接出去了</span><br>
参考http://www.c-lodop.com/faq/pp17.html，里面的3，<br>
连续打印输出多张，偏移累计越来越大：<br>
<br>
2.<span style="color:blue;font-weight:bold">分页之后打出来的数据是一样的</span><br>
调试JS，排查分页后的打印项语句的参数是否正常<br>
<br>
如果是模版赋值，是否是类名赋值，同一个任务同类名的都会被赋值。<br>
1.按变量形式赋值，参考样例35；<br>
2.按顺序赋值 ，参考样例36<br>
LODOP.SET_PRINT_STYLEA(x,"Content",”赋值内容”);//第一个参数x-给第几个输出打印项赋值，<br>
Content-关键字，第三个参数：输出内容<br>
例如：赋值第1、2、3项内容赋值<br>
LODOP.SET_PRINT_STYLEA(1,"Content","学生证");<br>
LODOP.SET_PRINT_STYLEA(2,"Content","张三");<br>
LODOP.SET_PRINT_STYLEA(3,"Content","王五");<br>
3.按项目类名赋值,项目类型是aa：<br>
LODOP.SET_PRINT_STYLEA(‘aa’,"Content","学生证");//项目类名是aa的所有打印项内容被替换<br>
<br>
可以用其他赋值方式，不用类名赋值。<br>
或拆分成多任务，参考样例26。<br>
<br>
3.<span style="color:blue;font-weight:bold">在内网使用这个怎么买？</span><br>
IP和域名注册，根据浏览器地址栏访问方式注册，P访问，注册IP；域名访问，注册域名；不限IP域名，可做企业名称注册。<br>
（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下<br>http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。<br>
（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名： www.c-lodop.com 登陆方式如下<br>：http://www.c-lodop.com/index.html等，ip地址访问时，注册信息无效<br>
<br>
与内外网无关，验证的是浏览器地址栏的地址，本地验证，不需要外网也可以<br>
<br>
注册号生效会去掉试用版水印<br>
如没去掉，参考排查一下http://www.c-lodop.com/faq/ph01.html<br>
<br>
4.<span style="color:blue;font-weight:bold">操作控件可以静默打印已有的pdf文件吗？</span><br>
控件注册号 注意事项 最新价格表、购买方式和使用方法见(官网)：<br>
http://www.c-lodop.com/Lodop_Lic.html<br>
pdf打印去掉这个弹窗，需要顶级注册。域名顶级或公司名顶级。<br>
去掉pdf的试用版弹窗后，用PRINT输出，PRINT直接打印<br>
<br>
如果想去掉pdf弹出的试用版输出的弹出提示，只能顶级注册，域名顶级或公司名顶级<br>
<br>
官网下载中心，下载最新的C-lodop<br>
http://www.c-lodop.com/download.html<br>
安装后在欢迎页面末尾找“PDF打印”链接，或输入地址: <br>
http://localhost:8000/c_pdfprint<br>
<br>
http://localhost:8000/c_pdfprint欢迎页面演示了三种pdf方式<br>
<br>
5.<span style="color:blue;font-weight:bold">提示没设置默认打印机（英文）</span><br>
参考http://www.c-lodop.com/faq/pp1.html<br>
查看下windows打印机列表是否有打印机，是否指定了默认打印机，指定有效默认打印机试试。<br>
如果本机有共享打印机，删除共享打印机再测试下，共享打印机故障可能会导致一些问题<br>
<br>
6.<span style="color:blue;font-weight:bold">全部字体样式怎么写</span><br>
字体设置方法：<br>
一、整体设置（针对文本项），打印初始化后、增加打印项之前调用本函数<br>
（...字体设置，迷你问答...）<br>
<br>
参考lodop技术手册set_print_style，这句写在打印项之前调用，对后面的纯文本打印项的字体都有效<br>
<br>
参考lodop技术手册LODOP.SET_PRINT_STYLE，整体设置（针对文本项），打印初始化后、增加打印项之前调用本函数<br>
<br>
7.<span style="color:blue;font-weight:bold">打印canvas二维码</span><br>
canvas不是所有浏览器都支持，尽量不用这种样式<br>
<br>
可用lodop语句输出二维码，参考样例11 http://www.c-lodop.com/demolist/PrintSample11.html<br>
<br>
8.<span style="color:blue;font-weight:bold">canvas 控件 能打印出来吗</span><br>
需要实际测试下，<br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
分析差异点，因浏览器版本不同遵循的html标准不同，造成某些标签属性显示有差异，尽量避免使用有差异的属性，可以在ie下不同版本仿真情况下验证差异 排查样式，尽量使用使用各浏览器无歧义的通用的 html css js，不支持的样式可尝试用其他样式代替。<br>
canvas不是所有浏览器都支持，建议用其他方式输出替代<br>
<br>
Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。可尝试升级ie<br>
<br>
Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。升级ie或尝试换其他方式输出。<br>
<br>
是指超文本样式的解析吗，Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。<br>
解析超文本的引擎与当前使用的浏览器无关<br>
<br>
升级ie浏览器，或换用其他方式实现。<br>
<br>
图片，或表格超文本，或图形画线等。<br>
<br>
图片，参考样例8<br>
图形画线纯文本等，参考样例4等<br>
表格超文本参考样例10等<br>
如果是二维码条码，参考样例11<br>
<br>
9.<span style="color:blue;font-weight:bold">打印表格时没有分页，怎么排查，只打印了第一页的内容</span><br>
用的打印项语句是哪个，是add_print_table吗<br>
<br>
如果是add_print_table，这个不切行<br>
用 add_print_htm试试, 切行时调整分页粒度TableRowThickNess，参考 样例30<br>
http://www.c-lodop.com/demolist/PrintSample30.html<br>
<br>
做个简单例子发过来，这边测试下<br>
<br>
并查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
打印设计，选中超文本打印项，右键属性里查看是否整个表格的内容都传入了<br>
<br>
做个简单例子测试下，可以去掉table里的div试试，直接把样式加到td上<br>
<br>
打印项高度设置成具体值测试下<br>
如果想页脚紧跟表格，参考样例41，关联表格<br>
<br>
（图）<br>
单独测试这个表格是正常的，打印项高度设置成具体值测试下，这边用的是LODOP.ADD_PRINT_HTM(10,10,655,363,"<br>
<br>
（图）<br>
顶边距10，打印项高度363，这边测试是自动分页了，单独测试的表格的内容LODOP.ADD_PRINT_HTM(10,10,655,363,"<br>
<br>
预览下方状态栏的纸张截图下<br>
<br>
纸张没有生效，走的是A4纸张，打印机不支持该纸张<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。 选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
<br>
改成具体值测试下，单独输出这个表格打印项试试，避免其他因素的干扰<br>
<br>
打印项高度改成具体值，纸张的这个是该该打印机不支持设置的该自定义纸张<br>
<br>
修改打印项的高度，可以增大打印项高度试试，表格那个打印项。<br>
纸张的那个是打印机不支持该自定义纸张<br>
<br>
去掉纸张语句测试下，设置了纸张，因为不支持该纸张，走的也是A4纸张尺寸，或设置为A4纸张，或去掉纸张语句试试。<br>
这边测试用的是A4纸张。<br>
<br>
(图）<br>
这边测试刚才的超文本可以分页<br>
<br>
ADD_PRINT_HTM或ADD_PRINT_TABLE的第四个参数是打印项高度，设置打印项为具体值测试下<br>
<br>
用xps或pdf虚拟打印机输出测试下，这边用的是xps虚拟打印机<br>
<br>
虚拟打印机应该是支持自定义纸张的，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
（图）<br>
这边测试是正常的，打印方法里不要加其他语句，直接测试单个超文本试试，超文本打印项高度用具体值<br>
<br>
先去掉页头页页脚测试下，单独测试这个超文本打印项，是否是有打印项覆盖问题等<br>
<br>
（个人又用纸张语句测试了下，因是虚拟打印机，支持自定义纸张，测试是也可以分页)<br>
<br>
应该和页头页尾有关，参考样例43，页脚等关联表格，<br>
关联后紧跟着表格，top值不再是距离纸张顶边距，是和表格的距离<br>
<br>
参考样例43，和样例41 http://www.c-lodop.com/demolist/PrintSample41.html<br>
一个内容关联别人后，其Top值不再是上边距，而是与被关联者的间隙距离,<br>
页脚可以总是跟着表格输出，不会出现页脚顶边距定位和表格可能出现的覆盖问题<br>
<br>
LODOP.SET_PRINT_STYLEA(0,代表紧跟着的打印项，这个页眉页脚项可以加这个样式，<br>
需要每页输出的打印项设置为页眉页脚项<br>
LODOP.SET_PRINT_STYLEA(0,"ItemType",1);//设置上面的为页眉页脚，每页固定位置输出<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample43.html<br>
带颜色的div分别作为它们的页眉页脚。<br>
http://www.c-lodop.com/demolist/PrintSample6.html<br>
里的自动居中的标题，也被设置了页眉页脚，每页输出。<br>
自动分页的的打印项不设置页眉页脚项，表格上方的和下方的页眉页脚可以设置。<br>
紧跟表格的页脚也可以设置关联<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample43.html<br>
测试下样例43试试，样例43也有页眉页脚项。<br>
查看设置的打印项是否正常，自动分页的表格主体不要设置，跟着表格的页脚等其他打印项可以设置。<br>
<br>
（图）<br>
是否是这个if没走到，所以眉脚项加到table上了，可以让这个眉脚跟着页脚项<br>
<br>
（超文本设置为眉脚项，超文本table套在大table的tr输出且add_print_table输出，这两种超文本都不会自动分页，自动分页的主体为眉脚项测试确实不自动分页了）<br>
<br>
10.<span style="color:blue;font-weight:bold">旋转90度丢失了</span><br>
旋转90度丢失了，用的是哪个旋转语句<br>
<br>
旋转，参考http://www.c-lodop.com/faq/pp25.html<br>
并发一下具体的参数，是整页旋转吗<br>
<br>
如果是这个的旋转，http://www.c-lodop.com/demolist/PrintSample13.html<br>
旋转时以左上角为原点，是否是旋转出了纸张<br>
<br>
11.<span style="color:blue;font-weight:bold">Linux系统安装打印机控件的时候报错</span><br>
用的CPU是什么，目前仅支持x86 64架构cpu<br>
<br>
phytium（飞腾）<br>
目前不支持这种CPU<br>
<br>
12.<span style="color:blue;font-weight:bold">这种带黑色标签的，lodop有定位的方法吗</span><br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
可尝试设置下纸张，<br>
<br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
用xps或pdf虚拟打印机测试一下（测试可用样例5），如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。 选择该真实打印机，在打印预览下方状态栏查看一下纸张大小，有的打印机不支持该自定义纸张。<br>
<br>
根据设置的纸张走纸。<br>
如果设置纸张不支持，或用打印机自带的纸张。<br>
<br>
试试带着黑边的，走纸是按照纸张高度走纸，连续纸张也加上黑边高度。<br>
黑边和上边看做一个纸张试试。<br>
<br>
13.<span style="color:blue;font-weight:bold">如何设置页面边距</span><br>
直接打印项在纸张中定位，例如：ADD_PRINT_HTM(intTop,intLeft,intWidth,intHeight,strHtml)增加超文本项 前两个参数，顶边距和左边距。<br>
<br>
参考http://www.c-lodop.com/faq/pp17.html<br>
<br>
根据纸张大小，左边距和顶边距，设置合适的打印项宽度和高度，<br>
如果是超文本会根据的打印项高度自动分页。<br>
 <br>
如果有可打区域，也会受可打区域的影响，<br>
“可打区域”边缘与打印机本身有关，表现在预览里是虚线，可打区域的影响<br>
http://www.c-lodop.com/faq/pp26.html<br>
<br>
查看lodop内部解析的html信息，见http://www.c-lodop.com/faq/pp8.html<br>
分析差异点，因浏览器版本不同遵循的html标准不同，造成某些标签属性显示有差异，尽量避免使用有差异的属性，可以在ie下不同版本仿真情况下验证差异 排查样式，尽量使用使用各浏览器无歧义的通用的 html css js，不支持的样式可尝试用其他样式代替。<br>
<br>
Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。在样式有问题所在电脑上，尝试重置ie，升级ie，<br>
或排查下样式http://www.c-lodop.com/faq/pp8.html，通过删减或做简单例子排查，找到出问题的样式，修改样式。<br>
尽量用通用的样式。<br>
<br>
和解析样式调用的浏览器引擎有关，和操作系统无关<br>
<br>
Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。<br>
尽量使用使用各浏览器无歧义的通用的 html css js，需要本机ie支持，如遇到有问题的样式，可尝试升级ie，或修改样式<br>
<br>
14.<span style="color:blue;font-weight:bold">纸是 700 * 500 的 这样子 为什么会出2张纸</span><br>
进入打印预览查看下效果，查看纸张是否生效<br>
<br>
预览里是一页，还是两页<br>
<br>
如果是这个真实打印机预览的，预览和打印不一致，一般和打印机或打印机驱动有关<br>
预览是打印机的反显，正常会按照预览的走纸。<br>
重装打印机驱动，咨询下打印机客服试试<br>
<br>
15.<span style="color:blue;font-weight:bold">打印出来的字体有些特别挤，有些又特别宽是怎么回事，比如warm 打印出来就是 w arm</span><br>
指定下具体的字体样式试试，比如宋体等。<br>
<br>
测试下样例3下方的这个试试http://www.c-lodop.com/demolist/PrintSample3.html<br>
（图）<br>
设置具体的字体名字<br>
<br>
16.<span style="color:blue;font-weight:bold">打印是立刻的，调用http://localhost:8000/CLodopfuncs.js?priority=1我延时了，但是界面仍然会弹出未准备好</span><br>
参考http://www.c-lodop.com/faq/pp3.html <br>
加延迟或参考样例22，等c-lodop准备好调用<br>
<br>
17.<span style="color:blue;font-weight:bold">mac如何使用lodop</span><br>
目前lodop和c-lodop只能安装到windows操作系统上，下载中心还有linux版，除windows和linux，其他操作系统无法安装，无法用客户端本地打印角色，其他操作系统可以用集中打印，或广域网打印角色，打印到其他windows电脑上。<br>
三种角色及使用方法 参考http://www.c-lodop.com/demolist/t1.html<br>
目前不支持mac系统，将来会开发除了linux外跨平台的其他版本。<br>
<br>
三种角色及使用方法 参考http://www.c-lodop.com/demolist/t1.html<br>
后两种角色是可以预览的，打印是在windows的打印机上<br>
http://www.c-lodop.com/faq/pp28.html<br>
<br>
18.<span style="color:blue;font-weight:bold">部分电脑导出超文本，字间距太大了</span><br>
是指打印内容是超文本吗，<br>
加载css样式，参考样例10 http://www.c-lodop.com/demolist/PrintSample10.html<br>
用css样式控制下字间距试试<br>
<br>
用css样式设置下具体的字体样式，字体大小，和字间距试试<br>
<br>
截图下有问题的客户端的预览，和正常的预览，<br>
观察下字体样式大小字间距等是否生效了，是否有放大或缩小现象<br>
<br>
截图下有问题的客户端的预览，和正常的预览<br>
<br>
在有问题的客户端用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
或改成预览，截图下问题客户端和正常的预览<br>
<br>
在有问题的客户端用xps或pdf虚拟打印机测试下，排除打印机或打印机驱动问题<br>
<br>
是设置了具体的字体样式吗吗，如果是中文字体，设置中文字体名，例如宋体<br>
<br>
（图）<br>
测试下样例3的这个试试，字体设置微软雅黑，内容设置成自己的。<br>
<br>
如果微软雅黑有问题，再在样例3里换成宋体测试下<br>
<br>
Lodop是基于本机windows底层引擎进行渲染解析的，与ie调用的引擎一致。在样式有问题所在电脑上，尝试重置ie，升级ie，
或排查下样式http://www.c-lodop.com/faq/pp8.html，通过删减或做简单例子排查，找到出问题的样式，修改样式。<br>
尝试重置ie，升级ie，或修改字体样式，或修改字体设置方法<br>
<br>
百度下重置ie的方法，或尝试升级ie，观察有问题和没问题的客户端，ie版本是否不同。<br>
或修改字体样式，或修改字体设置方法<br>
<br>
19.<span style="color:blue;font-weight:bold">不固定高度打印票据，但是为什么我有19条数据，打印只出来8条半呢？后面的都没有了，页数是一页的</span><br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
用xps或pdf虚拟打印机测试一下，如果虚拟打印机输出的是正确的纸张，真实打印机不是，可能是打印机不支持该自定义纸张。 <br>
纸张不定高一般小票打印机等特殊打印机支持，普通打印机可能有一定的幅面限制，不支持纸张不定高，可以实际测试下打印机是否纸张不定高纸张。<br>
<br>
20.<span style="color:blue;font-weight:bold">使用LODOP.ADD_PRINT_HTML打印出来的HTML有点模糊</span><br>
如果用的是ADD_PRINT_HTML ，换成 ADD_PRINT_HTM试试，这种是解析后的超文本<br>
<br>
21.<span style="color:blue;font-weight:bold">执行LODOP.PRINT();  响应时间很就 如何破</span><br>
是响应很慢吗<br>
打印过慢，可能和很多原因有关：打印内容或样式或图片等过多，有需要下载有脚步执行或本身网络慢；<br>
机器性能过低 系统ie有问题或缓存过多；或使用的是共享打印机。<br>
如果预览页数多，可以多分一些任务，太多不建议预览，建议直接打印，在任务和页数之间平衡一下，参考样例26 <br>
http://www.c-lodop.com/demolist/PrintSample26.html<br>
<br>
先测试下是否和内容有关，比如测试样例26，那种简单的纯文本试试，样例26如果测试很快，很可能和内容有关，比如自己内容过多需要下载有脚步执行或本身网络慢，打印内容或样式等过多。<br>
<br>
CS架构的吗，打印项是什么语句输出的，是add_print_text纯文本，还是add_print_htm超文本<br>
输出单个纯文本测试下<br>
<br>
都是纯文本，应该是比较快的，用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
<br>
调用的是ocx文件方式吗，用的lodop版本是多少<br>
<pre>
delphi:
myLodop:=TLodopX.Create(Self);
myLodop.Parent:=myPanel;
myLodop.Height:=myPanel.Height;
myLodop.Width:=myPanel.Width;
myLodop.PRINT_INIT('');
myLODOP.ADD_PRINT_TEXT(10,10,100,20,'新加文本1');
myLODOP.ADD_PRINT_RECT(66,116,100,60,0,1);
myLodop.SET_SHOW_MODE('DESIGN_IN_BROWSE','1');
myLodop.print_design;
=================================
VB:
Private Sub Command1_Click()
With LodopX1
.PRINT_INIT ""
.ADD_PRINT_TEXT 10, 10, 20, 20, "aaaa"
.PREVIEW
End With
End Sub
=================================
C#:
首先添加引用文件：CAOSOFT_WEB_PRINT_lodop.ocx

Lodop.LodopXClass MyLodop = new Lodop.LodopXClass();

MyLodop.ADD_PRINT_TEXT(10,10,100,20,"新加文本1"); 
MyLodop.PREVIEW();
=================================
C++:
首先添加引用文件：CAOSOFT_WEB_PRINT_lodop.ocx 
int a = 5;
_variant_t var;
var = (_variant_t)(int)a;
VARIANT v = var;
CString str = _T("xxx");
_variant_t varText = (LPCTSTR)str;
VARIANT dispText = varText;
lodop.ADD_PRINT_TEXT(v,v,v,v,dispText);
lodop.PREVIEW();

尝试下其他人反馈的CS架构的使用方法试试
</pre>
CS架构的不好判断，如果虚拟打印机输出单个纯文本也很慢，也可能和引用方式或本身操作系统有关，可能CS架构本身调用慢一些。<br>
是否只有这一个机器比较慢。<br>
<br>
用不同的电脑测试下，如果都很慢，可能和调用方式有关。<br>
可以测试下官网的BS架构的web方式，在ie下走的是插件方式。<br>
如果BS架构的很快，该CS架构的比较慢，可能和本身的调用方式有关，排查本机操作系统或再观察下慢在哪个环节。<br>
<br>
22.<span style="color:blue;font-weight:bold">连续打印的，打印完之后，如何可以控制多走纸3厘米</span><br>
连续打印固定的纸张，还是纸张不定高<br>
<br>
LODOP.SET_PRINT_PAGESIZE(3,1385,45,"");//不定高纸张设置，这里3表示纵向打印且纸高“按内容的高度”；1385表示纸宽138.5mm；45表示页底空白4.5mm<br>
<br>
第四个参数是底部空白<br>
<br>
实际测试纸张预览查看下纸张效果，预览下方状态栏查看下，一般小票打印机等特殊打印机支持纸张不定高。<br>
标签打印机需要测试下是否支持纸张不定高。<br>
<br>
两个标签是并排的，还是一列上下两个。<br>
如果测试不支持纸张不定高，可以设置两个标签加上下方的空白间隙当作一张纸，内容定位在纸张上。<br>
<br>
截图一下纸张，是标签打印，标签之间有间隙吗。<br>
如果是这种纸张，可以算上间距设置纸张测试下。<br>
<br>
看起来是小票纸张，连续纸张，可以测试下纸张不定高。<br>
打印项之间的间隙定位等可以用打印项的顶边距等定位。<br>
<br>
或设置成多任务，一个任务一个标签，标签设置顶部距离。<br>
<br>
不定高纸张第四个参数是距离底边的距离，多任务输出，每个任务都是标签带着后面的空白。<br>
如果每次都打印两个标签，也可以设置一个任务两个标签，两个标签打印项位置可以根据需要定位。<br>
add_print_text第一个参数是顶边距。<br>
<br>
设置了纸张语句后，会根据不定高的第四个参数留空白。<br>
可以一个标签一个任务，每个任务的根据内容的纸张加上下方的空白是走纸高度。<br>
如果想两个标签一个任务，两个标签的打印项可以根据需要在纸张中设置定位，如果觉得定位麻烦，或直接一个标签一个任务。<br>
<br>
23.<span style="color:blue;font-weight:bold">LODOP.SET_PRINT_MODE("PRINT_PAGE_PERCENT","Full-Page");
用ADD_PRINT_HTM打印的时候PRINT_PAGE_PERCENT缩放没有生效，但是使用ADD_PRINT_HTML是可以缩放的</span><br>
这个是url吗，参考样例14，http://www.c-lodop.com/demolist/PrintSample14.html<br>
<br>
（图）<br>
在样例14里测试下，可以在预览直接切换到整页缩放<br>
<br>
这个url这边测试访问不了，测试下样例14的其他url试试<br>
<br>
（图）<br>
确实分页了，可能和网页某些内容或样式有关，逐步排查下内容和样式。<br>
<br>
ADD_PRINT_HTML能更好的还原样式，但是不如add_print_htm清晰，如果用add_print_htm需要排查样式。<br>
由于Lodop借用IE下载引擎，与非IE浏览器之间目前不能传递Session(Cookies)，所以需要安全验证的页面不要用URL方式打印，要用页面已经下载好的内容的HTM方式打印，也就是ADD_PRINT_HTM或ADD_PRINT_TABLE等语句<br>
另外URL方式需要二次访问服务器，理论上存在下载失败的可能，所以专业的管理系统尽量不要用URL方式。<br>
<br>
24.<span style="color:blue;font-weight:bold">打印出来恒字变成刀了</span><br>
（图）<br>
这边测试是正常的，用的c-lodop版本多少，用最新版4127测试下<br>
<br>
参考下载中心下方的变更记录http://www.c-lodop.com/c-lodopsteprec.html<br>
后续版本修正了一些pdf，如果遇到有问题的pdf文件，可用新版本测试下<br>
<br>
（后查看当前使用的是4128，正好有需要定做的，更新定做安装里内容时安装了4127，测试4127也是正常的。）<br>
<br>
25.<span style="color:blue;font-weight:bold">注册了 发的邮件是这个（天空云）</span><br>
再查看下是否有其他邮件，是否在垃圾邮件里<br>
<br>
稍等，这边问一下同事，<br>
查看下邮箱里是否还有其他邮件<br>
<br>
26.<span style="color:blue;font-weight:bold">新版本，可以用我以前注册的方式吧  ，不要填公司名称</span><br>
<pre>
注册类型是什么，是ip域名，还是公司名的

公司名称注册吗，注册号对后续版本都有效。

直接复制原来的注册语句就行

购买的是公司名称注册吗 ，还是ip或域名注册

IP和域名注册，根据浏览器地址栏访问方式注册，P访问，注册IP；域名访问，注册域名；不限IP域名，可做企业名称注册。
（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。
（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名： www.c-lodop.com 登陆方式如下：http://www.c-lodop.com/index.html等，ip地址访问时，注册信息无效
如果是ip或域名注册，在注册的ip或域名下有效

公司名称注册注册号里会有公司名，发一下注册日期和邮箱，这边查询一下，应该不是公司名注册的

注册号对后续版本都有效，如果当时是ip域名注册，只要访问的还是原来注册的地址就行。
公司名注册也是对后续版本有效。
直接复制原来的语句。

如果想用新买的公司名的，可以替换掉之前的语句。

对后续版本都有效

6.111之前的版本吗，根据发注册号的邮箱里的，下载之后的版本

4.1是c-lodop的版本，6.1的是lodop的版本。
注册号对c-lodop本地角色是有效的
</pre>
27.<span style="color:blue;font-weight:bold">导出pdf可以直接获取文件吗</span><br>
是指导出pdf文件吗，可以借助pdf虚拟打印机输出为pdf文件，lodop不支持直接导出<br>。
如果是指打印pdf文件，<br>
官网下载中心，下载最新的C-lodop<br>
http://www.c-lodop.com/download.html<br>
安装后在欢迎页面末尾找“PDF打印”链接，或输入地址: <br>
http://localhost:8000/c_pdfprint
<br>
上传下载等与服务器的交互需要自己控制，lodop没有上传方法<br>
<br>
导出是pdf虚拟打印机输出的，导出后的pdf文件，上传或下载等需要自己控制<br>
<br>
28.<span style="color:blue;font-weight:bold">想要引导用户下载最新版的lodop定制插件，但是不知道判断的版本应该是哪个,应该怎么判断呢？</span><br>
lodopFuncs.js里写好了判断提示，可以用新的lodopFuncs.js，里面有判断版本号。<br>
<br>
查看c-lodop版本，参考http://www.c-lodop.com/faq/pp15.html<br>
<br>
安装版本小于lodopFuncs.js判断的版本提示升级<br>
<br>
29.<span style="color:blue;font-weight:bold">安装乱码，有没有英文版的呀？</span><br>
参考http://www.c-lodop.com/download.html<br>
64位的c-loop后缀为EN的是英文版的，<br>
64位的c-lodop只能在操作系统是64位下使用<br>
<br>
30.<span style="color:blue;font-weight:bold">开钱箱的指令 能往usb口发送吗?</span><br>
发送打印指令和读写端口,参考http://www.c-lodop.com/demolist/PrintSample17.html<br>
需要实际测试下，调试下端口，咨询下打印机客服，<br>
<br>
31.<span style="color:blue;font-weight:bold">pdf欢迎页面预览空白</span><br>
（图）<br>
如果url方式有问题，测试个本地的pdf试试，后两种方式测试下<br>
<br>
只有url方式有问题吗，在浏览器里访问下http://localhost:8000/CLodopDemos/PDFDemo.pdf<br>
查看下这个pdf是否能在浏览器里正常显示<br>
<br>
比较奇怪，找个其他pdf的url路径试试，<br>
http开头的pdf的url文件路径。<br>
<br>
不好判断，这边测试都是正常的。<br>
后两个本地路径和base64是正常的，<br>
或先用后两种方式，观察出问题的电脑操作系统等设置，排查和什么原因有关。<br>
<br>
和注册无关。<br>
这边的电脑测试都是正常的，url方式可以使用。<br>
这些电脑是否有什么共同特点，本机是否有共享打印机，找一台电脑删除掉共享打印机，只保留本地打印机预览试试。<br>
<br>
共享打印机是可以用的，但是共享打印机如果出现问题等，可能会造成一些问题。<br>
观察预览正常和不正常的电脑，是否预览pdf的url空白的都是有共享打印机的，删除共享打印机重新共享试试。<br>
<br>
（后客户反馈没有安装共享打印机的是正常的。该问题可能又和共享打印机问题有关）<br>
<br>
32.<span style="color:blue;font-weight:bold">界面，这个代码在哪里改动</span><br>
不支持添加按钮<br>
<br>
界面是按钮的功能是固定的。<br>
或在打印页面自己设置按钮，实现自己的功能。<br>
<br>
不支持直接导出为pdf文件，可以借助pdf虚拟打印机打印成pdf文件。<br>
选择打印机，参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
<br>
33.<span style="color:blue;font-weight:bold">4.0.9.9在win7系统上安装或启动时个别电脑会出现无响应现象</span><br>
安装最新版测试下http://www.c-lodop.com/download.html<br>
以管理员权限安装，安装程序，右键以管理员权限运行<br>
<br>
34.<span style="color:blue;font-weight:bold">购买了商用版的lodop，在使用过程中，有的电脑打印时不带水印，有的电脑却仍然带着水印</span><br>
参考排查一下http://www.c-lodop.com/faq/ph01.html<br>
先确保该注册语句执行了，每个打印方法里都要执行。<br>
（..小问答大段..)<br>
<br>
如果是个别有问题，在有问题的客户端清理下浏览器缓存试试，<br>
清理缓存无效，再逐条排查下<br>
<br>
先发一下浏览器地址栏的地址 ，核对是否和注册的域名一致<br>
<br>
发一下浏览器地址栏的地址，这边查到您注册的是二级域名，浏览器地址栏是否和注册地址对应。<br>
<br>
发一下打印所在页面的浏览器地址栏地址<br>
<br>
访问的是否是注册的ip或域名，浏览器地址栏输入的是否是注册的ip或域名，<br>
（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下<br>
：http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。<br>
（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名： www.c-lodop.com 登陆方式如下<br>
：http://www.c-lodop.com/index.html等，ip地址访问时，注册信息无效<br>
就是客户访问网站时，在web页面浏览器地址栏里输入的地址<br>
<br>
如果只有客户端电脑有问题，做个简单例子测试下，<br>
可以先做个简单例子测试下，<br>
例如：<br>
LODOP.PRINT_INIT("打印任务名"); <br>
LODOP.ADD_PRINT_TEXT(0,0,100,20,"文本内容一");<br>
LODOP.SET_LICENSES........<br>
LODOP.PRINT(); <br>
直接放到PRINT()语句前面测试下。<br>
<br>
如果和注册地址对应，再排查下执行问题。<br>
可以先做个简单例子测试下，确保注册语句执行了，并排除之前页面的缓存的影响。<br>
<br>
打印是直接打印输出的吗，可以直接放到print前面测试下。<br>
LODOP.SET_LICENSES........<br>
LODOP.PRINT(); <br>
或下载发行包里的样例3，把样例3放到网站上，修改lodopFuncs.js路径成自己的，直接打印前面加上注册语句，<br>
<br>
域名注册只能在浏览器访问该域名下有效。<br>
<br>
在代码里，<br>
LODOP.SET_LICENSES........<br>
LODOP.PRINT(); <br>
排查注册语句执行是否正常<br>
<br>
注册号是去掉水印的，确保注册语句执行正常，可以先放到打印方法里，直接打印前面，确保注册语句执行了。<br>
<br>
是否是直接复制的收注册的邮箱里的语句，直接复制邮箱里的语句。<br>
<br>
注册语句和内容无关，如果注册号填写错误，输出会有水印，不影响打印。<br>
<br>
调试JS，是否执行了注册语句，做个简单例子测试下，发个该域名下的测试地址，这边测试下。<br>
并私发一下注册语句，这边测试下。<br>
<br>
参考排查一下http://www.c-lodop.com/faq/ph01.html<br>
逐条排查下，进入打印设计或打印维护看下，关于按钮是否隐藏，如果隐藏了，用虚拟打印机输出测试下。<br>
<br>
参考排查一下http://www.c-lodop.com/faq/ph01.html<br>
逐条排查下，进入打印设计或打印维护看下，关于按钮是否隐藏，如果隐藏了，用虚拟打印机输出测试下。<br>
第十四 个别打印机的缓存机制在捣乱，目前发现有些打印机会重复输出旧的打印任务，这应该属于打印机故障范畴(很奇葩的故障)，但会严重影响注册号的测试认定。如果以上所有步骤都排查无误，而且打印维护的“关于”按钮也看不到了，真实打印仍有水印时，建议您重启一下该打印机。<br>
<br>
或在该客户端本地该域名临时指向本地，修改下hosts文件测试下。<br>
只要浏览器地址栏访问的是注册的域名就行。<br>
<br>
把域名指向本地，在有问题的客户端本地测试下。<br>
<br>
没有，注册不成功会显示水印，打印设计和打印维护不会隐藏关于按钮。<br>
有问题的客户端，进入打印设计或打印维护看下，关于按钮是否隐藏<br>
<br>
(图）<br>
关于按钮隐藏了，用虚拟打印机输出测试下<br>
<br>
这个维护的按钮没有隐藏，注册语句没有生效<br>
<br>
两个截图是两个电脑上的吗<br>
<br>
都是自己的电脑，是一个加了注册语句，一个没有加吗<br>
<br>
注册语句需要每次打印时都调用，直接写在打印方法里测试下，如打印设计或打印维护或直接打印等语句的前面，<br>
<br>
发一下打印代码，是否打印维护和打印设计两个方法里都加了注册语句<br>
<br>
直接写到打印方法里再测试下，<br>
确保注册语句的执行<br>
<br>
每个打印方法里都调用，每次打印都调用<br>
<br>
只要获取LODOP对象后调用就行，每个打印方法里都加上注册语句，<br>
直接打印，打印维护，打印设计等语句前面，都加上试试。<br>
<br>
前面的打印维护去掉了关于按钮，打印设计没有去掉，应该是打印设计这个方法里没有加注册语句。<br>
调试JS，排查下，做简单例子测试下。<br>
<br>
35.<span style="color:blue;font-weight:bold">打印不了，队列里提示，错误-正在打印</span><br>
用xps或pdf虚拟打印机测试下，<br>
win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机<br>
已经加入队列了，就交个windows打印服务和打印机驱动了，查看下打印机是否脱机等。<br>
并排查下电脑和打印机的连线是否正常<br>
<br>
36.<span style="color:blue;font-weight:bold">之前没有域名，购买的时候用ip绑定打印程序，现在申请了域名，可以把ip改域名么</span><br>
不支持，ip和域名是一次性注册，更换需要重新购买<br>
<br>
如果是公司名称注册，不限ip和域名，公司名下项目都可用<br>
<br>
ip和域名一次性注册，不支持更换。<br>
一个注册对应一个ip或一个域名，新的域名地址需要再注册<br>
<br>
两种访问方式，浏览器地址栏地址不同，需要都注册，新的域名需要购买域名注册号。<br>
<br>
37.<span style="color:blue;font-weight:bold">之前买的时候绑的ip是阿里云服务器的，现在想要在本地部署一套备份系统，但是想用打印程序，有什么方法么</span><br>
<pre>
新的系统的浏览器地址栏的地址是什么，

新系统的浏览器的访问地址是新的服务器ip吗，需要根据的新的地址再注册
IP和域名注册，根据浏览器地址栏访问方式注册，P访问，注册IP；域名访问，注册域名；不限IP域名，可做企业名称注册。
（1）.单独注册服务器ip地址，登陆访问方式是ip地址访问，例如：注册ip地址：192.168.0.1，登陆方式如下http：//192.168.0.1:8000/index.jsp等，域名访问时，注册信息无效。
（2）.单独注册域名：登陆访问方式是域名地址访问，例如：注册域名： www.c-lodop.com 登陆方式如下：http://www.c-lodop.com/index.html等，ip地址访问时，注册信息无效

可以等域名申请下来再购买，购买域名注册，根据浏览器地址栏的访问地址注册。
或公司名注册，不限ip域名。
</pre>
38.<span style="color:blue;font-weight:bold">表格这种的被截断有好的方法</span><br>
add_print_htm, 切行时调整分页粒度TableRowThickNess，参考 样例30<br>
http://www.c-lodop.com/demolist/PrintSample30.html<br>
<br>
（图）<br>
超文本超过打印项高度自动分页，或调整下打印项高度，在这个最大行的上方，下面这行分到下页。<br>
<br>
39.<span style="color:blue;font-weight:bold">vue文件怎么使用</span><br>
vue中使用Lodop，参考http://www.c-lodop.com/faq/pp35.html<br>
<br>
http://www.c-lodop.com/download.html<br>
下载中心发行包里<br>
<br>
40.<span style="color:blue;font-weight:bold">需要用到语音播报的功能，但是部分电脑无法播放，推荐下载tts语音，但是链接失效了</span><br>
百度下其他网上的下载地址试试<br>
<br>
（测试样例48，两个微软tts语音下载地址是失效了，但是百度等可以搜到其他下载地址）<br>
<br>
是否是下载的微软的tts语音有问题，网上找一些修复tts语音引擎的方法试试。<br>
<br>
41.<span style="color:blue;font-weight:bold">纸张，怎么才能让他打多少就出来多少</span><br>
进入打印预览查看下效果<br>
<br>
按照纸张高度走纸<br>
<br>
不定高纸张，参考样例18，<br>
纸张不定高一般小票打印机等特殊打印机支持，普通打印机可能有一定的幅面限制，不支持纸张不定高，可以实际测试下打印机是否纸张不定高纸张<br>
<br>
如果实际测试该打印机不支持纸张不定高，只能按照纸张高度走纸<br>
<br>
参考样例18，样例右键查看源码<br>
LODOP.SET_PRINT_PAGESIZE(3,1385,45,"");//不定高纸张设置，这里3表示纵向打印且纸高“按内容的高度”；1385表示纸宽138.5mm；45表示页底空白4.5mm<br>
<br>
需要实际测试打印机是否纸张纸张不定高，一般的打印机都有幅面限制，可能会不支持，小票打印机等特殊的打印机支持。<br>
<br>
可以设置不定高纸测试下，进入打印预览，查看纸张如果没有分页等，是否正常显示不定高的纸张。<br>
<br>
（图）<br>
打印项高度和顶边距等累计高度，打印项高度下方距离纸张的空白区域。<br>
<br>
（图）<br>
纸张下方的空白<br>
<br>
42.<span style="color:blue;font-weight:bold">LODOP每次打印是不是都要需要联网检测注册号？</span><br>
不需要联网，本地验证注册号<br>
<br>
43.<span style="color:blue;font-weight:bold">端口变成8001？</span><br>
最新版是双端口，8000和18000一个能用就行<br>
<br>
8000端口被占用会变成8001，新版c-lodop和新版lodopFuncs.js里引用双端口，一个能用就行。<br>
<br>
44.<span style="color:blue;font-weight:bold">pdf打印预览过多时，可否添加loading; url内容打印是有loading的</span><br>
不支持pdf添加进度条，或一个任务输出少量的pdf文件，多分一些任务，打印太多不建议预览，建议直接打印。<br>
批量打印，分页分任务，在页数和任务之间平衡一下，参考样例<br>26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
<br>
45.<span style="color:blue;font-weight:bold">chrome 总是提示软件未安装 ie没问题</span><br>
参考http://www.c-lodop.com/faq/pp21.html<br>
高版本的火狐谷歌不再支持np插件，需要使用c-lodop，可参考官网样例混合部署http://www.c-lodop.com/LodopDemo.html
Lodop控件升级到C-Lodop云打印 参考http://www.c-lodop.com/faq/pp7.html<br>
<br>
http网站，还是https的<br>
<br>
参考http://blog.sina.com.cn/s/blog_721e77e50102z33a.html<br>
安装最新版c-lodop的4101或之后的版本，并参考链接修改JS地址。<br>
<br>
https的C-Lodop如何使用 参考http://www.c-lodop.com/faq/pp32.html<br>
<br>
46.<span style="color:blue;font-weight:bold">怎么让lodop支持安卓设备?</span><br>
目前lodop和c-lodop只能安装到windows操作系统上，下载中心还有linux版可安装linux系统上，除windows和linux，其他操作系统无法安装，无法用客户端本地打印角色，其他操作系统可以用集中打印，或广域网打印角色，打印到其他windows电脑上。<br>
三种角色及使用方法 参考http://www.c-lodop.com/demolist/t1.html<br>
目前不支持安卓系统，不支持安装的第一种角色，可后两种角色打印到其他windows电脑上。<br>
<br>
不支持lodop或c-lodop安装到安卓上。<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
只能打到其他windows电脑上，导出图片需要windows客户端本地角色。<br>
<br>
参考http://www.c-lodop.com/demolist/PrintSample27.html<br>
需要客户端本地打印角色，不支持远程写文件<br>
<br>
可以实际测试下，应该会提示不支持远程写文件<br>
<br>
（图）<br>
只能客户端本地打印角色导出图片。不支持安卓远程导出图片<br>
<br>
参考http://www.c-lodop.com/demolist/t1.html<br>
只能用于第一种角色，参考http://www.c-lodop.com/demolist/PrintSample27.html<br>
<br>
（虽然知道不支持远程导出图片，但考虑到自己没实际测试过，临时用自己手机测试了下，手机确实提示了不支持远程写文件）<br>
<br>
47.<span style="color:blue;font-weight:bold">纸张不定高，第二页数据打不出来了</span><br>
是指纸张不定高吗，<br>
小票打印 ，参考样例18 http://www.c-lodop.com/demolist/PrintSample18.html<br>
（小票针式打印 建议用 ADD_PRINT_TEXT文本，不用htm超文本，纸张高度不定容易引起 htm 中排版变形）<br>
<br>
有的打印机不支持纸张不定高，有最大高度限制，或幅面限制。<br>
<br>
48.<span style="color:blue;font-weight:bold">不同电脑，同一台打印机，同样的系统代码，打出来的效果缺不一样，一台电脑打印的二维码，一台打印的小。</span><br>
操作系统控制面板设置显示应在100%<br>
查看下系统缩放是否正常<br>
<br>
操作系统控制面板里的显示<br>
<br>
49.<span style="color:blue;font-weight:bold">打印会出现偶尔停顿</span><br>
停顿应该和打印机有关。<br>
进入打印预览查看下，观察停顿的位置，是否一个任务停顿一次，或一页停顿一次，观察预览的纸张和每个任务的页数。<br>
<br>
打印项是什么语句输出的<br>
<br>
是add_print_text纯文本，还是add_print_htm超文本，还是pdf文件等<br>
<br>
50.<span style="color:blue;font-weight:bold">打印表格时 分页如何每张纸显示的行数相同</span><br>
如果是固定的行高，可以尝试通过设置具体的打印项高度，超文本超过打印项高度自动分页。<br>
如果行高不固定，自动分页没有很好的办法，或拆分表格，手动分页参考样例30，控制每页输出的具体内容。<br>
<br>
调整打印项高度，会按照打印项高度自动分页<br>
<br>
例如ADD_PRINT_HTM(intTop,intLeft,intWidth,intHeight,strHtml)增加超文本项<br>
第四个参数是打印项高度<br>
<br>
可以打印设计里调整下，不断调整到合适的分页值<br>
<br>
（打印设计截图）cnblog里自动分页图示部分，里面以前的插图可以截取打印设计本身代码和图示https://www.cnblogs.com/huaxie/p/9640491.html<br>
<br>

</div>
<!--main_middle结束-->
        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
