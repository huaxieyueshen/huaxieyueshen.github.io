<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <link href="../../maychangecss/newblog_nomal.css" type="text/css" rel="stylesheet">
  <title>【LODOP】不定高纸张（不同打印机对不定高纸张支持不同）（文案，初）</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}
.blue{color:#95bfc7;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left; }
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>博文-【LODOP】不定高纸张（不同打印机对不定高纸张支持不同）（文案，初） </h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 
		   <a href="../../index.html"><div class="menuitem">花谢悦神的主页</div></a>	
		   <a href="../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		   <a href="../phoneQA_dange.html"><div class="menuitem">问答主页（单个问答链接）</div></a> 
		   <a href="../mini_QAs.html"><div class="menuitem"><span style="color:#ff0099;">迷你一个问答</span></div></a> 
		   <a href="../new_bloglist.html"><div class="menuitem"><span class="newblogfont">新博文newblogs</span></div></a>
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>【LODOP】不定高纸张（不同打印机对不定高纸张支持不同）（文案，初） </h1>
            <div class="postBody">
                <div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p>小票打印 ，参考样例18 http://www.c-lodop.com/demolist/PrintSample18.html<br />样例18演示了一种不定高的纸张，不过和自定义纸张一样，并不是所有打印机都支持，是否支持纸张不定高需要实际测试。</p>
<p>LODOP.SET_PRINT_PAGESIZE(3,1385,45,"");//不定高纸张设置，这里3表示纵向打印且纸高&ldquo;按内容的高度&rdquo;；1385表示纸宽138.5mm；45表示页底空白4.5mm</p>
<p>SET_PRINT_PAGESIZE第一个参数为3时，就是代表纸张不定高，不再固定纸张</p>
<p>纸张不定高一般小票打印机等特殊打印机支持，普通打印机可能有一定的幅面限制，不支持纸张不定高，可以实际测试下打印机是否支持不定高纸张。</p>
<p>1.设置了纸张不定高，没生效，如何确定是否和打印机有关，还是自己的代码有关？</p>
<p>用xps或pdf虚拟打印机测试下，<br />win7以后系统自带Microsoft XPS Document Writer虚拟打印机或者 下载安装群文件里的Doro PDF Writer虚拟打印机</p>
<p>虚拟打印机和真实打印机预览查看下效果，如果虚拟打印机正常，真实打印机分页了，或打印不全 ，或不是设置的纸张，则真实打印机不支持该不定高尺寸。</p>
<p>2.为什么一些pdf虚拟打印机纸张不定高也不生效？<br />一些pdf打印机，如Microsoft Print to PDF，或导出wps pdf等，某些虚拟打印机也有不支持的纸张，且有纸张高度限制，导致也会不生效。</p>
<p>Microsoft XPS Document Writer虚拟打印机<br />Doro PDF Writer虚拟打印机<br />这个两个目前测试限制较少，支持大部分自定义纸张</p>
<p>3.打印机支持不定高，宽度生效了，少量数据正常，数据多了就截取了，后面的不打印，为什么？<br />打印机有高度限制，少量数据时，看起来不定高生效了，<br />但当达到一定高度，不定高后面的内容不显示了，</p>
<p>和打印机有关，打印机本身的限制，可以用Microsoft XPS Document Writer虚拟打印机或Doro PDF Writer虚拟打印机对比下。</p>
<p>虚拟打印机能正常显示后面，真实打印机不是，就是打印机本身的高度限制。</p>
<p>4.设置了纸张不定高，分页了<br />同3，打印机的限制，<br />有些打印机表现为到达一定高度，后续截取不打印了<br />有些打印机则是一定高度自动分页了，最常见的是A4的高度，宽度高度都不生效，直接走默认的纸张也是可能的</p>
<p>5.打印机不支持纸张不定高，但需要连续纸张打很多怎么办？</p>
<p>如果不是小票那种，需要设置具体的纸张高度，打印机对纸张高度和打印幅面有限制。<br />可连续打印多个固定大小的纸张，批量打印，分页分任务，在页数和任务之间平衡一下，参考样例<br />26http://www.c-lodop.com/demolist/PrintSample26.html</p>
<p>6.三联纸怎么连续输出，分页中间会有间隔</p>
<p>如前面描述，需要打印机支持，一般打三联纸的打印机，不是小票打印机，<br />所以可能会出现少量正常，多了后面截取不打印了，或自动分页了等情况 <br />出现则说明打不到这个高度，建议固定纸张连续输出。</p>
<p>如果是表格，固定纸张分页之间会有少量空格不是连续的属于正常现象。</p>
<p>7.打印大量标签，不定高没生效<br />标签打印机，建议一个标签作为一个纸张，不要设置纸张高度自适应，不支持纸张不定高。<br />如果是并排标签，可以把并排标签看做一个纸张。设置具体的纸张高度。</p>
<p>8.不定高纸张的下边距，打印项高度</p>
<p>LODOP.SET_PRINT_PAGESIZE(3,1385,45,"");//不定高纸张设置，这里3表示纵向打印且纸高&ldquo;按内容的高度&rdquo;；1385表示纸宽138.5mm；45表示页底空白4.5mm</p>
<p>第一个参数为3后 ，是不定高桌子，第三个参数也不再是纸张高度，而是底部的空白。<br />如果是不定高的小票，建议纯文本输出，如果是超文本，底部高度不一定有效，且打印项高度也受超文本内容影响</p>
<p>（图）<br />最后的纸张高度是打印项高度和顶边距高度的累计值，还有纸张第三个参数设置的空白高度。</p>
<p>虽说是打印项累计高度，但超文本受内容影响<br />之前博文自己测试过纯文本和超文本打印项高度：</p>
<p>设置超文本和纯文本打印项高度都是30mm<br />（图）</p>
<p>效果：<br />（图）<br />超文本其实是根据的内容走的高度<br />而纯文本确实和打印项高度一致</p>
<p>如图，之前测试的纯文本的累计高度<br />（图）</p>
<p>（图）</p>
<p><br />总结：<br />不定高纸张一般只有小票打印机等支持，普通打印机有高度或幅面限制，不支持<br />可能表现为：<br />1.宽度生效，少量内容正常，内容多了截取不显示<br />2.宽度生效，少量内容正常，内容多了分页了<br />3.宽高都不生效，走的默认纸张</p>
<p>其他：<br />小票尽量用纯文本和画线输出，速度快，样式稳定，且会按照打印项高度顶边距等累计</p>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
</div>
</div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->
</div><!--body结束-->
 </body>
</html>
