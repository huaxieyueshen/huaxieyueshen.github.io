<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>如何判断系统提示linux和windows下载安装</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}
#small{background:#febaab;border:#7f9db9 1px solid;padding:10px;font-size:15px; }
#small hr{margin:10px;padding:0px;}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left;}
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-如何判断系统提示linux和windows下载安装</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 	
		  <a href="../../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		  <a href="../../phoneQA_dange.html"><div class="menuitem"><span style="color:red;">返回问答主页（单个问答链接）</span></div></a>
          <a href="../../mini_QAs.html"><div class="menuitem"><span style="color:#ff0099;">返回迷你一个问答</span></div></a> 
		  <a href="../QA_singe31t.html"><div class="menuitem" style="background:#febaab;border:#7f9db9 1px solid;">如何实现某功能语句</span></a> 
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>如何判断系统提示linux和windows下载安装</h1>
<div id="small">
<span style="color:blue">如何判断系统提示linux和windows下载安装</span><br>
参考官网样例的lodopFuncs.js<br>
http://www.c-lodop.com/demolist/LodopFuncs.js<br>
<hr>
<span style="color:blue">如何判断系统提示linux和windows下载安装2</span><br>
参考官网样例的lodopFuncs.js，官网样例的lodopFuncs.js里有判断操作版本linux还是windows，判断http还是https的。<br>
http://www.c-lodop.com/demolist/LodopFuncs.js<br>
<hr>
<span style="color:blue">判断系统提示linux或windows下载安装，判断http和https的lodopFuncs.js</span><br>
<div class="cnblogs_code" style="background-color:white">
<pre><span style="color: #008000;">//</span><span style="color: #008000;">==本JS是加载Lodop插件或Web打印服务CLodop/Lodop7的综合示例，可直接使用，建议理解后融入自己程序==</span>

<span style="color: #0000ff;">var</span><span style="color: #000000;"> CreatedOKLodopObject, CLodopIsLocal, CLodopJsState;

</span><span style="color: #008000;">//</span><span style="color: #008000;">==判断是否需要CLodop(那些不支持插件的浏览器):==</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> needCLodop() {
    </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
        </span><span style="color: #0000ff;">var</span> ua =<span style="color: #000000;"> navigator.userAgent;
        </span><span style="color: #0000ff;">if</span> (ua.match(/Windows\sPhone/i))   <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">if</span> (ua.match(/iPhone|iPod|iPad/i)) <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">if</span> (ua.match(/Android/i))          <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">if</span> (ua.match(/Edge\D?\d+/i))       <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;

        </span><span style="color: #0000ff;">var</span> verTrident = ua.match(/Trident\D?\d+/<span style="color: #000000;">i);
        </span><span style="color: #0000ff;">var</span> verIE = ua.match(/MSIE\D?\d+/<span style="color: #000000;">i);
        </span><span style="color: #0000ff;">var</span> verOPR = ua.match(/OPR\D?\d+/<span style="color: #000000;">i);
        </span><span style="color: #0000ff;">var</span> verFF = ua.match(/Firefox\D?\d+/<span style="color: #000000;">i);
        </span><span style="color: #0000ff;">var</span> x64 = ua.match(/x64/<span style="color: #000000;">i);
        </span><span style="color: #0000ff;">if</span> ((!verTrident) &amp;&amp; (!verIE) &amp;&amp; (x64)) <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span><span style="color: #000000;"> (verFF) {
            verFF </span>= verFF[0].match(/\d+/<span style="color: #000000;">);
            </span><span style="color: #0000ff;">if</span> ((verFF[0] &gt;= 41) || (x64)) <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
        } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span><span style="color: #000000;"> (verOPR) {
            verOPR </span>= verOPR[0].match(/\d+/<span style="color: #000000;">);
            </span><span style="color: #0000ff;">if</span> (verOPR[0] &gt;= 32) <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
        } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> ((!verTrident) &amp;&amp; (!<span style="color: #000000;">verIE)) {
            </span><span style="color: #0000ff;">var</span> verChrome = ua.match(/Chrome\D?\d+/<span style="color: #000000;">i);
            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (verChrome) {
                verChrome </span>= verChrome[0].match(/\d+/<span style="color: #000000;">);
                </span><span style="color: #0000ff;">if</span> (verChrome[0] &gt;= 41) <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
            }
        }
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
    } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (err) {
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
    }
}

</span><span style="color: #008000;">//</span><span style="color: #008000;">加载CLodop时用双端口(http是8000/18000,而https是8443/8444)以防其中某端口被占,</span><span style="color: #008000;">
//</span><span style="color: #008000;">主JS文件名&ldquo;CLodopfuncs.js&rdquo;是固定名称，其内容是动态的，与其链接的打印环境有关:</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> loadCLodop() {
    </span><span style="color: #0000ff;">if</span> (CLodopJsState == "loading" || CLodopJsState == "complete") <span style="color: #0000ff;">return</span><span style="color: #000000;">;
    CLodopJsState </span>= "loading"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> head = document.head || document.getElementsByTagName("head")[0] ||<span style="color: #000000;"> document.documentElement;
    </span><span style="color: #0000ff;">var</span> JS1 = document.createElement("script"<span style="color: #000000;">);
    </span><span style="color: #0000ff;">var</span> JS2 = document.createElement("script"<span style="color: #000000;">);

    </span><span style="color: #0000ff;">if</span> (window.location.protocol=='https:'<span style="color: #000000;">) {
      JS1.src </span>= "https://localhost.lodop.net:8443/CLodopfuncs.js"<span style="color: #000000;">;
      JS2.src </span>= "https://localhost.lodop.net:8444/CLodopfuncs.js"<span style="color: #000000;">;
    } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
      JS1.src </span>= "http://localhost:8000/CLodopfuncs.js"<span style="color: #000000;">;
      JS2.src </span>= "http://localhost:18000/CLodopfuncs.js"<span style="color: #000000;">;
    }
    JS1.onload  </span>= JS2.onload  = <span style="color: #0000ff;">function</span>()    {CLodopJsState = "complete"<span style="color: #000000;">;}
    JS1.onerror </span>= JS2.onerror = <span style="color: #0000ff;">function</span>(evt) {CLodopJsState = "complete"<span style="color: #000000;">;}
    head.insertBefore(JS1, head.firstChild);
    head.insertBefore(JS2, head.firstChild);
    CLodopIsLocal </span>= !!((JS1.src + JS2.src).match(/\/\/localho|\/\/127.0.0./<span style="color: #000000;">i));
}

</span><span style="color: #0000ff;">if</span> (needCLodop()){loadCLodop();}<span style="color: #008000;">//</span><span style="color: #008000;">开始加载</span>

<span style="color: #008000;">//</span><span style="color: #008000;">==获取LODOP对象主过程,判断是否安装、需否升级:==</span>
<span style="color: #0000ff;">function</span><span style="color: #000000;"> getLodop(oOBJECT, oEMBED) {
    </span><span style="color: #0000ff;">var</span> strFontTag= "&lt;br&gt;&lt;font color='#FF00FF'&gt;打印控件"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> strLodopInstall   = strFontTag+"未安装!点击这里&lt;a href='install_lodop32.zip' target='_self'&gt;执行安装&lt;/a&gt;"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> strLodopUpdate    = strFontTag+"需要升级!点击这里&lt;a href='install_lodop32.zip' target='_self'&gt;执行升级&lt;/a&gt;"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> strLodop64Install = strFontTag+"未安装!点击这里&lt;a href='install_lodop64.zip' target='_self'&gt;执行安装&lt;/a&gt;"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> strLodop64Update  = strFontTag+"需要升级!点击这里&lt;a href='install_lodop64.zip' target='_self'&gt;执行升级&lt;/a&gt;"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> strCLodopInstallA = "&lt;br&gt;&lt;font color='#FF00FF'&gt;Web打印服务CLodop未安装启动，点击这里&lt;a href='CLodop_Setup_for_Win32NT.zip' target='_self'&gt;下载执行安装&lt;/a&gt;"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> strCLodopInstallB = "&lt;br&gt;（若此前已安装过，可&lt;a href='CLodop.protocol:setup' target='_self'&gt;点这里直接再次启动&lt;/a&gt;）"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> strCLodopUpdate   = "&lt;br&gt;&lt;font color='#FF00FF'&gt;Web打印服务CLodop需升级!点击这里&lt;a href='CLodop_Setup_for_Win32NT.zip' target='_self'&gt;执行升级&lt;/a&gt;"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> strLodop7FontTag    = "&lt;br&gt;&lt;font color='#FF00FF'&gt;Web打印服务Lodop7"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> strLodop7HrefX86    = "点击这里&lt;a href='Lodop7_Linux_X86_64.tar.gz' target='_self'&gt;下载安装&lt;/a&gt;(下载后解压，点击lodop文件开始执行)"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> strLodop7HrefARM    = "点击这里&lt;a href='Lodop7_Linux_ARM64.tar.gz'  target='_self'&gt;下载安装&lt;/a&gt;(下载后解压，点击lodop文件开始执行)"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span> strLodop7Install_X86 = strLodop7FontTag+"未安装启动，"+<span style="color: #000000;">strLodop7HrefX86;
    </span><span style="color: #0000ff;">var</span> strLodop7Install_ARM = strLodop7FontTag+"未安装启动，"+<span style="color: #000000;">strLodop7HrefARM;
    </span><span style="color: #0000ff;">var</span> strLodop7Update_X86  = strLodop7FontTag+"需升级，"+<span style="color: #000000;">strLodop7HrefX86;
    </span><span style="color: #0000ff;">var</span> strLodop7Update_ARM  = strLodop7FontTag+"需升级，"+<span style="color: #000000;">strLodop7HrefARM;
    </span><span style="color: #0000ff;">var</span> strInstallOK = "，成功后请刷新本页面或重启浏览器。&lt;/font&gt;"<span style="color: #000000;">;
    </span><span style="color: #0000ff;">var</span><span style="color: #000000;"> LODOP;
    </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
        </span><span style="color: #0000ff;">var</span> isWinIE    = (/MSIE/i.test(navigator.userAgent)) || (/Trident/<span style="color: #000000;">i.test(navigator.userAgent));
        </span><span style="color: #0000ff;">var</span> isWinIE64  = isWinIE &amp;&amp; (/x64/<span style="color: #000000;">i.test(navigator.userAgent));
        </span><span style="color: #0000ff;">var</span> isLinuxX86 = (/Linux/i.test(navigator.platform)) &amp;&amp; (/x86/<span style="color: #000000;">i.test(navigator.platform));
        </span><span style="color: #0000ff;">var</span> isLinuxARM = (/Linux/i.test(navigator.platform)) &amp;&amp; (/aarch/<span style="color: #000000;">i.test(navigator.platform));

        </span><span style="color: #0000ff;">if</span> (needCLodop() || isLinuxX86 ||<span style="color: #000000;"> isLinuxARM) {
            </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
                LODOP </span>=<span style="color: #000000;"> getCLodop();
            } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (err) {}
            </span><span style="color: #0000ff;">if</span> (!LODOP &amp;&amp; CLodopJsState !== "complete"<span style="color: #000000;">) {
                </span><span style="color: #0000ff;">if</span> (CLodopJsState == "loading") alert("网页还没下载完毕，请稍等一下再操作."); <span style="color: #0000ff;">else</span> alert("未曾加载Lodop主JS文件，请先调用loadCLodop过程."<span style="color: #000000;">);
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
            }
            </span><span style="color: #0000ff;">var</span><span style="color: #000000;"> strAlertMessage;
            </span><span style="color: #0000ff;">if</span> (!<span style="color: #000000;">LODOP) {
                </span><span style="color: #0000ff;">if</span> (isLinuxX86) strAlertMessage = strLodop7Install_X86; <span style="color: #0000ff;">else</span>
                <span style="color: #0000ff;">if</span> (isLinuxARM) strAlertMessage = strLodop7Install_ARM; <span style="color: #0000ff;">else</span><span style="color: #000000;">
                strAlertMessage </span>= strCLodopInstallA + (CLodopIsLocal ? strCLodopInstallB : ""<span style="color: #000000;">) ;
                document.body.innerHTML </span>= strAlertMessage + strInstallOK +<span style="color: #000000;"> document.body.innerHTML;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
            } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                </span><span style="color: #0000ff;">if</span> (isLinuxX86 &amp;&amp; LODOP.CVERSION &lt; "7.0.3.9") strAlertMessage = strLodop7Update_X86; <span style="color: #0000ff;">else</span>
                <span style="color: #0000ff;">if</span> (isLinuxARM &amp;&amp; LODOP.CVERSION &lt; "7.0.3.9") strAlertMessage = strLodop7Update_ARM; <span style="color: #0000ff;">else</span>
                <span style="color: #0000ff;">if</span> (CLODOP.CVERSION &lt; "4.1.5.5")              strAlertMessage =<span style="color: #000000;"> strCLodopUpdate;

                </span><span style="color: #0000ff;">if</span> (strAlertMessage) document.body.innerHTML = strAlertMessage+ strInstallOK +<span style="color: #000000;"> document.body.innerHTML;
            }
        } </span><span style="color: #0000ff;">else</span> { <span style="color: #008000;">//</span><span style="color: #008000;">==如果页面有Lodop插件就直接使用,否则新建:==</span>
            <span style="color: #0000ff;">if</span> (oOBJECT ||<span style="color: #000000;"> oEMBED) {
                </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (isWinIE)
                    LODOP </span>=<span style="color: #000000;"> oOBJECT;
                </span><span style="color: #0000ff;">else</span><span style="color: #000000;">
                    LODOP </span>=<span style="color: #000000;"> oEMBED;
            } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">CreatedOKLodopObject) {
                LODOP </span>= document.createElement("object"<span style="color: #000000;">);
                LODOP.setAttribute(</span>"width", 0<span style="color: #000000;">);
                LODOP.setAttribute(</span>"height", 0<span style="color: #000000;">);
                LODOP.setAttribute(</span>"style", "position:absolute;left:0px;top:-100px;width:0px;height:0px;"<span style="color: #000000;">);
                </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (isWinIE)
                    LODOP.setAttribute(</span>"classid", "clsid:2105C259-1E0C-4534-8141-A753534CB4CA"<span style="color: #000000;">);
                </span><span style="color: #0000ff;">else</span><span style="color: #000000;">
                    LODOP.setAttribute(</span>"type", "application/x-print-lodop"<span style="color: #000000;">);
                document.documentElement.appendChild(LODOP);
                CreatedOKLodopObject </span>=<span style="color: #000000;"> LODOP;
            } </span><span style="color: #0000ff;">else</span><span style="color: #000000;">
                LODOP </span>=<span style="color: #000000;"> CreatedOKLodopObject;
            </span><span style="color: #008000;">//</span><span style="color: #008000;">==Lodop插件未安装时提示下载地址:==</span>
            <span style="color: #0000ff;">if</span> ((!LODOP) || (!<span style="color: #000000;">LODOP.VERSION)) {
                document.body.innerHTML </span>= (isWinIE64 ? strLodop64Install : strLodopInstall) + strInstallOK +<span style="color: #000000;"> document.body.innerHTML;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> LODOP;
            }
            </span><span style="color: #0000ff;">if</span> (LODOP.VERSION &lt; "6.2.2.6"<span style="color: #000000;">) {
                document.body.innerHTML </span>= (isWinIE64 ? strLodop64Update : strLodopUpdate) + strInstallOK +<span style="color: #000000;"> document.body.innerHTML;
            }
        }
        </span><span style="color: #008000;">//</span><span style="color: #008000;">===如下空白位置适合调用统一功能(如注册语句、语言选择等):=======================</span>
<span style="color: #000000;">
        LODOP.SET_LICENSES。。。。。。。。。。。。。。。。</span><span style="color: #008000;">//</span><span style="color: #008000;">===============================================================================</span>
        <span style="color: #0000ff;">return</span><span style="color: #000000;"> LODOP;
    } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (err) {
        alert(</span>"getLodop出错:" +<span style="color: #000000;"> err);
    }
}</span></pre>
</div>

</div>
<p></p>
<div id="small">
</div>

<br>
           </div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
