<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>s批量打印偶尔漏打</title>
 </head>
 <body>
 <style>
 body{margin:0px;}
.body {width:100%;}
a{text-decoration:none;color:black;}
h1{font-size:1.625em;}
h2{font-size:1.375em;}
/**.box{float:left;}**/
.header_box {width:100%;}
.header{padding:1%;
background-color:#f1f1f1;}
/**border:1px solid #e9e9e9;}**/

.header_bottom{width:100%;}
.menuitem {
    margin-top:0;
    margin-left:0;
    margin-bottom:0;
    padding:1%;
    border-bottom:1px solid #e9e9e9;
    cursor:pointer;
}

.main {padding:1%;}
.main_middle { width:100%;}


.box_footer {width:100%;margin-bottom:0;}
.footer {
    padding:1%;
    text-align:center;
    background-color:#f1f1f1;
    font-size:0.625em;
}
#small{background:#ccff99;border:#7f9db9 1px solid;padding:10px;font-size:15px; }
#small hr{margin:10px;padding:0px;}

@media only screen and (max-width: 500px) {
    .menu_left{width:100%;}
    .menuitem { margin:1%;padding:1%;}

    .main_middle { width:100%;}
    .main {padding:1%;}

    .box_right {width:100%;}
    .right { padding:1%;
    }

    .box { margin-right:0; float:left;}
}

</style>
<div class="body"><!--body开始-->
        <div class="box header_box"><!--header开始-->
            <div class="header">
                <h1>LODOP超简短问答-批量打印偶尔漏打</h1>
            </div>
        </div><!--header结束-->
<div class="header_bottom"> 	
		  <a href="../../phoneQA004.html"><div class="menuitem">lodop问答主页</div></a> 
		  <a href="../../phoneQA_dange.html"><div class="menuitem"><span style="color:red;">问答主页（单个问答链接）</span></div></a>
          <a href="../../mini_QAs.html"><div class="menuitem"><span style="color:#ff0099;">迷你一个问答</span></div></a> 
		  <a href="../QA_singe29t.html"><div class="menuitem" style="background:#ccff99;border:#7f9db9 1px solid;">功能现象专题问答</span></a> 
</div>
        <div class="box main_middle"><!--main_middle开始-->
            <div class="main">
<h1>批量打印偶尔漏打</h1>
<div id="small">
<span style="color:blue">批量打印偶尔漏打</span><br>
1.用最新版http://www.c-lodop.com/download.html<br>
2.参考样例4http://www.c-lodop.com/demolist/PrintSample4.html<br>
直接判断print的返回值，判断是否加入了队列。<br>
<hr>
<span style="color:blue">批量打印判断返回值回调和例子</span><br>
c-lodop批量打印，需要LODOP.On_Return_Remain=true;将回调结果保留，c-lodop任务可通过TaskID区分。
一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br>
<br>
群文件里有个批量打印得到结果的压缩包文件，可参考下。<br>
<br>
通过TaskID可以知道哪个任务返回false，漏打哪个任务，可以再重打该任务。<br>
<hr>
<span style="color:blue">查看c-lodop的日志功能排查</span><br>
安装最新版c-lodop试试http://www.c-lodop.com/download.html<br>
开启日志功能，查看下日志是否正常。通过日志排查下。<br>
日志功能，在端口设置界面的右键菜单里勾选 Run Logs<br>
日志存放目录：MountTaiSoftware/CLodop32/Logs，保留最新7天日志，每天不超过200k（约2千条）<br>
日志有对话REQUEST类和打印PRINTED类两类成功日志(暂无失败日志)，<br>
前者保存了请求目的、对方IP、对话协议、对话端口和对话时间;<br>
后者保存了打印机名、打印标题、打印任务页数、打印份数、打印时间；<br>
<hr>
<span style="color:blue">批量打印判断加入队列，重打漏打任务</span><br>
用最新版对比试试http://www.c-lodop.com/download.html<br>
参考样例4http://www.c-lodop.com/demolist/PrintSample4.html判断打印的返回值，设置如果漏打，重新打印该任务试试。<br>
<hr>
<span style="color:blue">判断没有加入队列，判断job也不在队列 </span><br>
可以先打印机脱机，用多个打印机驱动测试下，排查是否是该打印机驱动问题。<br>
并查看版本是否是最新版。http://www.c-lodop.com/download.html<br>
<hr>
<span style="color:blue">判断不在队列的写法是否在正常</span><br>
参考测试样例45，http://www.c-lodop.com/demolist/PrintSample45.html，右键查看源码，c-lodop需要回调函数。<br>
job代码和不在队列状态的获取都需要回调函数，<br>
先获取job代码，再获取状态码，参考样例的写法<br>
<hr>
<span style="color:blue">如果能还原，发一下代码</span><br>
如果是最新版，如果是必现问题，大约打多少会漏打，做个能还原问题的例子，发过来，这边测试下。<br>
<hr>
<span style="color:blue">判断打印成功</span><br>
参考样例35 http://www.c-lodop.com/demolist/PrintSample35.html<br>
样例45的13 http://www.c-lodop.com/demolist/PrintSample45.html<br>
样例35返回的“打印成功”实际仅是成功加入后台队列。<br>
样例45的13 判断“JOB不在队列”就足可认定已经打印成功。<br>
一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br>
<hr>
</div>
<br>
<div id="small">
相关链接：(会跳转到cnblog，非本网站地址)<br>
cnblog(花谢悦神）： <a href="https://www.cnblogs.com/huaxie/p/12133664.html" target="_blank"><span style="color:blue;">LODOP批量打印判断是否加入队列1</span></a>、<br>
 <a href="https://www.cnblogs.com/huaxie/p/11248349.html" target="_blank"><span style="color:blue;">LODOP中无规律无法还原偶尔出现问题排查</span></a>、<br>
</div>
           </div>
    </div><!--main_middle结束-->

        <div class="box box_footer"><!--box_footer开始-->
            <div class="footer">
<p>lodop简短问答页面.</p>
            </div>
        </div><!--box_footer结束-->


</div><!--body结束-->
 </body>
</html>
