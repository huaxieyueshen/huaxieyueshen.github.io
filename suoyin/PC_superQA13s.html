<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>批量问答</title>
 <link href="../shenghuo/shcss/money.css" type="text/css" rel="stylesheet">
 <style>
 .hot{background-color:#ff9d9d;}
 #small{width:90%;margin:auto;background:#ffffff;border:#7f9db9 1px solid;padding:10px;font-size:15px; }
#small hr{margin:10px;padding:0px;}
 </style>
  </head>
  <body>
<div class="menu">
<ul>
  <li><a href="./phoneQA004.html" style="color:#ffcccc;">问答主页</a></li>
  <li><a href="./PC_superQA1s.html">超级长关键词问答首页</a></li>
  <li><a href="./phoneQA_dange.html">单个问答</a></li>
  <li><a href="./mini_QAs.html">迷你问答</a></li>
  <li><a href="./PC_superQA4s.html">上一页</a></li>
  <li><a href="./PC_superQA6s.html">当前6页</a></li>
  <li style="float:right"><a href="./PC_superQAindex.html">PC超长索引页</a></li>
</ul>
</div>

<div>&nbsp;</div>

<div class="main">
<table class="mytable">
<tr>
	<th colspan="2">Ctrl+F,在浏览器搜索关键词进行查找（PC用）</th>
</tr>
<tr>
	<td class="odd"><a href="./miniQA/miniQA47.html" target="_blank">如何批量打印【迷你】</a></td>
	<td class="odd"><a href="./miniQA/miniQA37.html" target="_blank">批量打印漏打【迷你】</a></td>
</tr>
<tr>
	<td class="odd"><a href="./miniQA/miniQA75.html" target="_blank">批量打印重打【迷你】</a></td>
	<td class="odd"><a href="./singe_qas/smallQA/smallQA63.html" target="_blank">批量打印偶尔漏打【小】</a></td>
</tr>
<tr>
	<td class="odd"><a href="./miniQA/miniQA49.html" target="_blank">批打图片空白【迷你】</a></td>
	<td class="odd"><a href="./singe_qas/smallQA/smallQA49.html" target="_blank">批量打印C-lodop内存增长【小】</a></td>
</tr>
<tr>
	<td class="odd"><a href="./miniQA/miniQA74.html" target="_blank">打印任务顺序乱了【迷你】</a></td>
	<td class="odd"><a href="./singe_qas/smallQA/smallQA70.html" target="_blank">建议用纯文本输出【小】</a></td>
</tr>
<tr>
	<td class="odd"><a href="./miniQA/miniQA23.html" target="_blank">打印成功【迷你】</a></td>
	<td class="odd"><a href="./singe_qas/smallQA/smallQA103.html" target="_blank">批量打印偶尔内容缺失【小】</a></td>
</tr>
</table>
<p>&nbsp;</p><!--分隔-->
<div id="small">
<span style="color:blue">如何批量打印</span><br>
批量打印，分页分任务，在页数和任务之间平衡一下，参考样例26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
<hr>
<span style="color:blue">如何批量打印标签</span><br>
纸张设置，参考样例5 http://www.c-lodop.com/demolist/PrintSample5.html<br>
批量打印，参考样例26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
<hr>
<span style="color:blue">如何一次性打印多张</span><br>
如果是相同的内容，设置打印份数，参考样例7，http://www.c-lodop.com/demolist/PrintSample7.html<br>
如果是不同的内容，批量打印分页分任务，参考样例26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
<hr>
<span style="color:blue">批量打印，最多可以打多少页</span><br>
理论上没有限制，或尝试多分一些任务，平衡一下。<br>
批量打印，分页分任务，在页数和任务之间平衡一下，参考样例26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
<hr>
<span style="color:blue">批量打印，怎么指定打印机</span><br>
参考样例5、7<br>
http://www.c-lodop.com/demolist/PrintSample5.html<br>
http://www.c-lodop.com/demolist/PrintSample7.html<br>
代码选择一个打印机，然后每个任务指定这个打印机批量打印，分页任务，参考样例26，最后用PRINT输出。<br>
<hr>
<span style="color:blue">批量打印，判断是否加入队列</span><br>
如果是c-lodop批量打印，则需要LODOP.On_Return_Remain=true;将回调结果保留，c-lodop任务可通过TaskID区分。<br>
<br>
一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br>
<hr>
<span style="color:blue">批量打印超文本，后续空白</span><br>
批量打印大量的超文本和图片，可能会有影响。尽量用add_print_text纯文本和画线等进行设计，这种是lodop直接输出的，不需要经过浏览器解析。<br>
参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
<hr>
<span style="color:blue">批量打印超文本，中间空白</span><br>
如果是批量打印超文本，中间漏打的是空白，可以加延迟等方式试试，尽量多分一些任务试试。<br>
<hr>
<span style="color:blue">批量打印，任务加入队列的顺序有问题</span><br>
用最新版测试下试试http://www.c-lodop.com/download.html<br>
或参考样例45的13的逐个打印，或判断前面的不在队列后再进行下一个任务。<br>
<hr>
<span style="background:#f6f6f6;"><span style="color:blue">批量打印，漏了任务，补打会导致顺序乱了（其他）</span><br>
1、一种原因是，打印任务还没有生成，就被下一个循环吧打印任务重置删除了；避免这种情况参考样例26 分组打印<br>
2、 另一种情况，可能因为未知原因造成丢失，可以参考样例45 的最后，通过判断打印任务是否成功来避免<br></span>
<hr>
<span style="color:blue">批量打印大量大图，到达一定数值，有空白（回答1）</span><br>
批量打印大量图片，用base64方式输出试试，lodop语句直接输出base64码，不带img标签，参考样例38
http://www.c-lodop.com/demolist/PrintSample38.html<br>
<hr>
<span style="color:blue">批量打印大量大图，到达一定数值，有空白（回答2）</span><br>
带img标签的那种会经过ie浏览器解析，浏览器缓存不释放等可能会造成一些问题。<br>
出问题时重启c-lodop试试，清理浏览器缓存试试。<br>
lodop语句直接输出base64码，不带img标签，参考样例38<br>
http://www.c-lodop.com/demolist/PrintSample38.html<br>
<hr>
<span style="color:blue">批量打印大量大图，到达一定数值，有空白（回答3）</span><br>
图片批量打印，src 方式输出，需要通过浏览器引擎解析，存在不释放缓存的现象，可尝试base64码输出，参考样例<br>
38http://www.c-lodop.com/demolist/PrintSample38.html<br>
base64位码输出直接通过本地lodop程序解析，无需经过浏览器引擎解析印。<br>
<hr>
<span style="color:blue">批量打印卡死，空白，建议纯文本（回答1）</span><br>
批量打印，分页分任务，在页数和任务之间平衡一下，参考样例26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
批量打印大量内容，如果是超文本，打印大量超文本浏览器可能存在缓存不释放或释放慢等情况，建议用纯文本和画线方式试试，参考样例4，http://www.c-lodop.com/demolist/PrintSample4.html<br>
<hr>
<span style="color:blue">批量打印卡死，内存增长，空白，建议纯文本（回答2）</span><br>
批量打印，分页分任务，在页数和任务之间平衡一下，参考样例26，http://www.c-lodop.com/demolist/PrintSample26.html<br>
批量打印大量内容，并建议用纯文本和画线方式，参考样例4，http://www.c-lodop.com/demolist/PrintSample4.html<br>
<hr>
<span style="color:blue">批量打印卡死，内存增长，空白，建议纯文本（回答3）</span><br>
批量打印大量内容，建议用纯文本和画线方式，如果是超文本项，是受浏览器解析影响的，缓存有时不释放或释放的慢。<br>
参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
参考http://www.c-lodop.com/demolist/PrintSampleA1.html<br>
<hr>
<span style="color:blue">批量打印卡死，内存增长，空白，建议纯文本（回答4）</span><br>
批量打印参考样例26 长时间批量打印大量内容 建议只打印纯文本和划线方式 参考样例4，http://www.c-lodop.com/demolist/PrintSample4.html<br>
<hr>
<span style="color:blue">打印预览显示进度条，过慢</span><br>
出现进度条，打印过慢，可能和很多原因有关：打印内容或样式或图片等过多，有需要下载有脚步执行或本身网络慢；<br>
机器性能过低 系统ie有问题或缓存过多；或使用的是共享打印机。<br>
如果预览页数多，可以多分一些任务，太多不建议预览，建议直接打印，在任务和页数之间平衡一下，参考样例26 <br>http://www.c-lodop.com/demolist/PrintSample26.html<br>
<hr>
<span style="color:blue">打印过慢，测试是否和内容有关（慢和内容，回答1）</span><br>
出现进度条，打印过慢，可能和很多原因有关：打印内容或样式或图片等过多，有需要下载有脚步执行或本身网络慢；<br>
机器性能过低 系统ie有问题或缓存过多；或使用的是共享打印机。<br>
先测试下是否和内容有关，比如测试样例26，那种简单的纯文本试试，样例26如果测试很快，很可能和内容有关，比如自己内容过多需要下载有脚步执行或本身网络慢，打印内容或样式等过多。<br>
<hr>
<span style="color:blue">慢，不是共享打印机，打印预览慢（慢和内容，回答2）</span><br>
排查下其他条目：打印过慢，可能和很多原因有关：打印内容或样式或图片等过多，有需要下载有脚步执行或本身网络慢；机器性能过低 系统ie有问题或缓存过多<br>
<hr>
<span style="color:blue">输出简单add_Print_text测试（慢和内容，回答3）</span><br>
输出个简单的add_Print_text测试下，试试纯文本是否快一些。<br>
超文本需要浏览器引擎解析。<br>
<br>
纯文本+线输出表格：ADD_PRINT_TEXT、ADD_PRINT_LINE<br>
画线输出表格，参考http://www.c-lodop.com/demolist/PrintSampleA1.html<br>
重置ie浏览器试试，或尝试用纯文本画线方式。<br>
<br>
重置ie浏览器试试，输出个最简单的表格，去掉样式等对比试试。<br>
调试代码 ，排查慢在什么地方。<br>
用虚拟打印机测试下，对比真实打印机，有的打印机可能解析的任务较大。<br>
<hr>
<span style="color:blue">批量打印超文本或图片慢CS架构（慢和内容，回答4）</span><br>
是否是大量打印超文本造成的，Lodop大量打印超文本，调用ie引擎解析，ie缓存过多不释放，可能造成一些影响，如果大量打印，可以试试用纯文本方式。<br>
<br>
图片批量打印，src 方式输出，需要通过浏览器引擎解析，存在不释放缓存的现象，可尝试base64码输出，参考样例<br>38http://www.c-lodop.com/demolist/PrintSample38.html<br>
base64位码输出直接通过本地lodop程序解析，无需经过浏览器引擎解析<br>
<br>
Lodop大量打印超文本，调用ie引擎解析，ie缓存过多不释放，可能造成一些影响，如果大量打印，可以试试用纯文本方式。
参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
<hr>
<span style="background:#f6f6f6;"><span style="color:blue">速度慢排查（其他）</span><br>
速度慢一般从以下几个方面排查<br>
1.访问不存在的地址有等待的时间<br>
2.共享打印机的网络地址，网络故障访问不到共享打印机<br>
3.硬件性能问题，硬件反应慢，<br>
4.网络数据传输速度的慢<br>
5.打印任务加载的内容过多或过大<br>
</span>
<hr>
<span style="color:blue">全（其他批量卡慢等）</span><br>
1.重置浏览器，清理浏览器缓存。<br>
2.清理操作系统缓存等，关闭一些不常用的软件，保证系统内存充足。<br>
3.是否是打印内容或样式等过多引起的（表现为打印预览弹出很慢，或有进度条，进度条卡住等，如果是数据过多引起，建议拆分一下数据分多任务）：<br>
批量打印，分多任务，在页数和任务数量之间平衡一下，页数太多建议多分一些任务，<br>
参考http://www.c-lodop.com/demolist/PrintSample26.html<br>
4.测试官网样例http://www.c-lodop.com/LodopDemo.html，是否有提示。<br>
5.测试参考样例7http://www.c-lodop.com/demolist/PrintSample7.html，选择xps或pdf虚拟打印机试试，换个打印机试试。<br>
6.删除网络共享打印机试试，可能是导致这个原因。<br>
（网络共享打印机还可能导致c-lodop安装界面始终打不开，可尝试删除网络共享打印机）<br>
7.c-lodop启动界面未响应问题，可等待响应，或关闭程序，然后双击桌面上的c-lodop快捷方式重启本地的c-lodop。<br>
<hr>
<span style="color:blue">批量连续打印，累计偏移</span><br>
参考http://www.c-lodop.com/faq/pp17.html，里面的3，<br>
连续打印输出多张，偏移累计越来越大：<br>
设置输出的纸张 与实际纸张大小有差异，如果确实无法做到与纸张实物一样大，输出一定任务数量后，发现有偏差时需要手动调整进纸位置以纠正。<br>
3.	连续打印输出多张，偏移累计越来越大：<br>
设置输出的纸张 与实际纸张大小有差异，如果确实无法做到与纸张实物一样大，输出一定任务数量后，发现有偏差时需要手动调整进纸位置以纠正。<br>
如果是情况3，尽量和实际纸张和设置纸张大小一致。<br>
<hr>
<span style="color:blue">批量打印漏打（回答1）</span><br>
1.用最新版http://www.c-lodop.com/download.html<br>
2.参考样例4http://www.c-lodop.com/demolist/PrintSample4.html<br>
直接判断print的返回值，判断是否加入了队列。<br>
<br>
如果是c-lodop批量打印，则需要LODOP.On_Return_Remain=true;将回调结果保留，c-lodop任务可通过TaskID区分。<br>
一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br>
<br>
通过TaskID可以知道哪个任务返回false，漏打哪个任务，可以再重打该任务。<br>
<hr>
<span style="color:blue">批量打印漏打排查（回答2）</span><br>
1.调试下JS，排查下代码，是否执行了足够数量的PRINT语句。<br>
2.用最新版试试http://www.c-lodop.com/download.html<br>
3.打印机脱机查看下打印机队列的任务数量是否正常<br>
4.判断print的返回值，参考样例4.http://www.c-lodop.com/demolist/PrintSample4.html，返回值判断的是是否加入队列<br>
5.安装最新版c-lodop试试http://www.c-lodop.com/download.html<br>
开启日志功能，查看下日志是否正常。<br>
日志功能，在端口设置界面的右键菜单里勾选 Run Logs<br>
日志存放目录：MountTaiSoftware/CLodop32/Logs，保留最新7天日志，每天不超过200k（约2千条）<br>
日志有对话REQUEST类和打印PRINTED类两类成功日志(暂无失败日志)，<br>
前者保存了请求目的、对方IP、对话协议、对话端口和对话时间;<br>
后者保存了打印机名、打印标题、打印任务页数、打印份数、打印时间；<br>
<hr>
<span style="color:blue">批量打印漏打队列排查（队列，回答3）</span><br>
用最新版试试http://www.c-lodop.com/download.html<br>
打印机脱机查看下打印机队列的任务数量是否正常<br>
<br>
如果队列里任务正常，用虚拟打印机测试下，队列和虚拟打印机个都正常，说明代码正常，进入队列后就开始排队了，打印机打印不出来，应该和打印机有关，重装打印机驱动试试。<br>
<hr>
<span style="color:blue">如果能还原，发一下代码（漏打，例子）</span><br>
如果是最新版，如果是必现问题，大约打多少会漏打，做个能还原问题的例子，发过来，这边测试下。<br>
<hr>
<span style="color:blue">批量打印判断返回值回调和例子</span><br>
c-lodop批量打印，需要LODOP.On_Return_Remain=true;将回调结果保留，c-lodop任务可通过TaskID区分。
一般建议使用样例4，35方法简单判断打印成功，发送打印指令加入打印机队列算打印成功。<br>
<br>
群文件里有个批量打印得到结果的压缩包文件，可参考下。<br>
<br>
通过TaskID可以知道哪个任务返回false，漏打哪个任务，可以再重打该任务。<br>
<hr>
<span style="color:blue">批量打印重打（回答1）</span><br>
1.用最新版测试下http://www.c-lodop.com/download.html<br>
2.调试JS，排查每个任务中数据是否正常。<br>
3.或参考样例45的13，上一个任务不在队列后再打印下一个试试。<br>
<hr>
<span style="color:blue">批量打印重打（回答2，新版本）</span><br>
安装最新版对比下http://www.c-lodop.com/download.html<br>
之前有版本出现过重复打印问题，一些重复的可能性新版本已经不会出现了。<br>
<hr>
<span style="color:blue">批量打印偶尔内容缺失（超文本）</span><br>
打印缺失，是指批量打印中偶尔出现内容缺失情况吗<br>
是必然出现的，还是偶尔出现，是否有规律<br>
<br>
如果打印的是超文本，加延迟试试：<br>
LODOP.SET_PRINT_STYLEA(0,"HtmWaitMilSecs",1000)//设置上一项延迟超文本下载1000毫秒<br>
<br>
批量打印大量内容，建议用纯文本和画线方式，如果是超文本项，是受浏览器解析影响的，缓存有时不释放或释放的慢。<br>
参考http://www.c-lodop.com/demolist/PrintSample4.html<br>
<br>
如果是大量打印超文本到一定数值，后续出现问题，和超文本解析引擎等有关。<br>
如果大量打印，建议纯文本和画线输出<br>
<hr>
<span style="color:blue">批量打印偶尔内容缺失（用的纯文本）</span><br>
调试JS，纯文本和画线输出不经过浏览器解析，是否传入的参数有问题，例如有些纯文本赋值为空值，会是空白。<br>
<hr>
<span style="color:blue">批量打印偶尔内容缺失（建议纯文本）</span><br>
快递单，小票，标签，票据等，建议用ADD_PRINT_TEXT等纯文本和画线等进行设计，不受浏览器解析的影响。<br>
参考http://www.c-lodop.com/demolist/PrintSample4.html
<hr>
<span style="color:blue">批量打印偶尔内容缺失，偶发（建议纯文本）</span><br>
偶发性的不好判断，可能是数据传输问题，如果是超文本，也可能是超文本加载问题。
是否是纯文本和画线设计的，这种不经过浏览器解析，直接lodop输出，如果大量打印比较稳定。
<hr>
<span style="color:blue">批量打印偶尔内容缺失（用的纯文本，虚拟打印机无法还原）</span><br>
纯文本赋值时数据传输是否正常，是否有空置等。<br>
或在有问题的客户端用虚拟打印机输出测试，如果虚拟打印机一直无法还原问题，也可能和打印机有关，重装打印机驱动试试。<br>
<br>
理论上本机虚拟打印没问题的话，说明插件代码没问题，程序可做的努力就的确很少了，毕竟windows下的打印是微软倡导的设备无关系原则，要在打印机和打印驱动程序 系统上排查下，尝试重装驱动 或者 打印机不支持一些功能 打印机精度太低。<br>
如果虚拟打印机测试一直无法还原这个现象，应该是和打印机或打印机驱动有关，只能在打印机或打印机上排查。<br>
<hr>
<span style="color:blue">批量打印偶尔内容缺失（21年3月win10补丁问题）</span><br>
如果只有客户那边有问题，也可能和操作系统或其他地方有关。<br>
如果是win10系统，更新下后续的补丁试试，之前3月份有的操作系统补丁影响了打印，后续补丁修正了。<br>
<hr>
<span style="color:blue">批量打印偶尔内容缺失（打印份数，多份偶尔缺失）</span><br>
如果是相同的内容，或尝试样例7的份数设置http://www.c-lodop.com/demolist/PrintSample7.html<br>
如果是有不同值的页，或尝试再多分一些任务。<br>
虚拟打印机正常且预览每页都正常，还是最可能和打印机或打印机驱动有关。<br>
<br>
尝试样例7的份数设置http://www.c-lodop.com/demolist/PrintSample7.html<br>
试试设置份数<br>
<br>
份数是相同的内容打印多少份，打印机本身自己也有份数设置<br>
打印机设置多份，却输出不同的内容，应该是和打印机或打印机驱动有关。<br>
之前测试该问题电脑虚拟打印机输出正常，只有真实打印机有缺失，应该确定是和打印机或打印机驱动有关了。<br>
咨询下打印机客服关于打印机的份数问题试试，安装最新的打印机驱动试试。<br>
<hr>




</div>



</div>
 </body>
</html>
